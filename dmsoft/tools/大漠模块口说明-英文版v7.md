<a name="chmtopic3"></a>**函数简介:**

需要先加载Ai模块. 在指定范围内检测对象.

**函数原型:**\
\
string AiYoloDetectObjects(x1, y1, x2, y2,prob,iou)

参数定义:

x1 整形数:区域的左上X坐标

y1 整形数:区域的左上Y坐标

x2 整形数:区域的右下X坐标

y2 整形数:区域的右下Y坐标

prob双精度浮点数**:** 置信度,也可以认为是相似度. 超过这个prob的对象才会被检测

iou 双精度浮点数**:** 用于对多个检测框进行合并.  越大越不容易合并(很多框重叠). 越小越容易合并(可能会把正常的框也给合并). 所以这个值一般建议0.4-0.6之间. \
`               `可以在Yolo综合工具里进行测试.

**返回值:**

字符串:\
返回的是所有检测到的对象.格式是"类名,置信度,x,y,w,h|....". 如果没检测到任何对象,返回空字符串.

<a name="chmtopic5"></a>**函数简介:**

需要先加载Ai模块. 在指定范围内检测对象,把结果输出到BMP图像数据.用于二次开发.

**函数原型:**\
\
long AiYoloDetectObjectsToDataBmp(x1, y1, x2, y2,prob,iou,data,size,mode)

参数定义:

x1 整形数:区域的左上X坐标

y1 整形数:区域的左上Y坐标

x2 整形数:区域的右下X坐标

y2 整形数:区域的右下Y坐标

prob双精度浮点数**:** 置信度,也可以认为是相似度. 超过这个prob的对象才会被检测

iou 双精度浮点数**:** 用于对多个检测框进行合并.  越大越不容易合并(很多框重叠). 越小越容易合并(可能会把正常的框也给合并). 所以这个值一般建议0.4-0.6之间. \
`               `可以在Yolo综合工具里进行测试.

data 变参指针:返回图片的数据指针

size 变参指针:返回图片的数据长度

mode 整形数: 0表示绘制的文字信息里包含置信度. 1表示不包含. 

**返回值:**

整形数:\
0 : 失败\
1 : 成功

<a name="chmtopic7"></a>**函数简介:**

需要先加载Ai模块. 在指定范围内检测对象,把结果输出到指定的BMP文件.

**函数原型:**\
\
long AiYoloDetectObjectsToFile(x1, y1, x2, y2,prob,iou,file,mode)

参数定义:

x1 整形数:区域的左上X坐标

y1 整形数:区域的左上Y坐标

x2 整形数:区域的右下X坐标

y2 整形数:区域的右下Y坐标

prob双精度浮点数**:** 置信度,也可以认为是相似度. 超过这个prob的对象才会被检测

iou 双精度浮点数**:** 用于对多个检测框进行合并.  越大越不容易合并(很多框重叠). 越小越容易合并(可能会把正常的框也给合并). 所以这个值一般建议0.4-0.6之间. \
`               `可以在Yolo综合工具里进行测试.

file 字符串:图片名,比如"test.bmp"

mode 整形数: 0表示绘制的文字信息里包含置信度. 1表示不包含. 

**返回值:**

整形数:\
0 : 失败\
1 : 成功

<a name="chmtopic9"></a>**函数简介:**

需要先加载Ai模块. 卸载指定的模型

**函数原型:**\
\
long AiYoloFreeModel(index)

参数定义:

index 整形数**:** 模型的序号. 最多支持20个. 从0开始

**返回值:**

整形数:\
1  表示成功\
0  失败

<a name="chmtopic11"></a>**函数简介:**

需要先加载Ai模块. 把通过AiYoloDetectObjects或者是AiYoloSortsObjects的结果,按照顺序把class信息连接输出.

**函数原型:**\
\
string AiYoloObjectsToString(objects)

参数定义:

objects 字符串: AiYoloDetectObjects或者AiYoloSortsObjects的返回值.

**返回值:**

字符串:\
返回的是class信息连接后的信息.

<a name="chmtopic13"></a>**函数简介:**

需要先加载Ai模块. 从文件加载指定的模型.

**函数原型:**\
\
long AiYoloSetModel(index,file,pwd)

参数定义:

index 整形数**:** 模型的序号. 最多支持20个. 从0开始

file字符串**:** 模型文件名. 比如"xxxx.onnx"或者"xxxx.dmx"

pwd字符串**:** 模型的密码. 仅对dmx格式有效.

**返回值:**

整形数:\
1  表示成功\
0  失败

<a name="chmtopic15"></a>**函数简介:**

需要先加载Ai模块. 从内存加载指定的模型. 仅支持dmx格式的内存

**函数原型:**\
\
long AiYoloSetModelMemory(index,data,size,pwd)

参数定义:

index 整形数**:** 模型的序号. 最多支持20个. 从0开始

data 整形数**:** dmx模型的内存地址

size 整形数**:** dmx模型的大小

pwd字符串**:** dmx模型的密码

**返回值:**

整形数:\
1  表示成功\
0  失败

<a name="chmtopic17"></a>**函数简介:**

需要先加载Ai模块. 设置Yolo的版本

**函数原型:**\
\
long AiYoloSetVersion(ver)

参数定义:

ver字符串**:** Yolo的版本信息. 需要在加载Ai模块后,第一时间调用. 目前可选的值只有"v5-7.0"

**返回值:**

整形数:\
1  表示成功\
0  失败

<a name="chmtopic19"></a>**函数简介:**

需要先加载Ai模块. 把通过AiYoloDetectObjects的结果进行排序. 排序按照从上到下,从左到右.

**函数原型:**\
\
string AiYoloSortsObjects(objects,height)

参数定义:

objects 字符串: AiYoloDetectObjects的返回值

height整形数: 行高信息. 排序时需要使用此行高. 用于确定两个检测框是否处于同一行. 如果两个框的Y坐标相差绝对值小于此行高,认为是同一行.

**返回值:**

字符串:\
返回的是所有检测到的对象.格式是"类名,置信度,x,y,w,h|....". 如果没检测到任何对象,返回空字符串.

<a name="chmtopic21"></a>**函数简介:**

需要先加载Ai模块. 切换当前使用的模型序号.用于AiYoloDetectXX等系列接口.

**函数原型:**\
\
long AiYoloUseModel(index)

参数定义:

index 整形数**:** 模型的序号. 最多支持20个. 从0开始

**返回值:**

整形数:\
1  表示成功\
0  失败

<a name="chmtopic25"></a>**函数简介:**

加载Ai模块. Ai模块从后台下载. 模块加载仅支持所有的正式版本。具体可以看DmGuard里系统版本的说明.

**函数原型:**\
\
long LoadAi(file)

参数定义:

file** 字符串**:** ai模块的路径. 比如绝对路径c:\ai.module或者相对路径ai.module等.

**返回值:**

整形数:\
1  表示成功\
-1 打开文件失败\
-2 内存初始化失败.  如果是正式版本,出现这个错误可以联系我解决.\
-3 参数错误\
-4 加载错误\
-5 Ai模块初始化失败\
-6 内存分配失败

<a name="chmtopic27"></a>**函数简介:**

从内存加载Ai模块. Ai模块从后台下载. 模块加载仅支持所有的正式版本。具体可以看DmGuard里系统版本的说明.

**函数原型:**\
\
long LoadAiMemory(data,size)

参数定义:

data 整形数**:** ai模块在内存中的地址

size 整形数**:** ai模块在内存中的大小

**返回值:**

整形数:\
1  表示成功\
-1 打开文件失败\
-2 内存初始化失败. 如果是正式版本,出现这个错误可以联系我解决.\
-3 参数错误\
-4 加载错误\
-5 Ai模块初始化失败\
-6 内存分配失败

<a name="chmtopic29"></a>**函数简介:**

设置是否在调用AiFindPicXX系列接口时,是否弹出找图结果的窗口.  方便调试. 默认是关闭的.

**函数原型:**\
\
long AiEnableFindPicWindow(enable)

**参数定义:**

enable 整形数: 0 关闭\
1 开启

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic31"></a>**函数简介:**

查找指定区域内的图片,位图必须是24位色格式,支持透明色,当图像上下左右4个顶点的颜色一样时,则这个颜色将作为透明色处理.

这个函数可以查找多个图片,只返回第一个找到的X Y坐标.

此接口使用Ai模块来实现,比传统的FindPic的效果更好. 不需要训练

**函数原型:**\
\
long AiFindPic(x1, y1, x2, y2, pic\_name,sim, dir,intX, intY)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
pic\_name 字符串:图片名,可以是多个图片,比如"test.bmp|test2.bmp|test3.bmp"\
sim 双精度浮点数:相似度,取值范围0.1-1.0\
dir 整形数:查找方向 0: 从左到右,从上到下 1: 从左到右,从下到上 2: 从右到左,从上到下 3: 从右到左, 从下到上\
intX 变参指针:返回图片左上角的X坐标\
intY 变参指针:返回图片左上角的Y坐标

**返回值:**

整形数:\
返回找到的图片的序号,从0开始索引.如果没找到返回-1

<a name="chmtopic33"></a>**函数简介:**

查找指定区域内的图片,位图必须是24位色格式,支持透明色,当图像上下左右4个顶点的颜色一样时,则这个颜色将作为透明色处理.

这个函数可以查找多个图片,并且返回所有找到的图像的坐标.

此接口使用Ai模块来实现,比传统的FindPicEx的效果更好.不需要训练

**函数原型:**\
\
string AiFindPicEx(x1, y1, x2, y2, pic\_name,sim, dir)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
pic\_name 字符串:图片名,可以是多个图片,比如"test.bmp|test2.bmp|test3.bmp"\
sim 双精度浮点数:相似度,取值范围0.1-1.0\
dir 整形数:查找方向 0: 从左到右,从上到下 1: 从左到右,从下到上 2: 从右到左,从上到下 3: 从右到左, 从下到上

**返回值:**

字符串:\
返回的是所有找到的坐标格式如下:"id,x,y|id,x,y..|id,x,y" (图片左上角的坐标)

比如"0,100,20|2,30,40" 表示找到了两个,第一个,对应的图片是图像序号为0的图片,坐标是(100,20),第二个是序号为2的图片,坐标(30,40)\
(由于内存限制,返回的图片数量最多为1500个左右)

<a name="chmtopic36"></a>**函数简介:**

查找指定区域内的图片,位图必须是24位色格式,支持透明色,当图像上下左右4个顶点的颜色一样时,则这个颜色将作为透明色处理.

这个函数可以查找多个图片,只返回第一个找到的X Y坐标. 这个函数要求图片是数据地址.

此接口使用Ai模块来实现,比传统的FindPicMem的效果更好.不需要训练

**函数原型:**\
\
long AiFindPicMem(x1, y1, x2, y2, pic\_info,sim, dir,intX, intY)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
pic\_info 字符串: 图片数据地址集合. 格式为"地址1,长度1|地址2,长度2.....|地址n,长度n". 可以用[AppendPicAddr](#chmtopic35)来组合. \
`          `地址表示24位位图资源在内存中的首地址，用十进制的数值表示\
`          `长度表示位图资源在内存中的长度，用十进制数值表示.\
sim 双精度浮点数:相似度,取值范围0.1-1.0\
dir 整形数:查找方向 0: 从左到右,从上到下 1: 从左到右,从下到上 2: 从右到左,从上到下 3: 从右到左, 从下到上\
intX 变参指针:返回图片左上角的X坐标\
intY 变参指针:返回图片左上角的Y坐标

**返回值:**

整形数:\
返回找到的图片的序号,从0开始索引.如果没找到返回-1

<a name="chmtopic38"></a>**函数简介:**

查找指定区域内的图片,位图必须是24位色格式,支持透明色,当图像上下左右4个顶点的颜色一样时,则这个颜色将作为透明色处理.

这个函数可以查找多个图片,并且返回所有找到的图像的坐标. 这个函数要求图片是数据地址.

此接口使用Ai模块来实现,比传统的FindPicMemEx的效果更好.不需要训练

**函数原型:**\
\
string AiFindPicMemEx(x1, y1, x2, y2, pic\_info,sim, dir)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
pic\_info 字符串: 图片数据地址集合. 格式为"地址1,长度1|地址2,长度2.....|地址n,长度n". 可以用[AppendPicAddr](#chmtopic35)来组合. \
`          `地址表示24位位图资源在内存中的首地址，用十进制的数值表示\
`          `长度表示位图资源在内存中的长度，用十进制数值表示.\
sim 双精度浮点数:相似度,取值范围0.1-1.0\
dir 整形数:查找方向 0: 从左到右,从上到下 1: 从左到右,从下到上 2: 从右到左,从上到下 3: 从右到左, 从下到上

**返回值:**

字符串:\
返回的是所有找到的坐标格式如下:"id,x,y|id,x,y..|id,x,y" (图片左上角的坐标)

比如"0,100,20|2,30,40" 表示找到了两个,第一个,对应的图片是图像序号为0的图片,坐标是(100,20),第二个是序号为2的图片,坐标(30,40)\
(由于内存限制,返回的图片数量最多为1500个左右)

<a name="chmtopic40"></a>**函数简介:**

根据指定的位图创建一个自定义形状的窗口

**函数原型:**\
\
long CreateFoobarCustom(hwnd,x,y,pic\_name,trans\_color,sim) 

**参数定义:**\
\
hwnd 整形数: 指定的窗口句柄,如果此值为0,那么就在桌面创建此窗口\
\
x 整形数: 左上角X坐标(相对于hwnd客户区坐标)

y 整形数: 左上角Y坐标(相对于hwnd客户区坐标)

pic\_name 字符串: 位图名字. [如果第一个字符是@,则采用指针方式. @后面是指针地址和大小. 必须是十进制](mailto:如果第一个字符是@,则采用指针方式.%20@后面是指针地址和大小.%20必须是十进制). 具体看下面的例子

trans\_color 字符串: 透明色(RRGGBB)

sim 双精度浮点数: 透明色的相似值 0.1-1.0

**返回值:**\
\
整形数 : 创建成功的窗口句柄

<a name="chmtopic42"></a>**函数简介:**

创建一个椭圆窗口

**函数原型:**\
\
long CreateFoobarEllipse(hwnd,x,y,w,h) 

**参数定义:**\
\
hwnd整形数: 指定的窗口句柄,如果此值为0,那么就在桌面创建此窗口\
\
x整形数: 左上角X坐标(相对于hwnd客户区坐标)

y整形数: 左上角Y坐标(相对于hwnd客户区坐标)

w整形数: 矩形区域的宽度

h整形数: 矩形区域的高度

**返回值:**\
\
整形数 : 创建成功的窗口句柄

<a name="chmtopic44"></a>**函数简介:**

创建一个矩形窗口

**函数原型:**\
\
long CreateFoobarRect(hwnd,x,y,w,h) 

**参数定义:**\
\
hwnd整形数: 指定的窗口句柄,如果此值为0,那么就在桌面创建此窗口\
\
x整形数: 左上角X坐标(相对于hwnd客户区坐标)

y整形数: 左上角Y坐标(相对于hwnd客户区坐标)

w整形数: 矩形区域的宽度

h整形数: 矩形区域的高度

**返回值:**\
\
整形数 : 创建成功的窗口句柄

<a name="chmtopic46"></a>**函数简介:**

创建一个圆角矩形窗口

**函数原型:**\
\
long CreateFoobarRoundRect(hwnd,x,y,w,h,rw,rh) 

**参数定义:**\
\
hwnd整形数: 指定的窗口句柄,如果此值为0,那么就在桌面创建此窗口\
\
x整形数: 左上角X坐标(相对于hwnd客户区坐标)

y整形数: 左上角Y坐标(相对于hwnd客户区坐标)

w整形数: 矩形区域的宽度

h整形数: 矩形区域的高度

rw整形数: 圆角的宽度

rh整形数: 圆角的高度

**返回值:**\
\
整形数 : 创建成功的窗口句柄

<a name="chmtopic48"></a>**函数简介:**

清除指定的Foobar滚动文本区

**函数原型:**\
\
long FoobarClearText(hwnd) 

**参数定义:**\
\
hwnd整形数: 指定的Foobar窗口句柄,此句柄必须是通过CreateFoobarxxx创建而来

**返回值:**

整形数 :\
0 : 失败

1 : 成功

<a name="chmtopic50"></a>**函数简介:**

关闭一个Foobar,注意,必须调用此函数来关闭窗口,用SetWindowState也可以关闭,但会造成内存泄漏.

**函数原型:**\
\
long FoobarClose(hwnd) 

**参数定义:**\
\
hwnd整形数: 指定的Foobar窗口句柄

**返回值:**\
\
整形数:\
0: 失败

1: 成功

<a name="chmtopic52"></a>**函数简介:**

在指定的Foobar窗口内部画线条. 

**函数原型:**\
\
long FoobarDrawLine(hwnd,x1,y1,x2,y2,color,style,width) 

**参数定义:**\
\
hwnd 整形数: 指定的Foobar窗口,注意,此句柄必须是通过CreateFoobarxxxx系列函数创建出来的\
\
x1 整形数: 左上角X坐标(相对于hwnd客户区坐标)

y1 整形数: 左上角Y坐标(相对于hwnd客户区坐标)

x2 整形数: 右下角X坐标(相对于hwnd客户区坐标)

y2 整形数: 右下角Y坐标(相对于hwnd客户区坐标)

color字符串: 填充的颜色值

style 整形数: 画笔类型. 0为实线. 1为虚线

width 整形数: 线条宽度. 

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic54"></a>**函数简介:**

在指定的Foobar窗口绘制图像

**函数原型:**\
\
long FoobarDrawPic(hwnd,x,y,pic\_name,trans\_color) 

**参数定义:**\
\
hwnd整形数: 指定的Foobar窗口,注意,此句柄必须是通过CreateFoobarxxxx系列函数创建出来的\
\
x整形数: 左上角X坐标(相对于hwnd客户区坐标)

y整形数: 左上角Y坐标(相对于hwnd客户区坐标)

pic\_name字符串: 图像文件名 [如果第一个字符是@,则采用指针方式. @后面是指针地址和大小. 必须是十进制](mailto:如果第一个字符是@,则采用指针方式.%20@后面是指针地址和大小.%20必须是十进制). 具体看下面的例子

trans\_color字符串: 图像透明色

**返回值:**

整形数 :\
0 : 失败

1 : 成功

<a name="chmtopic56"></a>**函数简介:**

在指定的Foobar窗口绘制文字

**函数原型:**\
\
long FoobarDrawText(hwnd,x,y,w,h,text,color,align) 

**参数定义:**\
\
hwnd整形数: 指定的Foobar窗口,注意,此句柄必须是通过CreateFoobarxxxx系列函数创建出来的\
\
x整形数: 左上角X坐标(相对于hwnd客户区坐标)

y整形数: 左上角Y坐标(相对于hwnd客户区坐标)

w整形数: 矩形区域的宽度

h整形数: 矩形区域的高度

text字符串: 字符串

color字符串: 文字颜色值

align 整形数: 取值定义如下

1 : 左对齐

2 : 中间对齐

4 : 右对齐

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic58"></a>**函数简介:**

在指定的Foobar窗口内部填充矩形

**函数原型:**\
\
long FoobarFillRect(hwnd,x1,y1,x2,y2,color) 

**参数定义:**\
\
hwnd 整形数: 指定的Foobar窗口,注意,此句柄必须是通过CreateFoobarxxxx系列函数创建出来的\
\
x1 整形数: 左上角X坐标(相对于hwnd客户区坐标)

y1 整形数: 左上角Y坐标(相对于hwnd客户区坐标)

x2 整形数: 右下角X坐标(相对于hwnd客户区坐标)

y2 整形数: 右下角Y坐标(相对于hwnd客户区坐标)

color字符串: 填充的颜色值

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic60"></a>**函数简介:**

锁定指定的Foobar窗口,不能通过鼠标来移动

**函数原型:**\
\
long FoobarLock(hwnd) 

**参数定义:**\
\
hwnd整形数: 指定的Foobar窗口句柄,此句柄必须是通过CreateFoobarxxx创建而来

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic62"></a>**函数简介:**

向指定的Foobar窗口区域内输出滚动文字

**函数原型:**\
\
long FoobarPrintText(hwnd,text,color) 

**参数定义:**\
\
hwnd整形数: 指定的Foobar窗口句柄,此句柄必须是通过CreateFoobarxxx创建而来

text字符串: 文本内容

color字符串: 文本颜色

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic64"></a>**函数简介:**

设置指定Foobar窗口的字体

**函数原型:**\
\
long FoobarSetFont(hwnd,font\_name,size,flag) 

**参数定义:**\
\
hwnd整形数: 指定的Foobar窗口句柄,此句柄必须是通过CreateFoobarxxx创建而来

font\_name字符串: 系统字体名,注意,必须保证系统中有此字体

size整形数: 字体大小

flag整形数: 取值定义如下

0 : 正常字体

1 : 粗体

2 : 斜体

4 : 下划线

文字可以是以上的组合 比如粗斜体就是1+2,斜体带下划线就是:2+4等.

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic66"></a>**函数简介:**

设置保存指定的Foobar滚动文本区信息到文件.

**函数原型:**\
\
long FoobarSetSave(hwnd,file,enable,header) 

**参数定义:**\
\
hwnd 整形数: 指定的Foobar窗口句柄,此句柄必须是通过CreateFoobarxxx创建而来

file 字符串: 保存的文件名

enable 整形数: 取值如下\
`             `0 : 关闭向文件输出 (默认是0)\
`             `1 : 开启向文件输出

header 字符串: 输出的附加头信息. (比如行数 日期 时间信息) 格式是如下格式串的顺序组合.如果为空串，表示无附加头.\
`             `"%L0nd%" 表示附加头信息带有行号，并且是按照十进制输出. n表示按多少个十进制数字补0对齐. 比如"%L04d%",输出的行号为0001  0002 0003等. "%L03d",输出的行号为001 002 003..等.\
`             `"%L0nx%"表示附加头信息带有行号，并且是按照16进制小写输出. n表示按多少个16进制数字补0对齐. 比如"%L04x%",输出的行号为0009  000a 000b等. "%L03x",输出的行号为009 00a 00b..等.\
`             `"%L0nX%"表示附加头信息带有行号，并且是按照16进制大写输出. n表示按多少个16进制数字补0对齐. 比如"%L04X%",输出的行号为0009  000A 000B等. "%L03X",输出的行号为009 00A 00B..等.\
`             `"%yyyy%"表示年. 比如2012\
`             `"%MM%"表示月. 比如12\
`             `"%dd%"表示日. 比如28\
`             `"%hh%"表示小时. 比如13\
`             `"%mm%"表示分钟. 比如59\
`             `"%ss%"表示秒. 比如48.

**返回值:**

整形数 :\
0 : 失败

1 : 成功

<a name="chmtopic68"></a>**函数简介:**

设置指定Foobar窗口的是否透明

**函数原型:**\
\
long FoobarSetTrans(hwnd,is\_trans,color,sim) 

**参数定义:**\
\
hwnd 整形数: 指定的Foobar窗口句柄,此句柄必须是通过CreateFoobarxxx创建而来

is\_trans 整形数: 是否透明. 0为不透明(此时,color和sim无效)，1为透明.

color 字符串: 透明色(RRGGBB)

sim 双精度浮点数: 透明色的相似值 0.1-1.0

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic70"></a>**函数简介:**

在指定的Foobar窗口绘制gif动画.

**函数原型:**\
\
long FoobarStartGif(hwnd,x,y,pic\_name,repeat\_limit,delay) 

**参数定义:**\
\
hwnd整形数: 指定的Foobar窗口,注意,此句柄必须是通过CreateFoobarxxxx系列函数创建出来的\
\
x整形数: 左上角X坐标(相对于hwnd客户区坐标)

y整形数: 左上角Y坐标(相对于hwnd客户区坐标)

pic\_name字符串: 图像文件名 [如果第一个字符是@,则采用指针方式. @后面是指针地址和大小. 必须是十进制](mailto:如果第一个字符是@,则采用指针方式.%20@后面是指针地址和大小.%20必须是十进制). 具体看下面的例子

repeat\_limit 整形数: 表示重复GIF动画的次数，如果是0表示一直循环显示.大于0，则表示循环指定的次数以后就停止显示.

delay 整形数: 表示每帧GIF动画之间的时间间隔.如果是0，表示使用GIF内置的时间，如果大于0，表示使用自定义的时间间隔.

**返回值:**

整形数 :\
0 : 失败

1 : 成功

<a name="chmtopic72"></a>**函数简介:**

停止在指定foobar里显示的gif动画.

**函数原型:**\
\
long FoobarStopGif(hwnd,x,y,pic\_name) 

**参数定义:**\
\
hwnd整形数: 指定的Foobar窗口,注意,此句柄必须是通过CreateFoobarxxxx系列函数创建出来的\
\
x整形数: 左上角X坐标(相对于hwnd客户区坐标)

y整形数: 左上角Y坐标(相对于hwnd客户区坐标)

pic\_name字符串: 图像文件名

**返回值:**

整形数 :\
0 : 失败

1 : 成功

<a name="chmtopic74"></a>**函数简介:**

设置滚动文本区的文字行间距,默认是3

**函数原型:**\
\
long FoobarTextLineGap(hwnd,line\_gap) 

**参数定义:**\
\
hwnd 整形数: 指定的Foobar窗口句柄,此句柄必须是通过CreateFoobarxxx创建而来

line\_gap 整形数: 文本行间距

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic76"></a>**函数简介:**

设置滚动文本区的文字输出方向,默认是0

**函数原型:**\
\
long FoobarTextPrintDir(hwnd,dir) 

**参数定义:**\
\
hwnd 整形数: 指定的Foobar窗口句柄,此句柄必须是通过CreateFoobarxxx创建而来

dir 整形数: 0 表示向下输出

`          `: 1 表示向上输出

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic78"></a>**函数简介:**

设置指定Foobar窗口的滚动文本框范围,默认的文本框范围是窗口区域

**函数原型:**\
\
long FoobarTextRect(hwnd,x,y,w,h) 

**参数定义:**\
\
hwnd 整形数: 指定的Foobar窗口句柄,此句柄必须是通过CreateFoobarxxx创建而来

x 整形数: x坐标

y 整形数: y坐标

w 整形数: 宽度

h 整形数: 高度

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic80"></a>**函数简介:**

解锁指定的Foobar窗口,可以通过鼠标来移动

**函数原型:**\
\
long FoobarUnlock(hwnd) 

**参数定义:**\
\
hwnd 整形数: 指定的Foobar窗口句柄,此句柄必须是通过CreateFoobarxxx创建而来

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic82"></a>**函数简介:**

刷新指定的Foobar窗口

**函数原型:**\
\
long FoobarUpdate(hwnd) 

**参数定义:**\
\
hwnd 整形数: 指定的Foobar窗口,注意,此句柄必须是通过CreateFoobarxxxx系列函数创建出来的

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic166"></a>**函数简介:**

把窗口坐标转换为屏幕坐标 

**函数原型:**\
\
long ClientToScreen(hwnd,x,y) 

**参数定义:**\
\
hwnd 整形数: 指定的窗口句柄

x 变参指针: 窗口X坐标

y 变参指针: 窗口Y坐标

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic168"></a>**函数简介:**

根据指定进程名,枚举系统中符合条件的进程PID,并且按照进程打开顺序排序.

**函数原型:**\
\
string EnumProcess(name) 

**参数定义:**

name 字符串:进程名,比如qq.exe

**返回值:**

字符串 :\
返回所有匹配的进程PID,并按打开顺序排序,格式"pid1,pid2,pid3"

<a name="chmtopic170"></a>**函数简介:**

根据指定条件,枚举系统中符合条件的窗口,可以枚举到按键自带的无法枚举到的窗口

**函数原型:**\
\
string EnumWindow(parent,title,class\_name,filter) 

**参数定义:**

parent 整形数: 获得的窗口句柄是该窗口的子窗口的窗口句柄,取0时为获得桌面句柄

title 字符串: 窗口标题. 此参数是模糊匹配.

class\_name 字符串: 窗口类名. 此参数是模糊匹配.

filter整形数: 取值定义如下

1 : 匹配窗口标题,参数title有效 

2 : 匹配窗口类名,参数class\_name有效.

4 : 只匹配指定父窗口的第一层孩子窗口

8 : 匹配父窗口为0的窗口,即顶级窗口

16 : 匹配可见的窗口

32 : 匹配出的窗口按照窗口打开顺序依次排列

这些值可以相加,比如4+8+16就是类似于任务管理器中的窗口列表

**返回值:**

字符串 :\
返回所有匹配的窗口句柄字符串,格式"hwnd1,hwnd2,hwnd3"

<a name="chmtopic172"></a>**函数简介:**

根据指定进程以及其它条件,枚举系统中符合条件的窗口,可以枚举到按键自带的无法枚举到的窗口

**函数原型:**\
\
string EnumWindowByProcess(process\_name,title,class\_name,filter) 

**参数定义:**

process\_name 字符串: 进程映像名.比如(svchost.exe). 此参数是精确匹配,但不区分大小写.

title 字符串: 窗口标题. 此参数是模糊匹配.

class\_name 字符串: 窗口类名. 此参数是模糊匹配.

filter 整形数: 取值定义如下

1 : 匹配窗口标题,参数title有效

2 : 匹配窗口类名,参数class\_name有效

4 : 只匹配指定映像的所对应的第一个进程. 可能有很多同映像名的进程，只匹配第一个进程的.

8 : 匹配父窗口为0的窗口,即顶级窗口

16 : 匹配可见的窗口

32 : 匹配出的窗口按照窗口打开顺序依次排列

这些值可以相加,比如4+8+16

**返回值:**

字符串:\
返回所有匹配的窗口句柄字符串,格式"hwnd1,hwnd2,hwnd3"

<a name="chmtopic174"></a>**函数简介:**

根据指定进程pid以及其它条件,枚举系统中符合条件的窗口,可以枚举到按键自带的无法枚举到的窗口

**函数原型:**\
\
string EnumWindowByProcessId(pid,title,class\_name,filter) 

**参数定义:**

pid 整形数: 进程pid.

title 字符串: 窗口标题. 此参数是模糊匹配.

class\_name 字符串: 窗口类名. 此参数是模糊匹配.

filter 整形数: 取值定义如下

1 : 匹配窗口标题,参数title有效

2 : 匹配窗口类名,参数class\_name有效

8 : 匹配父窗口为0的窗口,即顶级窗口

16 : 匹配可见的窗口

这些值可以相加,比如2+8+16

**返回值:**

字符串:\
返回所有匹配的窗口句柄字符串,格式"hwnd1,hwnd2,hwnd3"

<a name="chmtopic176"></a>**函数简介:**

根据两组设定条件来枚举指定窗口. 

**函数原型:**\
\
string EnumWindowSuper(spec1,flag1,type1,spec2,flag2,type2,sort) 

**参数定义:**

spec1 字符串: 查找串1. (内容取决于flag1的值)

flag1整形数: 取值如下:

`   `0表示spec1的内容是标题

`   `1表示spec1的内容是程序名字. (比如notepad)

`   `2表示spec1的内容是类名

`   `3表示spec1的内容是程序路径.(不包含盘符,比如\windows\system32)

`   `4表示spec1的内容是父句柄.(十进制表达的串)

`   `5表示spec1的内容是父窗口标题

`   `6表示spec1的内容是父窗口类名

`   `7表示spec1的内容是顶级窗口句柄.(十进制表达的串)

`   `8表示spec1的内容是顶级窗口标题

`   `9表示spec1的内容是顶级窗口类名

type1 整形数: 取值如下

0精确判断

1模糊判断

spec2 字符串: 查找串2. (内容取决于flag2的值)

flag2 整形数: 取值如下:

`   `0表示spec2的内容是标题

`   `1表示spec2的内容是程序名字. (比如notepad)

`   `2表示spec2的内容是类名

`   `3表示spec2的内容是程序路径.(不包含盘符,比如\windows\system32)

`   `4表示spec2的内容是父句柄.(十进制表达的串)

`   `5表示spec2的内容是父窗口标题

`   `6表示spec2的内容是父窗口类名

`   `7表示spec2的内容是顶级窗口句柄.(十进制表达的串)

`   `8表示spec2的内容是顶级窗口标题

`   `9表示spec2的内容是顶级窗口类名

type2  整形数: 取值如下

0精确判断

1模糊判断

sort  整形数: 取值如下

0不排序.

1对枚举出的窗口进行排序,按照窗口打开顺序.

**返回值:**\
\
字符串:\
返回所有匹配的窗口句柄字符串,格式"hwnd1,hwnd2,hwnd3"

<a name="chmtopic178"></a>**函数简介:**

查找符合类名或者标题名的顶层可见窗口

**函数原型:**\
\
long FindWindow(class,title) 

**参数定义:**

class 字符串: 窗口类名，如果为空，则匹配所有. 这里的匹配是模糊匹配.

title 字符串: 窗口标题,如果为空，则匹配所有.这里的匹配是模糊匹配.

**返回值:**

整形数:\
整形数表示的窗口句柄，没找到返回0

<a name="chmtopic180"></a>**函数简介:**

根据指定的进程名字，来查找可见窗口.

**函数原型:**\
\
long FindWindowByProcess(process\_name,class,title) 

**参数定义:**\
\
process\_name 字符串: 进程名. 比如(notepad.exe).这里是精确匹配,但不区分大小写.**\
\
class 字符串: 窗口类名，如果为空，则匹配所有. 这里的匹配是模糊匹配.

title 字符串: 窗口标题,如果为空，则匹配所有.这里的匹配是模糊匹配.

**返回值:**\
\
整形数:\
整形数表示的窗口句柄，没找到返回0

<a name="chmtopic182"></a>**函数简介:**

根据指定的进程Id，来查找可见窗口.

**函数原型:**\
\
long FindWindowByProcessId(process\_id,class,title) 

**参数定义:**\
\
process\_id 整形数: 进程id.** \
\
class 字符串: 窗口类名，如果为空，则匹配所有. 这里的匹配是模糊匹配.

title 字符串: 窗口标题,如果为空，则匹配所有.这里的匹配是模糊匹配.

**返回值:**\
\
整形数:\
整形数表示的窗口句柄，没找到返回0

<a name="chmtopic184"></a>**函数简介:**

查找符合类名或者标题名的顶层可见窗口,如果指定了parent,则在parent的第一层子窗口中查找.

**函数原型:**\
\
long FindWindowEx(parent,class,title) 

**参数定义:**

parent 整形数: 父窗口句柄，如果为空，则匹配所有顶层窗口

class 字符串: 窗口类名，如果为空，则匹配所有. 这里的匹配是模糊匹配.

title 字符串: 窗口标题,如果为空，则匹配所有. 这里的匹配是模糊匹配.

**返回值:**

整形数:\
整形数表示的窗口句柄，没找到返回0

<a name="chmtopic186"></a>**函数简介:**

根据两组设定条件来查找指定窗口. 

**函数原型:**\
\
long FindWindowSuper(spec1,flag1,type1,spec2,flag2,type2) 

**参数定义:**

spec1 字符串: 查找串1. (内容取决于flag1的值)

flag1整形数: 取值如下:

`   `0表示spec1的内容是标题

`   `1表示spec1的内容是程序名字. (比如notepad)

`   `2表示spec1的内容是类名

`   `3表示spec1的内容是程序路径.(不包含盘符,比如\windows\system32)

`   `4表示spec1的内容是父句柄.(十进制表达的串)

`   `5表示spec1的内容是父窗口标题

`   `6表示spec1的内容是父窗口类名

`   `7表示spec1的内容是顶级窗口句柄.(十进制表达的串)

`   `8表示spec1的内容是顶级窗口标题

`   `9表示spec1的内容是顶级窗口类名

type1 整形数: 取值如下

0精确判断

1模糊判断

spec2 字符串: 查找串2. (内容取决于flag2的值)

flag2 整形数: 取值如下:

`   `0表示spec2的内容是标题

`   `1表示spec2的内容是程序名字. (比如notepad)

`   `2表示spec2的内容是类名

`   `3表示spec2的内容是程序路径.(不包含盘符,比如\windows\system32)

`   `4表示spec2的内容是父句柄.(十进制表达的串)

`   `5表示spec2的内容是父窗口标题

`   `6表示spec2的内容是父窗口类名

`   `7表示spec2的内容是顶级窗口句柄.(十进制表达的串)

`   `8表示spec2的内容是顶级窗口标题

`   `9表示spec2的内容是顶级窗口类名

type2  整形数: 取值如下

0精确判断

1模糊判断

**返回值:**\
\
整形数:\
整形数表示的窗口句柄，没找到返回0

<a name="chmtopic188"></a>**函数简介:**

获取窗口客户区域在屏幕上的位置

**函数原型:**\
\
long GetClientRect(hwnd,x1,y1,x2,y2) 

**参数定义:**\
\
hwnd 整形数: 指定的窗口句柄\
\
x1 变参指针: 返回窗口客户区左上角X坐标

y1 变参指针: 返回窗口客户区左上角Y坐标

x2 变参指针: 返回窗口客户区右下角X坐标

y2 变参指针: 返回窗口客户区右下角Y坐标

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic190"></a>**函数简介:**

获取窗口客户区域的宽度和高度

**函数原型:**\
\
long GetClientSize(hwnd,width,height) 

**参数定义:**\
\
hwnd 整形数: 指定的窗口句柄\
\
width 变参指针: 宽度

height 变参指针: 高度

**返回值:**\
\
整形数:\
0: 失败\
1: 成功

<a name="chmtopic192"></a>**函数简介:**

获取顶层活动窗口中具有输入焦点的窗口句柄 

**函数原型:**\
\
long GetForegroundFocus() 

**参数定义:**

**返回值:**

整形数:\
返回整型表示的窗口句柄

<a name="chmtopic194"></a>**函数简介:**

获取顶层活动窗口,可以获取到按键自带插件无法获取到的句柄

**函数原型:**\
\
long GetForegroundWindow() 

**参数定义:**

**返回值:**

整形数:\
返回整型表示的窗口句柄

<a name="chmtopic196"></a>**函数简介:**

获取鼠标指向的可见窗口句柄,可以获取到按键自带的插件无法获取到的句柄

**函数原型:**\
\
long GetMousePointWindow() 

**参数定义:**

**返回值:**

整形数:\
返回整型表示的窗口句柄

<a name="chmtopic198"></a>**函数简介:**

获取给定坐标的可见窗口句柄,可以获取到按键自带的插件无法获取到的句柄

**函数原型:**\
\
long GetPointWindow(x,y) 

**参数定义:**

X 整形数: 屏幕X坐标

Y 整形数: 屏幕Y坐标

**返回值:**

整形数:\
返回整型表示的窗口句柄

<a name="chmtopic200"></a>**函数简介:**

根据指定的pid获取进程详细信息,(进程名,进程全路径,CPU占用率(百分比),内存占用量(字节))

**函数原型:**\
\
string GetProcessInfo(pid) 

**参数定义:**

pid 整形数: 进程pid 

**返回值:**\
\
字符串:\
格式"进程名|进程路径|cpu|内存"

<a name="chmtopic202"></a>**函数简介:**

获取特殊窗口

**函数原型:**\
\
long GetSpecialWindow(flag) 

**参数定义:**

Flag 整形数: 取值定义如下

0 : 获取桌面窗口

1 : 获取任务栏窗口

**返回值:**

整形数:\
以整型数表示的窗口句柄

<a name="chmtopic204"></a>**函数简介:**

获取给定窗口相关的窗口句柄

**函数原型:**\
\
long GetWindow(hwnd,flag) 

**参数定义:**

hwnd 整形数: 窗口句柄

flag 整形数: 取值定义如下

0 : 获取父窗口

1 : 获取第一个儿子窗口

2 : 获取First 窗口

3 : 获取Last窗口

4 : 获取下一个窗口

5 : 获取上一个窗口

6 : 获取拥有者窗口

7 : 获取顶层窗口

**返回值:**

整形数:\
返回整型表示的窗口句柄

<a name="chmtopic206"></a>**函数简介:**

获取窗口的类名

**函数原型:**\
\
string GetWindowClass(hwnd)

**参数定义:**\
\
hwnd 整形数: 指定的窗口句柄

**返回值:**

字符串:\
窗口的类名

<a name="chmtopic208"></a>**函数简介:**

获取指定窗口所在的进程ID.

**函数原型:**\
\
long GetWindowProcessId(hwnd) 

**参数定义:**

hwnd 整形数: 窗口句柄

**返回值:**

整形数:\
返回整型表示的是进程ID

<a name="chmtopic210"></a>**函数简介:**

获取指定窗口所在的进程的exe文件全路径.

**函数原型:**\
\
string GetWindowProcessPath(hwnd) 

**参数定义:**

hwnd 整形数: 窗口句柄

**返回值:**

字符串:\
返回字符串表示的是exe全路径名

<a name="chmtopic212"></a>**函数简介:**

获取窗口在屏幕上的位置

**函数原型:**\
\
long GetWindowRect(hwnd,x1,y1,x2,y2) 

**参数定义:**\
\
hwnd 整形数: 指定的窗口句柄\
\
x1 变参指针: 返回窗口左上角X坐标

y1 变参指针: 返回窗口左上角Y坐标

x2 变参指针: 返回窗口右下角X坐标

y2 变参指针: 返回窗口右下角Y坐标

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic214"></a>**函数简介:**

获取指定窗口的一些属性

**函数原型:**\
\
long GetWindowState(hwnd,flag) 

**参数定义:**\
\
hwnd 整形数: 指定的窗口句柄\
\
flag 整形数: 取值定义如下

0 : 判断窗口是否存在

1 : 判断窗口是否处于激活

2 : 判断窗口是否可见

3 : 判断窗口是否最小化

4 : 判断窗口是否最大化

5 : 判断窗口是否置顶

6 : 判断窗口是否无响应

7 : 判断窗口是否可用(灰色为不可用)

8 : 另外的方式判断窗口是否无响应,如果6无效可以尝试这个

9 : 判断窗口所在进程是不是64位

**返回值:**

整形数:\
0: 不满足条件\
1: 满足条件

<a name="chmtopic216"></a>**函数简介:**

获取指定窗口所在的线程ID.

**函数原型:**\
\
long GetWindowThreadId(hwnd) 

**参数定义:**

hwnd 整形数: 窗口句柄

**返回值:**

整形数:\
返回整型表示的是线程ID

<a name="chmtopic218"></a>**函数简介:**

获取窗口的标题

**函数原型:**\
\
string GetWindowTitle(hwnd)

**参数定义:**\
\
hwnd 整形数: 指定的窗口句柄

**返回值:**

字符串:\
窗口的标题

<a name="chmtopic220"></a>**函数简介:**

移动指定窗口到指定位置

**函数原型:**\
\
long MoveWindow(hwnd,x,y) 

**参数定义:**\
\
hwnd 整形数: 指定的窗口句柄\
\
x 整形数: X坐标

y 整形数: Y坐标

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic222"></a>**函数简介:** 

把屏幕坐标转换为窗口坐标

**函数原型:**\
\
long ScreenToClient(hwnd,x,y) 

**参数定义:**\
\
hwnd 整形数: 指定的窗口句柄\
\
x 变参指针: 屏幕X坐标

y 变参指针: 屏幕Y坐标

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic224"></a>**函数简介:**

向指定窗口发送粘贴命令. 把剪贴板的内容发送到目标窗口.

**函数原型:**\
\
long SendPaste(hwnd) 

**参数定义:**\
\
hwnd 整形数: 指定的窗口句柄. 如果为0,则对当前激活的窗口发送.

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic226"></a>**函数简介:**

向指定窗口发送文本数据

**函数原型:**\
\
long SendString(hwnd,str) 

**参数定义:**\
\
hwnd 整形数: 指定的窗口句柄. 如果为0,则对当前激活的窗口发送.\
\
str 字符串: 发送的文本数据

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic228"></a>**函数简介:**

向指定窗口发送文本数据

**函数原型:**\
\
long SendString2(hwnd,str) 

**参数定义:**\
\
hwnd 整形数: 指定的窗口句柄. 如果为0,则对当前激活的窗口发送.\
\
str 字符串: 发送的文本数据

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic230"></a>**函数简介:**

向绑定的窗口发送文本数据.必须配合dx.public.input.ime属性.

**函数原型:**\
\
long SendStringIme(str) 

**参数定义:**\
\
str 字符串: 发送的文本数据

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic232"></a>**函数简介:**

利用真实的输入法，对指定的窗口输入文字.

**函数原型:**\
\
long SendStringIme2(hwnd,str,mode) 

**参数定义:**\
\
hwnd整形数: 窗口句柄\
str 字符串: 发送的文本数据\
mode整形数: 取值意义如下:\
`            `0 : 向hwnd的窗口输入文字(前提是必须先用模式200安装了输入法)\
`            `1 : 同模式0,如果由于保护无效，可以尝试此模式.(前提是必须先用模式200安装了输入法)\
`            `2 : 同模式0,如果由于保护无效，可以尝试此模式. (前提是必须先用模式200安装了输入法)\
`            `200 : 向系统中安装输入法,多次调用没问题. 全局只用安装一次.\
`            `300 : 卸载系统中的输入法. 全局只用卸载一次. 多次调用没关系.

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic234"></a>**函数简介:**

设置窗口客户区域的宽度和高度

**函数原型:**\
\
long SetClientSize(hwnd,width,height) 

**参数定义:**\
\
hwnd 整形数: 指定的窗口句柄\
\
width 整形数: 宽度

height 整形数: 高度

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic236"></a>**函数简介:**

设置窗口的大小

**函数原型:**\
\
long SetWindowSize(hwnd,width,height) 

**参数定义:**\
\
hwnd 整形数: 指定的窗口句柄\
\
width 整形数: 宽度

height 整形数: 高度

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic239"></a>**函数简介:**

设置窗口的状态

**函数原型:**\
\
long SetWindowState(hwnd,flag) 

**参数定义:**\
\
hwnd 整形数: 指定的窗口句柄\
\
flag 整形数: 取值定义如下

0 : 关闭指定窗口

1 : 激活指定窗口

2 : 最小化指定窗口,但不激活

3 : 最小化指定窗口,并释放内存,但同时也会激活窗口.(释放内存可以考虑用[FreeProcessMemory](#chmtopic238)函数)

4 : 最大化指定窗口,同时激活窗口.

5 : 恢复指定窗口 ,但不激活

6 : 隐藏指定窗口

7 : 显示指定窗口

8 : 置顶指定窗口

9 : 取消置顶指定窗口

10 : 禁止指定窗口

11 : 取消禁止指定窗口

12 : 恢复并激活指定窗口

13 : 强制结束窗口所在进程.

14 : 闪烁指定的窗口

15 : 使指定的窗口获取输入焦点

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic241"></a>**函数简介:**

设置窗口的标题

**函数原型:**\
\
long SetWindowText(hwnd,title) 

**参数定义:**\
\
hwnd 整形数: 指定的窗口句柄\
\
titie 字符串: 标题

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic243"></a>**函数简介:**

设置窗口的透明度

**函数原型:**\
\
long SetWindowTransparent(hwnd,trans) 

**参数定义:**\
\
hwnd 整形数: 指定的窗口句柄\
\
trans 整形数: 透明度 取值(0-255) 越小透明度越大 0为完全透明(不可见) 255为完全显示(不透明)

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic245"></a>**函数简介:**

设置SendString和SendString2的每个字符之间的发送间隔.  有些窗口必须设置延迟才可以正常发送. 否则可能会顺序错乱.

**函数原型:**\
\
long SetSendStringDelay(delay) 

**参数定义:**\
\
delay 整形数: 大于等于0的延迟数值. 单位是毫秒. 默认是0

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic247"></a>**函数简介:**

可以把上次FaqPost的发送取消,接着下一次FaqPost

**函数原型:**\
\
long FaqCancel() 

**参数定义:**

**返回值:**

整形数:\
0 : 失败\
1 : 成功

<a name="chmtopic249"></a>**函数简介:**

截取指定范围内的动画或者图像,并返回此句柄.

**函数原型:**\
\
long FaqCapture(x1, y1, x2, y2, quality, delay, time) 

**参数定义:**\
\
x1 整形数: 左上角X坐标

y1 整形数: 左上角Y坐标

x2 整形数: 右下角X坐标

y2 整形数: 右下角Y坐标

quality 整形数: 图像或动画品质,或者叫压缩率,此值越大图像质量越好 取值范围（1-100或者250） 当此值为250时，那么会截取无损bmp图像数据.

delay 整形数: 截取动画时用,表示相隔两帧间的时间间隔,单位毫秒 （如果只是截取静态图像,这个参数必须是0）

time 整形数: 表示总共截取多久的动画,单位毫秒 （如果只是截取静态图像,这个参数必须是0）

**返回值:**

整形数:\
图像或者动画句柄

<a name="chmtopic251"></a>**函数简介:**

截取指定图片中的图像,并返回此句柄. 

**函数原型:**\
\
long FaqCaptureFromFile(x1, y1, x2, y2, file, quality) 

**参数定义:**\
\
x1 整形数: 左上角X坐标

y1 整形数: 左上角Y坐标

x2 整形数: 右下角X坐标

y2 整形数: 右下角Y坐标

file 字符串: 图片文件名,图像格式基本都支持.

quality 整形数: 图像或动画品质,或者叫压缩率,此值越大图像质量越好 取值范围（1-100或者250）.当此值为250时,会截取无损bmp图像数据.

**返回值:**

整形数:\
图像或者动画句柄

<a name="chmtopic253"></a>**函数简介:**

从给定的字符串(也可以算是文字类型的问题),获取此句柄. （此接口必须配合答题器v30以后的版本）

**函数原型:**\
\
long FaqCaptureString(str) 

**参数定义:**

str 字符串: 文字类型的问题. 比如(桃园三结义指的是哪些人?) 

**返回值:**

整形数:\
文字句柄

<a name="chmtopic255"></a>**函数简介:**

获取由FaqPost发送后，由服务器返回的答案.

**函数原型:**\
\
string FaqFetch() 

**参数定义:**

**返回值:**

字符串:\
如果此函数调用失败,那么返回值如下

"Error:错误描述" 

如果函数调用成功,那么返回值如下

"OK:答案"

根据FaqPost中 request\_type取值的不同,返回值不同

当request\_type 为0时,答案的格式为"x,y" (不包含引号)

当request\_type 为1时,答案的格式为"1" "2" "3" "4" "5" "6" (不包含引号)

当request\_type 为2时,答案就是要求的答案 比如 "李白" (不包含引号)

当request\_type 为3时,答案的格式为"x1,y1|..|xn,yn" 比如 "20,30|78,68|33,33" (不包含引号)

如果返回为空字符串，表示FaqPost还未处理完毕,或者没有调用过FaqPost.

<a name="chmtopic257"></a>**函数简介:**

获取句柄所对应的数据包的大小,单位是字节

**函数原型:**\
\
long FaqGetSize(handle) 

**参数定义:**\
\
handle 整形数: 由FaqCapture返回的句柄

**返回值:**

整形数:\
数据包大小,一般用于判断数据大小,选择合适的压缩比率.

<a name="chmtopic259"></a>**函数简介:**

用于判断当前对象是否有发送过答题(FaqPost)

**函数原型:**\
\
long FaqIsPosted() 

**参数定义:**

**返回值:**

整形数:\
0 : 没有\
1 : 有发送过

<a name="chmtopic261"></a>**函数简介:**

发送指定的图像句柄到指定的服务器,并立即返回(异步操作).

**函数原型:**\
\
long FaqPost(server, handle, request\_type, time\_out) 

**参数定义:**\
\
server 字符串: 服务器地址以及端口,格式为(ip:port),例如 "192.168.1.100:12345"

handle 整形数: 由FaqCapture获取到的句柄

request\_type 整形数: 取值定义如下

`             `0 : 要求获取坐标

`             `1 : 要求获取选项,比如(ABCDE)

`             `2 : 要求获取文字答案

3 : 要求获取N个坐标.此功能要求答题器必须是v15之后的版本.

time\_out 整形数: 表示等待多久,单位是毫秒

**返回值:**

整形数:\
0 : 失败，一般情况下是由于上个FaqPost还没有处理完毕(服务器还没返回)

1 : 成功

<a name="chmtopic263"></a>**函数简介:**

发送指定的图像句柄到指定的服务器,并等待返回结果(同步等待).

**函数原型:**\
\
string FaqSend(server, handle, request\_type, time\_out) 

**参数定义:**\
\
server 字符串: 服务器地址以及端口,格式为(ip:port),例如 "192.168.1.100:12345"\
`         `多个地址可以用"|"符号连接。比如"192.168.1.100:12345|192.168.1.101:12345"。

handle 整形数: 由FaqCapture获取到的句柄

request\_type 整形数: 取值定义如下

`             `0 : 要求获取坐标

`             `1 : 要求获取选项,比如(ABCDE)

`             `2 : 要求获取文字答案

3 : 要求获取N个坐标.此功能要求答题器必须是v15之后的版本.

time\_out 整形数: 表示等待多久,单位是毫秒

**返回值:**

字符串:

如果此函数调用失败,那么返回值如下

"Error:错误描述" 

如果函数调用成功,那么返回值如下

"OK:答案"

根据request\_type取值的不同,返回值不同

当request\_type 为0时,答案的格式为"x,y" (不包含引号)

当request\_type 为1时,答案的格式为"1" "2" "3" "4" "5" "6" (不包含引号)

当request\_type 为2时,答案就是要求的答案 比如 "李白" (不包含引号)

当request\_type 为3时,答案的格式为"x1,y1|...|xn,yn|" 比如 "20,30|78,68|33,33" (不包含引号)

<a name="chmtopic267"></a>**函数简介:**

针对部分检测措施的保护盾.  前面有五角星的表示同时支持32位和64位,否则就仅支持64位. \
驱动功能支持的系统版本号为(win7/win8/win8.1/win10(10240)/win10(10586)/win10(14393)/win10(15063)/win10(16299)/win10(17134)/win10(17763)/win10(18362)/win10(18363)/win10(19041)/win10(19042) /win10(19043)/win10(19044)/win10(19045)/win11(22000)/win11(22621)/win11(22631)\
不支持所有的预览版本,仅仅支持正式版本.

新点的WIN10和WIN11必须要关闭内核隔离.否则会无法加载驱动,或者加载某些功能蓝屏.

**函数原型:**\
\
long DmGuard(enable,type)

**参数定义:**

enable 整形数: \
`             `0表示关闭保护盾(仅仅对memory memory2 memory3 memory4 b2 b3起作用)\
`             `1表示打开保护盾

type 字符串: 参数具体内容可以是以下任意一个.\
` `★"np" : 这个是防止NP检测(这个盾已经过时,不建议使用).\
` `★"memory" : 这个保护内存系列接口和汇编接口可以正常运行. (此模式需要加载驱动)\
` `★"memory2" : 这个保护内存系列接口和汇编接口可以正常运行. (此模式需要加载驱动)\
` `"memory3 pid addr\_start addr\_end" : 这个保护内存系列接口和汇编接口可以正常运行.pid表示要操作内存的进程ID,指定了以后,所有内存系列接口仅能对此pid进程进行操作,其他进程无效. 但此盾速度较快。addr\_start表示起始地址(此参数可以忽略),addr\_end表示结束地址(此参数可以忽略). 另外，如果你发现有地址读写不到，可以尝试重新调用一次此盾.此盾是对指定的PID，指定的地址范围做快照. (此模式需要加载驱动)\
` `"memory4" : 这个保护内存系列接口和汇编接口可以正常运行. (此模式需要加载驱动)\
` `"memory5" : 这个保护内存系列接口和汇编接口可以正常运行. (此模式需要加载驱动,直接读写物理内存,所以对于地址空间不在物理内存里的地址,就会无法读写.)\
` `"memory6" : 这个保护内存系列接口和汇编接口可以正常运行. (此模式是memory5的加强版本,需要加载驱动,直接读写物理内存,所以对于地址空间不在物理内存里的地址,就会无法读写.)\
` `"phide [pid]" : 隐藏指定进程,保护指定进程以及进程内的窗口不被非法访问. pid为可选参数.如果不指定pid，默认保护当前进程. (此模式需要加载驱动,目前仅支持32位系统)\
` `"phide2 [pid]" : 同phide. 只是进程不隐藏(可在任务管理器中操作) (此模式需要加载驱动,目前仅支持32位系统)\
` `"phide3 [pid]" : 只隐藏进程(在任务管理器看不到),但不保护进程和窗口. (此模式需要加载驱动,目前仅支持32位系统)\
` `★"display2" : 同display,但此模式用在一些极端的场合. 比如用任何截图软件也无法截图时，可以考虑这个盾.\
\
` `★"display3 <hwnd>" : 此盾可以保护当前进程指定的窗口(和子窗口)，无法被用正常手段截图. hwnd是必选参数. 并且必须是和当前调用进程相同进程的顶级窗口. 此盾有限制,具体查看下方的备注.

"display4 <hwnd>" : 此盾可以保护指定的窗口(和子窗口)，无法被用正常手段截图. hwnd是必选参数. 并且必须是顶级窗口. (此模式需要加载驱动,此盾和display3类似. 只是使用了驱动来实现.并且没有display3的同进程限制. 在高版本的WIN10上效果会更好.)\
\
` `★"block [pid]" : 保护指定进程不被非法访问. pid为可选参数.如果不指定pid，默认保护当前进程,另种实现方式.（此模式需要加载驱动,另外此盾在64位系统下无法隐藏驱动,调用后会让驱动无法隐藏,所以64位系统下,不太建议使用此盾)\
\
` `★"b2 [pid]" : 保护指定进程不被非法访问. pid为可选参数.如果不指定pid，默认保护当前进程,另种实现方式.(此模式需要加载驱动),另外,b2盾有副作用，会导致任何和音频输出的函数无声音(比如，Play和Beep函数，或者类似此函数实现的方式. 解决办法是另外创建一个进程用来播放音乐). 另外要特别注意，个别系统上，会出现保护进程退出时，导致系统蓝屏，解决办法是在进程结束前，关闭b2盾即可. 另外测试下来新版本的WIN10也会触发pg.\
\
`  `"b3 [pid]" : 保护指定进程不被非法访问. pid为可选参数.如果不指定pid，默认保护当前进程,另种实现方式.(此模式需要加载驱动),另外,b3盾有副作用，会导致无法创建线程，无法结束线程,无法操作某些系统API(比如打开文件对话框)，无法绑定目标窗口等等,解决办法是，临时关闭b3，进行你的操作,然后再打开b3。 \
\
`  `"f1 [pid]" : 把当前进程伪装成pid指定的进程，可以保护进程路径无法被获取到.如果省略pid参数，则伪装成svchost.exe进程. (此模式需要加载驱动),另外，简单游平台专用版本无法使用此盾，原因是和简单游有冲突。   还有，使用此盾后，别人无法获取到你的进程的真实路径，但自己也同样无法获取，所以如果要获取真实路径，请务必在获取到路径后保存，再调用此盾. pid参数如果有效，那必须是一个真实存在的pid,否则会失败.如果被伪装的进程关闭了，那么当前进程也会立刻失去伪装. 还有最重要的一点，伪装的进程和目的进程，占用内存要差不多，最好目的进程占用内存要大于被伪装进程，否则可能会导致进程崩溃!!!  有些编译平台编译出的程序,貌似开这个盾会导致异常，可以尝试f2盾.\
\
` `★ "d1 [cls][add dll\_name exact]" : 阻止指定的dll加载到本进程.这里的dll\_name不区分大小写. 具体调用方法看下面的例子. \
\
` `★ "f2 <target\_process> <protect\_process>" :把protect\_process伪装成target\_process运行. 此盾会加载target\_process运行,然后用protect\_process来替换target\_process,从而达到伪装自身的目的.此盾不加载驱动. 这个protect\_process也可以使用内存地址的形式，不用路径. 写法是这样<addr,size>,addr是内存地址,size是大小,都是10进制. 后面有例子 (使用此盾后，别人无法获取到你的进程的真实路径，但自己也同样无法获取，所以如果要获取真实路径，请务必在获取到路径后保存后,通过共享内存等方式传递给保护进程). 返回值为伪装后的进程ID\
\
"hm module unlink" : 防止当前进程中的指定模块被非法访问. module为模块名(为0表示EXE模块),比如dm.dll 。 unlink取0或者1，1表示是否把模块在进程模块链表中擦除,0表示不擦除.(此模式需要加载驱动) \
\
"inject mode pid <param1> <param2>" : 注入指定的DLL到指定的进程中. mode表示注入模式. pid表示需要注入进去的进程ID . param1和param2参数含义根据mode决定.(此模式需要加载驱动)\
`    `mode取值0 1 2 3，具体含义如下:\
`    `0: 此时param1表示需要注入的dll全路径. param2表示为<unlink erase>.注入方式是通过创建线程注入.\
`       `unlink(取值0和1)，表示是否从进程模块链表中断链,取1表示断链.\
`       `erase(取值0和1),表示是否擦除PE头,取1表示擦除. \
`    `1: 此时param1表示需要注入的dll全路径. param2表示为<unlink erase>.注入方式是通过APC注入.\
`       `unlink(取值0和1)，表示是否从进程模块链表中断链,取1表示断链.\
`       `erase(取值0和1),表示是否擦除PE头,取1表示擦除. \
`    `2: 此时param1表示需要注入的dll全路径. param2表示为<hidevad erase nothread noimportdll>.注入方式是内存加载DLL.\
`       `hidevad(取值0和1),表示是否擦除vad,取1表示擦除. 注意,此参数在对部分系统上,对64位进程注入时,会导致进程崩溃.\
`       `erase(取值0和1),表示是否擦除PE头,取1表示擦除. \
`       `nothread(取值0和1),表示是否在注入时创建线程,取1表示不创建. 选1表示使用APC注入. 选0表示使用线程注入.\
`       `noimportdll(取值0和1),表示是否再次加载此DLL中的导入表DLL,取1表示不加载,直接使用.除非你真的理解这个参数的意义,否则不要轻易设置为1,会导致进程崩溃.\
`    `3: 此时param1表示需要注入的dll的地址和大小. param1表示为<addr,size>. param2表示为<hidevad erase nothread noimportdll>.注入方式是内存加载DLL.\
`       `addr表示DLL的起始地址,10进制表示. 这个同模式2.只不过DLL使用地址的方式来传递.\
`       `size表示DLL的大小，10进制表示\
`       `hidevad(取值0和1),同模式2 \
`       `erase(取值0和1), 同模式2\
`       `nothread(取值0和1), 同模式2\
`       `noimportdll(取值0和1), 同模式2\
\
`    `以上几种注入模式,最隐蔽的是2和3,并且param2取为<1,1,1,1>. 可以自己测试使用.\
`    `另外2和3对DLL是由要求的,尽可能要让DLL的导入表简单.  也就是说尽可能不要让DLL依赖太多DLL。越简单越好.

\
"del <path>" :强制删除指定的文件. path表示需要删除的文件的全路径. 当path为0时,表示为当前dm.dll的路径,当path为1时,表示为当前EXE的全路径.(此模式需要加载驱动)\
其它后续开发.

`            `"★ cl pid type name": 关闭指定进程中，对象名字中含有name的句柄. pid表示进程PID. type表示需要关闭的句柄类型. 比如Section Event Mutant等. 具体的类型可以用pchunter查看.\
`        `name表示需要查找的对象名. 注意type和name都是大小写敏感的.

`            `"hl [pid]" : 隐藏指定进程中的句柄,无法用正常手段获取到. pid为可选参数.如果不指定pid，默认为当前进程. (此模式需要加载驱动,另外此盾会在WIN10上触发pg蓝屏.win10系统必须过pg才可以使用)

`            `"gr" : 开启句柄操作，具体查看DmGuardParams相关说明. (此模式需要加载驱动)

`            `"th" : 开启线程操作，具体查看DmGuardParams相关说明. (此模式需要加载驱动)

**返回值:**\
\
整形数:\
0 : 不支持的保护盾类型\
1 : 成功\
-1 : 32位平台不支持\
-2 : 驱动释放失败.(可能原因是权限不够) \
-3 : 驱动加载失败,可能是权限不够. 参考UAC权限设置.或者是被安全软件拦截. 如果是在64位系统下返回此错误，需要安装补丁KB3033929.

如果是WIN10 1607之后的系统，出现这个错误，可[参考这里](#chmtopic84)

还有一个可能，如果使用了定制的插件，如果原先加载了老的驱动，那么新的定制可能会无法加载，返回-3. 只需要重启系统即可.(必须是重启，不是关机再开机)\
-555 : f2盾的返回值, protect\_process路径无法访问.\
-666 : f2盾的返回值, target\_process无法创建进程.(可能路径错误?)\
-777 : f2盾的返回值,其它异常错误.\
-4 -5 -6 都是异常错误.\
-7: 一般是系统版本不支持导致,用winver可以查看系统内部版本号. 驱动只支持正式发布的版本，所有预览版本都不支持.\
-8: 驱动加载失败. 检查要加载的盾需要的条件.\
-9 : 表示参数错误.\
-10 : 表示此盾的功能失败了.\
-11 : 表示分配内存失败.\
-14 : 无效的窗口句柄\
-16 : 此功能依赖的驱动没有先启动\
-20 : 此功能不可重复加载\
-30 : 通信模式1和2出此错误是异常错误.\
-31 : 通信模式1和2出此错误是异常错误.\
-32 : 通信模式1和2出此错误是异常错误.

<a name="chmtopic269"></a>**函数简介:**

释放插件用的驱动. 可以自己拿去签名. 防止有人对我的签名进行检测. 强烈推荐使用驱动的用户使用. 仅释放64位系统的驱动.

**函数原型:**\
\
long DmGuardExtract(type,path)

**参数定义:**

type 字符串: 需要释放的驱动类型. 这里写"common"即可.

path 字符串: 释放出的驱动文件全路径. 比如"c:\test.sys".

**返回值:**\
\
整形数:\
0 : 不支持的type\
1 : 成功\
-2: 释放失败

<a name="chmtopic271"></a>**函数简介:**

加载用DmGuardExtract释放出的驱动. 建议自己签名后,然后找个自己喜欢的路径加载. 仅支持64位系统的驱动加载.

加载成功后,就可以正常调用DmGuard了.

**函数原型:**\
\
long DmGuardLoadCustom(type,path)

**参数定义:**

type 字符串: 需要释放的驱动类型. 这里写"common"即可.

path 字符串:驱动文件全路径. 比如"c:\test.sys".

**返回值:**\
\
整形数:\
返回值请参考DmGuard的返回值. 一样的含义.

<a name="chmtopic273"></a>**函数简介:**

DmGuard的加强接口,用于获取一些额外信息. 具体看下面参数介绍

**函数原型:**\
\
string DmGuardParams(cmd,subcmd,param) 

**参数定义:**

cmd 字符串: 盾类型. 这里取值为"gr"或者"th"(以后可能会有扩充). 这里要注意的是,如果要获取指定的盾类型信息,必须先成功用DmGuard开启此盾.比如这里的"gr"必须dm.DmGuard 1,"gr"开启成功才可以

subcmd 字符串: 针对具体的盾类型，需要获取的具体信息.

`           `如果cmd为"gr"时,那么subcmd取值如下定义:\
`                      `"enum" : 枚举指定进程的所有句柄.\
`                      `"get"  : 获取指定进程的指定句柄信息.(类型,名字,权限值)\
`                      `"set"  : 设置指定进程的指定句柄的权限值.\
`                      `"close": 关闭指定进程的指定句柄.

`           `如果cmd为"th"时,那么subcmd取值如下定义:\
`                      `"enum" :    枚举指定进程的所有线程.\
`                      `"get"  :    获取指定线程的详细信息.(句柄值,优先级,ETHREAD,TEB,win32StartAddresss,线程地址所在的模块名,交换次数,线程状态,挂起次数)\
`                      `"resume"  : 恢复指定的线程.不可操作本线程. 当suspend\_count大于0时,每调用一次resume,都会让suspend\_count减1,直到0为止才会真正的恢复线程.\
`                      `"suspend":  挂起指定线程.不可操作本线程.\
`                      `"terminate":结束指定线程.不可操作本线程.

param 字符串: 参数信息,这里具体的含义取决于cmd和subcmd. 

`           `如果cmd为"gr"时,subcmd取值为如下时，具体的参数含义:\
`                      `"enum" : param为"pid", pid为进程pid,10进制形式.\
`                      `"get"  : param为"pid handle",pid为进程pid,10进制形式,handle为句柄值,10进制形式.\
`                      `"set"  : param为"pid handle access",pid为进程pid,10进制形式,handle为句柄值,10进制形式,access为权限值,10进制形式.\
`                      `"close": param为"pid handle", pid为进程pid,10进制形式,handle为句柄值,10进制形式.

`           `如果cmd为"th"时,subcmd取值为如下时，具体的参数含义:\
`                      `"enum" :     param为"pid", pid为进程pid,10进制形式.\
`                      `"get"  :     param为"tid", tid为线程tid,10进制形式. \
`                      `"resume"  :  param为"tid", tid为线程tid,10进制形式.\
`                      `"suspend"  : param为"tid", tid为线程tid,10进制形式.\
`                      `"terminate": param为"tid", tid为线程tid,10进制形式.

**返回值:**

字符串: 根据不同的cmd和subcmd,返回值不同.

`           `如果cmd为"gr"时,subcmd取值为如下时，具体的返回值:\
`                      `"enum" : "handle1|handle2|.....|handlen",每个handle都是10进制长整数. 如果失败返回空字符串\
`                      `"get"  : "type|name|access". type表示句柄的类型，比如"Event","File"等之类的. name表示句柄的名字,有些句柄的名字可能是空的. access10进制整数,表示此句柄的权限值. 如果失败返回空字符串\
`                      `"set"  : 成功返回"ok",否则为空字符串.\
`                      `"close": 成功返回"ok",否则为空字符串.

`           `如果cmd为"th"时,subcmd取值为如下时，具体的返回值:\
`                      `"enum" : "tid1|tid2|.....|tidn",每个tid都是10进制整数. 如果失败返回空字符串\
`                      `"get"  : "tid|prority|ethread|teb|win32StartAddress|module\_name|switch\_count|state|suspend\_count".如果失败返回空字符串.\
`                                `tid : 线程tid,10进制整数\
`                                `prority : 线程优先级, 10进制整数\
`                                `ethread : 线程内核对象ETHREAD指针. 64位16进制整数.\
`                                `teb : 线程内核对象TEB指针. 64位16进制整数\
`                                `win32StartAddress : 线程起始地址. 64位16进制整数\
`                                `module\_name : 线程起始地址所在的模块名.\
`                                `switch\_count : 线程切换次数. 10进制整数\
`                                `state : 线程状态. 10进制整数. 0 : 初始化 1 : 准备 2 : 运行 3 : 待机 4 : 结束 5 : 等待 6 : 转换. 这个地方其实只需要关心是不是4就行了. 如果是4表示线程结束了. 其它的状态都可以认为是运行状态. 不用太关心.\
`                                `suspend\_count : 线程挂起次数. 10进制整数. 线程挂起次数,当此值大于0时,表示线程处于挂起状态. 等于0表示处于运行状态.\
`                      `"resume"  : 成功返回"ok",否则为空字符串.\
`                      `"suspend": 成功返回"ok",否则为空字符串.\
`                      `"terminate": 成功返回"ok",否则为空字符串.

<a name="chmtopic275"></a>**函数简介:**

卸载插件相关的所有驱动. 仅对64位系统的驱动生效.

**函数原型:**\
\
long UnLoadDriver()

**参数定义:**

**返回值:**\
\
整形数:\
0 : 失败\
1 : 成功

<a name="chmtopic281"></a>**函数简介:**

绑定指定的窗口,并指定这个窗口的屏幕颜色获取方式,鼠标仿真模式,键盘仿真模式,以及模式设定,高级用户可以参考[BindWindowEx](#chmtopic277)更加灵活强大.

**函数原型:**\
\
long BindWindow(hwnd,display,mouse,keypad,mode)

**参数定义:**\
\
hwnd 整形数: 指定的窗口句柄\
\
display 字符串: 屏幕颜色获取方式 取值有以下几种\
\
"normal" : 正常模式,平常我们用的前台截屏模式\
\
"gdi" : gdi模式,用于窗口采用GDI方式刷新时. 此模式占用CPU较大. 参考[SetAero](#chmtopic278)  win10以上系统使用此模式，如果截图失败，尝试把目标程序重新开启再试试。

"gdi2" : gdi2模式,此模式兼容性较强,但是速度比gdi模式要慢许多,如果gdi模式发现后台不刷新时,可以考虑用gdi2模式.\
\
"dx2" : dx2模式,用于窗口采用dx模式刷新,如果dx方式会出现窗口所在进程崩溃的状况,可以考虑采用这种.采用这种方式要保证窗口有一部分在屏幕外.win7 win8或者vista不需要移动也可后台.此模式占用CPU较大. 参考[SetAero](#chmtopic278). [ ](#chmtopic279) win10以上系统使用此模式，如果截图失败，尝试把目标程序重新开启再试试。

"dx3" : dx3模式,同dx2模式,但是如果发现有些窗口后台不刷新时,可以考虑用dx3模式,此模式比dx2模式慢许多. 此模式占用CPU较大. 参考[SetAero](#chmtopic278). win10以上系统使用此模式，如果截图失败，尝试把目标程序重新开启再试试。

"dx" : dx模式,等同于BindWindowEx中，display设置的"dx.graphic.2d|dx.graphic.3d",具体参考BindWindowEx\
\
\
mouse 字符串: 鼠标仿真模式 取值有以下几种\
\
"normal" : 正常模式,平常我们用的前台鼠标模式\
\
"windows": Windows模式,采取模拟windows消息方式 同按键自带后台插件.

"windows2": Windows2 模式,采取模拟windows消息方式(锁定鼠标位置) 此模式等同于BindWindowEx中的mouse为以下组合\
"dx.mouse.position.lock.api|dx.mouse.position.lock.message|dx.mouse.state.message"

"windows3": Windows3模式，采取模拟windows消息方式,可以支持有多个子窗口的窗口后台.\
\
"dx": dx模式,采用模拟dx后台鼠标模式,这种方式会锁定鼠标输入.有些窗口在此模式下绑定时，需要先激活窗口再绑定(或者绑定以后激活)，否则可能会出现绑定后鼠标无效的情况.此模式等同于BindWindowEx中的mouse为以下组合\
"dx.public.active.api|dx.public.active.message|dx.mouse.position.lock.api|dx.mouse.position.lock.message|dx.mouse.state.api|dx.mouse.state.message|dx.mouse.api|dx.mouse.focus.input.api|dx.mouse.focus.input.message|dx.mouse.clip.lock.api|dx.mouse.input.lock.api|dx.mouse.cursor"

"dx2"：dx2模式,这种方式类似于dx模式,但是不会锁定外部鼠标输入.\
有些窗口在此模式下绑定时，需要先激活窗口再绑定(或者绑定以后手动激活)，否则可能会出现绑定后鼠标无效的情况. 此模式等同于BindWindowEx中的mouse为以下组合\
"dx.public.active.api|dx.public.active.message|dx.mouse.position.lock.api|dx.mouse.state.api|dx.mouse.api|dx.mouse.focus.input.api|dx.mouse.focus.input.message|dx.mouse.clip.lock.api|dx.mouse.input.lock.api| dx.mouse.cursor"\
\
\
keypad 字符串: 键盘仿真模式 取值有以下几种\
\
"normal" : 正常模式,平常我们用的前台键盘模式\
\
"windows": Windows模式,采取模拟windows消息方式 同按键的后台插件.\
\
"dx": dx模式,采用模拟dx后台键盘模式。有些窗口在此模式下绑定时，需要先激活窗口再绑定(或者绑定以后激活)，否则可能会出现绑定后键盘无效的情况. 此模式等同于BindWindowEx中的keypad为以下组合\
"dx.public.active.api|dx.public.active.message| dx.keypad.state.api|dx.keypad.api|dx.keypad.input.lock.api"

mode 整形数: 模式。 取值有以下几种

`     `0 : 推荐模式此模式比较通用，而且后台效果是最好的.

`     `2 : 同模式0,如果模式0有崩溃问题，可以尝试此模式. 注意0和2模式，当主绑定(第一个绑定同个窗口的对象)绑定成功后，那么调用主绑定的线程必须一致维持,否则线程一旦推出,对应的绑定也会消失.

`     `101 : 超级绑定模式. 可隐藏目标进程中的dm.dll.避免被恶意检测.效果要比dx.public.hide.dll好. 推荐使用.

`     `103 : 同模式101，如果模式101有崩溃问题，可以尝试此模式. \
\
`     `11 : 需要加载驱动,适合一些特殊的窗口,如果前面的无法绑定，可以尝试此模式. 此模式不支持32位系统\
\
`     `13 : 需要加载驱动,适合一些特殊的窗口,如果前面的无法绑定，可以尝试此模式. 此模式不支持32位系统

需要注意的是: 模式101 103在大部分窗口下绑定都没问题。但也有少数特殊的窗口，比如有很多子窗口的窗口，对于这种窗口，在绑定时，一定要把\
鼠标指向一个可以输入文字的窗口，比如一个文本框，最好能激活这个文本框，这样可以保证绑定的成功.

**返回值:**

整形数:\
0: 失败\
1: 成功\
\
如果返回0，可以调用[GetLastError](#chmtopic280)来查看具体失败错误码,帮助分析问题.

<a name="chmtopic277"></a>**函数简介:**

绑定指定的窗口,并指定这个窗口的屏幕颜色获取方式,鼠标仿真模式,键盘仿真模式 高级用户使用.

**函数原型:**\
\
long BindWindowEx(hwnd,display,mouse,keypad,public,mode)

**参数定义:**\
\
hwnd 整形数: 指定的窗口句柄\
\
display 字符串: 屏幕颜色获取方式 取值有以下几种\
\
"normal" : 正常模式,平常我们用的前台截屏模式\
\
"gdi" : gdi模式,用于窗口采用GDI方式刷新时. 此模式占用CPU较大. 参考[SetAero](#chmtopic278). win10以上系统使用此模式，如果截图失败，尝试把目标程序重新开启再试试。  

"gdi2" : gdi2模式,此模式兼容性较强,但是速度比gdi模式要慢许多,如果gdi模式发现后台不刷新时,可以考虑用gdi2模式.\
\
"dx2" : dx2模式,用于窗口采用dx模式刷新,如果dx方式会出现窗口进程崩溃的状况,可以考虑采用这种.采用这种方式要保证窗口有一部分在屏幕外.win7 win8或者vista不需要移动也可后台. 此模式占用CPU较大. 参考[SetAero](#chmtopic278). win10以上系统使用此模式，如果截图失败，尝试把目标程序重新开启再试试。 

"dx3" : dx3模式,同dx2模式,但是如果发现有些窗口后台不刷新时,可以考虑用dx3模式,此模式比dx2模式慢许多. 此模式占用CPU较大. 参考[SetAero](#chmtopic278). win10以上系统使用此模式，如果截图失败，尝试把目标程序重新开启再试试。\
\
dx模式,用于窗口采用dx模式刷新,取值可以是以下任意组合，组合采用"|"符号进行连接. 支持BindWindow中的缩写模式. 比如dx代表" dx.graphic.2d| dx.graphic.3d"\
1\. "dx.graphic.2d"  2d窗口的dx图色模式  \
2\. "dx.graphic.2d.2"  2d窗口的dx图色模式  是dx.graphic.2d的增强模式.兼容性更好.\
3\. "dx.graphic.3d"  3d窗口的dx图色模式, \
4\. "dx.graphic.3d.8"  3d窗口的dx8图色模式,  此模式对64位进程无效.\
5\. "dx.graphic.opengl"  3d窗口的opengl图色模式,极少数窗口采用opengl引擎刷新. 此图色模式速度可能较慢.  有些窗口采用这个参数截图后,上下是反向的,可以在公共参数里增加dx.public.graphic.revert来反转.\
6\. "dx.graphic.opengl.esv2"  3d窗口的opengl\_esv2图色模式,极少数窗口采用opengl引擎刷新. 此图色模式速度可能较慢. 有些窗口采用这个参数截图后,上下是反向的,可以在公共参数里增加dx.public.graphic.revert来反转.\
7\. "dx.graphic.3d.10plus"  3d窗口的dx10 dx11 dx12图色模式

\
mouse 字符串: 鼠标仿真模式 取值有以下几种\
\
"normal" : 正常模式,平常我们用的前台鼠标模式\
\
"windows": Windows模式,采取模拟windows消息方式 同按键的后台插件.

"windows3": Windows3模式，采取模拟windows消息方式,可以支持有多个子窗口的窗口后台

dx模式,取值可以是以下任意组合. 组合采用"|"符号进行连接. 支持BindWindow中的缩写模式,比如windows2代表"dx.mouse.position.lock.api|dx.mouse.position.lock.message|dx.mouse.state.message"\
1\. "dx.mouse.position.lock.api"  此模式表示通过封锁系统API，来锁定鼠标位置.\
2\. "dx.mouse.position.lock.message" 此模式表示通过封锁系统消息，来锁定鼠标位置.\
3\. "dx.mouse.focus.input.api" 此模式表示通过封锁系统API来锁定鼠标输入焦点.\
4\. "dx.mouse.focus.input.message"此模式表示通过封锁系统消息来锁定鼠标输入焦点.\
5\. "dx.mouse.clip.lock.api" 此模式表示通过封锁系统API来锁定刷新区域。注意，使用这个模式，在绑定前，必须要让窗口完全显示出来.\
6\. "dx.mouse.input.lock.api" 此模式表示通过封锁系统API来锁定鼠标输入接口.\
7\. "dx.mouse.state.api" 此模式表示通过封锁系统API来锁定鼠标输入状态.\
8\. "dx.mouse.state.message" 此模式表示通过封锁系统消息来锁定鼠标输入状态.\
9\. "dx.mouse.api"  此模式表示通过封锁系统API来模拟dx鼠标输入.\
10\. "dx.mouse.cursor"  开启此模式，可以后台获取鼠标特征码. \
11\. "dx.mouse.raw.input"  有些窗口需要这个才可以正常操作鼠标. \
12\. "dx.mouse.input.lock.api2"  部分窗口在后台操作时，前台鼠标会移动,需要这个属性.\
13\. "dx.mouse.input.lock.api3"  部分窗口在后台操作时，前台鼠标会移动,需要这个属性. \
14\. "dx.mouse.raw.input.active"  这个参数必须配合dx.mouse.raw.input才有意义. 有些窗口必须配合这个参数才可以后台.使用这个参数时，必须在绑定前激活目标窗口.(这个参数能不用就不要用,除非非用不可,可能会对前台产生干扰)

\
keypad 字符串: 键盘仿真模式 取值有以下几种\
\
"normal" : 正常模式,平常我们用的前台键盘模式\
\
"windows": Windows模式,采取模拟windows消息方式 同按键的后台插件.\
\
dx模式,取值可以是以下任意组合. 组合采用"|"符号进行连接. 支持BindWindow中的缩写模式.比如dx代表" dx.public.active.api|dx.public.active.message| dx.keypad.state.api|dx.keypad.api|dx.keypad.input.lock.api"\
1\. "dx.keypad.input.lock.api" 此模式表示通过封锁系统API来锁定键盘输入接口.\
2\. "dx.keypad.state.api" 此模式表示通过封锁系统API来锁定键盘输入状态.\
3\. "dx.keypad.api" 此模式表示通过封锁系统API来模拟dx键盘输入. \
4\. "dx.keypad.raw.input"  有些窗口需要这个才可以正常操作键盘.\
5\. "dx.keypad.raw.input.active"  这个参数必须配合dx.keypad.raw.input才有意义. 有些窗口必须配合这个参数才可以后台. 使用这个参数时，必须在绑定前激活目标窗口. (这个参数能不用就不要用,除非非用不可,可能会对前台产生干扰)

public 字符串: 公共属性 dx模式共有 \
\
取值可以是以下任意组合. 组合采用"|"符号进行连接 这个值可以为空\
1\. "dx.public.active.api" 此模式表示通过封锁系统API来锁定窗口激活状态.  注意，部分窗口在此模式下会耗费大量资源 慎用. \
2\. "dx.public.active.message" 此模式表示通过封锁系统消息来锁定窗口激活状态.  注意，部分窗口在此模式下会耗费大量资源 慎用. 另外如果要让此模式生效，必须在绑定前，让绑定窗口处于激活状态,否则此模式将失效. 比如dm.SetWindowState hwnd,1 然后再绑定.\
3\.  "dx.public.disable.window.position" 此模式将锁定绑定窗口位置.不可与"dx.public.fake.window.min"共用.\
4\.  "dx.public.disable.window.size" 此模式将锁定绑定窗口,禁止改变大小. 不可与"dx.public.fake.window.min"共用.\
5\.  "dx.public.disable.window.minmax" 此模式将禁止窗口最大化和最小化,但是付出的代价是窗口同时也会被置顶. 不可与"dx.public.fake.window.min"共用.\
6\.  "dx.public.fake.window.min" 此模式将允许目标窗口在最小化状态时，仍然能够像非最小化一样操作.. 另注意，此模式会导致任务栏顺序重排，所以如果是多开模式下，会看起来比较混乱，建议单开使用，多开不建议使用. 同时此模式不是万能的,有些情况下最小化以后图色会不刷新或者黑屏.\
7\.  "dx.public.hide.dll" 此模式将会隐藏目标进程的大漠插件，避免被检测..另外使用此模式前，请仔细做过测试，此模式可能会造成目标进程不稳定，出现崩溃。\
8\.  "dx.public.active.api2" 此模式表示通过封锁系统API来锁定窗口激活状态. 部分窗口遮挡无法后台,需要这个属性. \
9\.  "dx.public.input.ime" 此模式是配合SendStringIme使用. 具体可以查看[SendStringIme](#chmtopic283)接口.\
10  "dx.public.graphic.protect" 此模式可以保护dx图色不被恶意检测.同时对dx.keypad.api和dx.mouse.api也有保护效果. 这个参数可能会导致某些情况下目标图色失效.一般出现在场景重新加载的时候. 重新绑定会恢复.\
11  "dx.public.disable.window.show" 禁止目标窗口显示,这个一般用来配合dx.public.fake.window.min来使用. \
12  "dx.public.anti.api" 此模式可以突破部分窗口对后台的保护.\
13  "dx.public.km.protect" 此模式可以保护dx键鼠不被恶意检测.最好配合dx.public.anti.api一起使用. 此属性可能会导致部分后台功能失效.\
14   "dx.public.prevent.block"  绑定模式1 3 5 7 101 103下，可能会导致部分窗口卡死. 这个属性可以避免卡死.\
15   "dx.public.ori.proc"  此属性只能用在模式0 1 2 3和101下. 有些窗口在不同的界面下(比如登录界面和登录进以后的界面)，键鼠的控制效果不相同. 那可以用这个属性来尝试让保持一致. 注意的是，这个属性不可以滥用，确保测试无问题才可以使用. 否则可能会导致后台失效.\
16  "dx.public.down.cpu" 此模式可以配合DownCpu来降低目标进程CPU占用.  当图色方式降低CPU无效时，可以尝试此种方式. 需要注意的是，当使用此方式降低CPU时，会让图色方式降低CPU失效\
17  "dx.public.focus.message" 当后台绑定后,后台无法正常在焦点窗口输入文字时,可以尝试加入此属性. 此属性会强制键盘消息发送到焦点窗口. 慎用此模式,此模式有可能会导致后台键盘在某些情况下失灵.\
18  "dx.public.graphic.speed" 只针对图色中的dx模式有效.此模式会牺牲目标窗口的性能，来提高DX图色速度，尤其是目标窗口刷新很慢时，这个参数就很有用了.\
19  "dx.public.memory" 让本对象突破目标进程防护,可以正常使用内存接口. 当用此方式使用内存接口时，内存接口的速度会取决于目标窗口的刷新率.\
20  "dx.public.inject.super" 突破某些难以绑定的窗口. 此属性仅对除了模式0和2的其他模式有效.\
21  "dx.public.hack.speed" 类似变速齿轮，配合接口HackSpeed使用\
22  "dx.public.inject.c" 突破某些难以绑定的窗口. 此属性仅对除了模式0和2的其他模式有效.\
23  "dx.public.graphic.revert" 此模式将截图后的内容上下反向. 仅对图色模式为dx.graphic.opengl和dx.graphic.opengl.esv2生效.

mode 整形数: 模式。 取值有以下几种

`     `0 : 推荐模式此模式比较通用，而且后台效果是最好的.

`     `2 : 同模式0,如果模式0有崩溃问题，可以尝试此模式.  注意0和2模式，当主绑定(第一个绑定同个窗口的对象)绑定成功后，那么调用主绑定的线程必须一直维持,否则线程一旦推出,对应的绑定也会消失.

`     `101 : 超级绑定模式. 可隐藏目标进程中的dm.dll.避免被恶意检测.效果要比dx.public.hide.dll好. 推荐使用.

`     `103 : 同模式101，如果模式101有崩溃问题，可以尝试此模式. \
\
`     `11 : 需要加载驱动,适合一些特殊的窗口,如果前面的无法绑定，可以尝试此模式. 此模式不支持32位系统\
\
`     `13 : 需要加载驱动,适合一些特殊的窗口,如果前面的无法绑定，可以尝试此模式. 此模式不支持32位系统

需要注意的是: 模式101 103在大部分窗口下绑定都没问题。但也有少数特殊的窗口，比如有很多子窗口的窗口，对于这种窗口，在绑定时，一定要把鼠标指向一个可以输入文字的窗口，比如一个文本框，最好能激活这个文本框，这样可以保证绑定的成功.

**返回值:**

整形数:\
0: 失败\
1: 成功\
\
如果返回0，可以调用[GetLastError](#chmtopic280)来查看具体失败错误码,帮助分析问题.

<a name="chmtopic285"></a>**函数简介:**

降低目标窗口所在进程的CPU占用.

**函数原型:**\
\
long DownCpu(type,rate)

**参数定义:**

type 整形数: 当取值为0时,rate取值范围大于等于0 ,这个值越大表示降低CPU效果越好\
`             `当取值为1时,rate取值范围大于等于0,表示以固定的FPS来降低CPU. rate表示FPS.  并且这时不能有dx.public.down.cpu.

rate 整形数: 取值取决于type. 为0表示关闭

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic287"></a>**函数简介:**

设置是否暂时关闭或者开启后台功能. 默认是开启.  一般用在前台切换，或者脚本暂停和恢复时，可以让用户操作窗口.

**函数原型:**\
\
long EnableBind(enable)

**参数定义:**

enable 整形数: 0 全部关闭(图色键鼠都关闭,也就是说图色,键鼠都是前台,但是如果有指定dx.public.active.message时，在窗口前后台切换时，这个属性会失效.)\
-1 只关闭图色.(也就是说图色是normal前台. 键鼠不变)\
1 开启(恢复原始状态)\
5 同0，也是全部关闭，但是这个模式下，就算窗口在前后台切换时，属性dx.public.active.message的效果也一样不会失效.

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic289"></a>**函数简介:**

设置是否开启后台假激活功能. 默认是关闭. 一般用不到. 除非有人有特殊需求. 注意看注释. 

**函数原型:**\
\
long EnableFakeActive(enable)

**参数定义:**

enable 整形数: 0 关闭\
`               `1 开启

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic291"></a>**函数简介:**

设置是否关闭绑定窗口所在进程的输入法.

**函数原型:**\
\
long EnableIme(enable)

**参数定义:**

enable 整形数: 1 开启\
0 关闭

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic293"></a>**函数简介:**

是否在使用dx键盘时开启windows消息.默认开启. 

**函数原型:**\
\
long EnableKeypadMsg(enable)

**参数定义:**

enable 整形数: 0 禁止\
`               `1开启

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic295"></a>**函数简介:**

键盘消息发送补丁. 默认是关闭.

**函数原型:**\
\
long EnableKeypadPatch(enable)

**参数定义:**

enable 整形数: 0 禁止\
`               `1开启  

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic297"></a>**函数简介:**

键盘消息采用同步发送模式.默认异步. 

**函数原型:**\
\
long EnableKeypadSync(enable,time\_out)

**参数定义:**

enable 整形数: 0 禁止同步\
`               `1开启同步

time\_out 整形数: 单位是毫秒,表示同步等待的最大时间.

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic299"></a>**函数简介:**

是否在使用dx鼠标时开启windows消息.默认开启. 

**函数原型:**\
\
long EnableMouseMsg(enable)

**参数定义:**

enable 整形数: 0 禁止\
`               `1开启

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic301"></a>**函数简介:**

鼠标消息采用同步发送模式.默认异步. 

**函数原型:**\
\
long EnableMouseSync(enable,time\_out)

**参数定义:**

enable 整形数: 0 禁止同步\
`               `1开启同步

time\_out 整形数: 单位是毫秒,表示同步等待的最大时间.

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic303"></a>**函数简介:**

键盘动作模拟真实操作,点击延时随机.

**函数原型:**\
\
long EnableRealKeypad(enable)

**参数定义:**

enable 整形数: 0 关闭模拟\
`               `1 开启模拟

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic305"></a>**函数简介:**

鼠标动作模拟真实操作,带移动轨迹,以及点击延时随机. 

**函数原型:**\
\
long EnableRealMouse(enable,mousedelay,mousestep)

**参数定义:**

enable 整形数: 0 关闭模拟\
`               `1 开启模拟(直线模拟)\
`               `2 开启模拟(随机曲线,更接近真实)\
`               `3 开启模拟(小弧度曲线,弧度随机)\
`               `4 开启模拟(大弧度曲线,弧度随机)

mousedelay 整形数: 单位是毫秒. 表示在模拟鼠标移动轨迹时,每移动一次的时间间隔.这个值越大,鼠标移动越慢. 必须大于0,否则会失败.

Mousestep 整形数: 表示在模拟鼠标移动轨迹时,每移动一次的距离. 这个值越大，鼠标移动越快速.

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic307"></a>**函数简介:**

设置是否开启高速dx键鼠模式。 默认是关闭.

**函数原型:**\
\
long EnableSpeedDx(enable)

**参数定义:**

enable 整形数: 0 关闭\
1 开启

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic309"></a>**函数简介:**

强制解除绑定窗口,并释放系统资源.   

**函数原型:**\
\
long ForceUnBindWindow(hwnd)

**参数定义:**

hwnd 整形数: 需要强制解除绑定的窗口句柄.

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic311"></a>**函数简介:**

获取当前对象已经绑定的窗口句柄. 无绑定返回0

**函数原型:**\
\
long GetBindWindow()

**参数定义:**

**返回值:**

整形数: 窗口句柄 

<a name="chmtopic313"></a>**函数简介:**

获取绑定窗口的fps. (即时fps,不是平均fps). 

要想获取fps,那么图色模式必须是dx模式的其中一种.  比如dx.graphic.3d  dx.graphic.opengl等.

**函数原型:**\
\
long GetFps()

**参数定义:**

**返回值:**

整形数: fps

<a name="chmtopic315"></a>**函数简介:**

对目标窗口设置加速功能(类似变速齿轮),必须在绑定参数中有dx.public.hack.speed时才会生效.

**函数原型:**\
\
long HackSpeed(rate)

**参数定义:**

rate 双精度浮点数: 取值范围大于0. 默认是1.0 表示不加速，也不减速. 小于1.0表示减速,大于1.0表示加速. 精度为小数点后1位. 也就是说1.5 和 1.56其实是一样的.

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic317"></a>**函数简介:**

判定指定窗口是否已经被后台绑定. (前台无法判定) 

**函数原型:**\
\
long IsBind(hwnd)

**参数定义:**

hwnd 整形数: 窗口句柄 

**返回值:**

整形数:\
0: 没绑定,或者窗口不存在.\
1: 已经绑定.

<a name="chmtopic319"></a>**函数简介:**

锁定指定窗口的图色数据(不刷新). 

**函数原型:**\
\
long LockDisplay(lock)

**参数定义:**

lock 整形数: 0关闭锁定\
`             `1 开启锁定

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic321"></a>**函数简介:**

禁止外部输入到指定窗口

**函数原型:**\
\
long LockInput(lock)

**参数定义:**

lock 整形数: 0关闭锁定\
`       `1 开启锁定(键盘鼠标都锁定)\
`       `2 只锁定鼠标\
`       `3 只锁定键盘\
`       `4 同1,但当您发现某些特殊按键无法锁定时,比如(回车，ESC等)，那就用这个模式吧. 但此模式会让SendString函数后台失效，或者采用和SendString类似原理发送字符串的其他3方函数失效.\
`       `5同3,但当您发现某些特殊按键无法锁定时,比如(回车，ESC等)，那就用这个模式吧. 但此模式会让SendString函数后台失效，或者采用和SendString类似原理发送字符串的其他3方函数失效.

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic323"></a>**函数简介:**

设置前台鼠标在屏幕上的活动范围.

**函数原型:**\
\
long LockMouseRect(x1,y1,x2,y2)

**参数定义:**

x1 整形数:区域的左上X坐标. 屏幕坐标.\
y1 整形数:区域的左上Y坐标. 屏幕坐标.\
x2 整形数:区域的右下X坐标. 屏幕坐标.\
y2 整形数:区域的右下Y坐标. 屏幕坐标.

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic278"></a>**函数简介:**

设置开启或者关闭系统的Aero效果. (仅对WIN7及以上系统有效) 

**函数原型:**\
\
long SetAero(enable)

**参数定义:**

enable 整形数: 0 关闭\
1 开启

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic326"></a>**函数简介:**

设置dx截图最长等待时间。内部默认是3000毫秒. 一般用不到调整这个.

**函数原型:**\
\
long SetDisplayDelay(time)

**参数定义:**

time  整形数: 等待时间，单位是毫秒。 注意这里不能设置的过小，否则可能会导致截图失败,从而导致图色函数和文字识别失败.

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic328"></a>**函数简介:**

设置opengl图色模式的强制刷新窗口等待时间. 内置为400毫秒.

**函数原型:**\
\
long SetDisplayRefreshDelay(time)

**参数定义:**

time  整形数: 等待时间，单位是毫秒。 这个值越小,强制刷新的越频繁，相应的窗口可能会导致闪烁.

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic330"></a>**函数简介:**

设置当前对象用于输入的对象. 结合图色对象和键鼠对象,用一个对象完成操作.

**函数原型:**\
\
long SetInputDm(dm\_id,rx,ry)

**参数定义:**

dm\_id 整形数: 接口GetId的返回值\
rx 整形数: 两个对象绑定的窗口的左上角坐标的x偏移. 是用dm\_id对应的窗口的左上角x坐标减去当前窗口左上角坐标的x坐标. 一般是0\
ry 整形数: 两个对象绑定的窗口的左上角坐标的y偏移. 是用dm\_id对应的窗口的左上角y坐标减去当前窗口左上角坐标的y坐标. 一般是0

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic332"></a>**函数简介:**

在不解绑的情况下,切换绑定窗口.(必须是同进程窗口) 

**函数原型:**\
\
long SwitchBindWindow(hwnd)

**参数定义:**

hwnd 整形数: 需要切换过去的窗口句柄

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic334"></a>**函数简介:**

解除绑定窗口,并释放系统资源.一般在OnScriptExit调用

**函数原型:**\
\
long UnBindWindow()

**参数定义:**

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic336"></a>**函数简介:**

添加指定的MASM汇编指令. 支持标准的masm汇编指令. 

**函数原型:**\
\
long AsmAdd(asm\_ins)

**参数定义:**\
\
asm\_ins **字符串**:MASM汇编指令,大小写均可以  比如 "mov eax,1" ,也支持直接加入字节，比如"emit 90 90 90 90"等. 同时也支持跳转指令，标记. \
`       `标记必须以":"开头. 跳转指令后必须接本次AsmCall之前的存在的有效Label. 另外跳转只支持短跳转,就是跳转的字节码不能超过128个字节.

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic338"></a>**函数简介:**

执行用AsmAdd加到缓冲中的指令. 

**函数原型:**\
\
LONGLONG AsmCall(hwnd,mode)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄

mode 整形数: 模式，取值如下

`       `0 : 在本进程中进行执行，这时hwnd无效. 注: 此模式会创建线程.

`       `1 : 对hwnd指定的进程内执行,注入模式为创建远程线程

`       `2 ：必须在对目标窗口进行注入绑定后,才可以用此模式(直接在目标进程创建线程).此模式下的call的执行是排队的,如果同时有多个call在此窗口执行,那么必须排队.所以执行效率不如模式1. 同时此模式受目标窗口刷新速度的影响,目标窗口刷新太慢，也会影响此模式的速度. 注: 此模式会创建线程.

`       `3 ：同模式2,但是此模式不会创建线程,而直接在hwnd所在线程执行.

`       `4 ：同模式0, 但是此模式不会创建线程,直接在当前调用AsmCall的线程内执行.\
\
`    `5 : 对hwnd指定的进程内执行,注入模式为APC. 此模式必须开启memory盾。任意一个memory盾都可以.\
\
`    `6 : 直接hwnd所在线程执行. 

**返回值:**

长整形数:\
获取执行汇编代码以后的EAX的值(32位进程),或者RAX的值(64位进程).一般是函数的返回值. 如果要想知道函数是否执行成功，请查看[GetLastError](#chmtopic280)函数.\
-200 : 执行中出现错误.\
-201 : 使用模式5时，没有开启memory盾.

<a name="chmtopic340"></a>**函数简介:**

执行用AsmAdd加到缓冲中的指令.  这个接口同AsmCall,但是由于插件内部在每次AsmCall时,都会有对目标进程分配内存的操作,这样会不够效率.\
所以增加这个接口，可以让调用者指定分配好的内存,并在此内存上执行call的操作. 

**函数原型:**\
\
LONGLONG AsmCallEx(hwnd,mode,base\_addr)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄

mode 整形数: 模式，取值如下

`       `0 : 在本进程中进行执行，这时hwnd无效. 注: 此模式会创建线程.

`       `1 : 对hwnd指定的进程内执行,注入模式为创建远程线程

`       `2 ：必须在对目标窗口进行注入绑定后,才可以用此模式(直接在目标进程创建线程).此模式下的call的执行是排队的,如果同时有多个call在此窗口执行,那么必须排队.所以执行效率不如模式1. 同时此模式受目标窗口刷新速度的影响,目标窗口刷新太慢，也会影响此模式的速度. 注: 此模式会创建线程.

`       `3 ：同模式2,但是此模式不会创建线程,而直接在hwnd所在线程执行.

`       `4 ：同模式0, 但是此模式不会创建线程,直接在当前调用AsmCall的线程内执行.\
\
`    `5 : 对hwnd指定的进程内执行,注入模式为APC. 此模式必须开启memory盾。任意一个memory盾都可以.\
\
`    `6 : 直接hwnd所在线程执行. 

base\_addr** 字符串**:** 16进制格式. 比如"45A00000",此参数指定的地址必须要求有可读可写可执行属性. 并且内存大小最少要200个字节. 模式6要求至少400个字节. 如果Call的内容较多,那么长度相应也要增加.   如果此参数为空,那么效果就和AsmCall一样.

**返回值:**

长整形数:\
获取执行汇编代码以后的EAX的值(32位进程),或者RAX的值(64位进程).一般是函数的返回值. 如果要想知道函数是否执行成功，请查看[GetLastError](#chmtopic280)函数.\
-200 : 执行中出现错误.\
-201 : 使用模式5时，没有开启memory盾.

<a name="chmtopic342"></a>**函数简介:**

清除汇编指令缓冲区 用AsmAdd添加到缓冲的指令全部清除

**函数原型:**\
\
long AsmClear()

**参数定义:**

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic344"></a>**函数简介:**

此接口对AsmCall和AsmCallEx中的模式5和6中内置的一些延时参数进行设置.

**函数原型:**\
\
long AsmSetTimeout(time\_out,param)

参数定义:

time\_out  整形数:具体含义看以下说明.(默认值10000) 单位毫秒

param  整形数:  具体含义看以下说明. (默认值100) 单位毫秒

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic346"></a>**函数简介:**

把汇编缓冲区的指令转换为机器码 并用16进制字符串的形式输出

**函数原型:**\
\
string Assemble(base\_addr,is\_64bit)

**参数定义:**

base\_addr 长整形数: 用AsmAdd添加到缓冲区的第一条指令所在的地址

is\_64bit  整形数:   表示缓冲区的指令是32位还是64位. 32位表示为0,64位表示为1

**返回值:**

字符串:\
机器码，比如 "aa bb cc"这样的形式

<a name="chmtopic348"></a>**函数简介:**

把指定的机器码转换为汇编语言输出

**函数原型:**\
\
string DisAssemble(asm\_code,base\_addr, is\_64bit)

**参数定义:**\
\
asm\_code **字符串**: 机器码，形式如 "aa bb cc"这样的16进制表示的字符串(空格无所谓)

base\_addr 长整形数: 指令所在的地址

is\_64bit  整形数:  表示asm\_code表示的指令是32位还是64位. 32位表示为0,64位表示为1

**返回值:**

字符串:\
MASM汇编语言字符串.如果有多条指令，则每条指令以字符"|"连接.

<a name="chmtopic350"></a>**函数简介:**

设置是否弹出汇编功能中的错误提示,默认是打开.

**函数原型:**\
\
long SetShowAsmErrorMsg(show)

**参数定义:**

show 整形数: 0表示不打开,1表示打开

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic352"></a>**函数简介:**

设置是否开启或者关闭插件内部的图片缓存机制. (默认是打开).

**函数原型:**\
\
long EnablePicCache(enable)

**参数定义:**\
\
enable 整形数: \
`       `0 : 关闭\
`       `1 : 打开

**返回值:**

整形数:\
0: 失败

1: 成功

<a name="chmtopic354"></a>**函数简介:**

获取注册在系统中的dm.dll的路径.

**函数原型:**\
\
string GetBasePath()

**参数定义:**

**返回值:**

字符串:\
返回dm.dll所在路径

<a name="chmtopic356"></a>**函数简介:**

返回当前进程已经创建的dm对象个数. 

**函数原型:**\
\
long GetDmCount()

**参数定义:**

**返回值:**

整形数:\
个数.

<a name="chmtopic358"></a>**函数简介:**

返回当前大漠对象的ID值，这个值对于每个对象是唯一存在的。可以用来判定两个大漠对象是否一致.

**函数原型:**\
\
long GetID()

**参数定义:**

**返回值:**

整形数:\
当前对象的ID值.

<a name="chmtopic280"></a>**函数简介:**

获取插件命令的最后错误

**函数原型:**\
\
long  GetLastError()

**参数定义:**

**返回值:**

整形数:\
返回值表示错误值。 0表示无错误.

-1 : 表示你使用了绑定里的收费功能，但是没注册，无法使用.\
-2 : 使用模式0 2 时出现，因为目标窗口有保护. 常见于win7以上系统.或者有安全软件拦截插件.解决办法: 关闭所有安全软件，然后再重新尝试. 如果还不行就可以肯定是目标窗口有特殊保护. \
-3 : 使用模式0 2 时出现，可能目标窗口有保护，也可能是异常错误. 可以尝试换绑定模式或许可以解决.\
-4 : 使用模式101 103时出现，这是异常错误.\
-5 : 使用模式101 103时出现, 这个错误的解决办法就是关闭目标窗口，重新打开再绑定即可. 也可能是运行脚本的进程没有管理员权限. \
-6 : 被安全软件拦截。 典型的是金山.360等. 如果是360关闭即可。 如果是金山，必须卸载，关闭是没用的.\
-7 -9 : 使用模式101 103时出现,异常错误. 还有可能是安全软件的问题，比如360等。尝试卸载360.\
-8 -10 : 使用模式101 103时出现, 目标进程可能有保护,也可能是插件版本过老，试试新的或许可以解决. -8可以尝试使用DmGuard中的np2盾配合.\
-11 : 使用模式101 103时出现, 目标进程有保护. 告诉我解决。\
-12 : 使用模式101 103时出现, 目标进程有保护. 告诉我解决。\
-13 : 使用模式101 103时出现, 目标进程有保护. 或者是因为上次的绑定没有解绑导致。 尝试在绑定前调用ForceUnBindWindow. \
-37 : 使用模式101 103时出现, 目标进程有保护. 告诉我解决。\
-14 : 可能系统缺少部分DLL,尝试安装d3d. 或者是鼠标或者键盘使用了dx.mouse.api或者dx.keypad.api，但实际系统没有插鼠标和键盘. 也有可能是图色中有dx.graphic.3d之类的,但相应的图色被占用,比如全屏D3D程序.\
-16 : 可能使用了绑定模式 0 和 101，然后可能指定了一个子窗口.导致不支持.可以换模式2或者103来尝试. 另外也可以考虑使用父窗口或者顶级窗口.来避免这个错误。还有可能是目标窗口没有正常解绑 然后再次绑定的时候.\
-17 : 模式101 103时出现. 这个是异常错误. 告诉我解决.\
-18 : 句柄无效.\
-19 : 使用模式0 11 101时出现,这是异常错误,告诉我解决.\
-20 : 使用模式101 103 时出现,说明目标进程里没有解绑，并且子绑定达到了最大. 尝试在返回这个错误时，调用ForceUnBindWindow来强制解除绑定.\
-21 : 使用模式任何模式时出现,说明目标进程已经存在了绑定(没有正确解绑就退出了?被其它软件绑定?,或者多个线程同时进行了绑定?). 尝试在返回这个错误时，调用ForceUnBindWindow来强制解除绑定.或者检查自己的代码.\
-22 : 使用模式0 2,绑定64位进程窗口时出现,因为安全软件拦截插件释放的EXE文件导致.\
-23 : 使用模式0 2,绑定64位进程窗口时出现,因为安全软件拦截插件释放的DLL文件导致.\
-24 : 使用模式0 2,绑定64位进程窗口时出现,因为安全软件拦截插件运行释放的EXE.\
-25 : 使用模式0 2,绑定64位进程窗口时出现,因为安全软件拦截插件运行释放的EXE.\
-26 : 使用模式0 2,绑定64位进程窗口时出现, 因为目标窗口有保护. 常见于win7以上系统.或者有安全软件拦截插件.解决办法: 关闭所有安全软件，然后再重新尝试. 如果还不行就可以肯定是目标窗口有特殊保护.\
-27 : 绑定64位进程窗口时出现，因为使用了不支持的模式，目前暂时只支持模式0 2 11 13 101 103\
-28 : 绑定32位进程窗口时出现，因为使用了不支持的模式，目前暂时只支持模式0 2 11 13 101 103\
-38 : 是用了大于2的绑定模式,并且使用了dx.public.inject.c时，分配内存失败. 可以考虑开启memory系列盾来尝试.\
-39 : 是用了大于2的绑定模式,并且使用了dx.public.inject.c时的异常错误. 可以联系我解决.\
-40 : 是用了大于2的绑定模式,并且使用了dx.public.inject.c时, 写入内存失败. 可以考虑开启memory系列盾来尝试.\
-41 : 是用了大于2的绑定模式,并且使用了dx.public.inject.c时的异常错误. 可以联系我解决.\
-42 : 绑定时,创建映射内存失败. 这是个异常错误. 一般不会出现. 如果出现了，检查下代码是不是有同个对象同时绑定的情况.还有可能是你的进程有句柄泄露导致无法创建句柄会出这个错误.\
-43 : 绑定时,映射内存失败. 这是个异常错误. 一般不会出现. 如果出现了，一般是你的进程内存不足,检查下你的进程是不是内存泄漏了. \
-44 : 无效的参数,通常是传递了不支持的参数.\
-45 : 绑定时,创建互斥信号失败. 这个是一场错误. 一般不会出现. 如果出现了检查进程是否有句柄泄漏的情况.

-100 : 调用读写内存函数后，发现无效的窗口句柄\
-101 : 读写内存函数失败\
-200 : AsmCall失败\
-202 : AsmCall平台兼容问题.联系我解决.

<a name="chmtopic361"></a>**函数简介:**

获取全局路径.(可用于调试)

**函数原型:**\
\
string GetPath()

**参数定义:**

**返回值:**

字符串:\
以字符串的形式返回当前设置的全局路径

<a name="chmtopic363"></a>**函数简介:**

调用此函数来注册，从而使用插件的高级功能.推荐使用此函数.

**函数原型:**

long Reg(reg\_code,ver\_info)

**参数定义:**\
\
reg\_code 字符串: 注册码. (从大漠插件后台获取)

ver\_info 字符串: 版本附加信息. 可以在后台详细信息查看. 可以任意填写. 可留空. 长度不能超过32. 并且只能包含数字和字母以及小数点. 这个版本信息不是插件版本.

**返回值:**

整形数:\
-1 : 无法连接网络,(可能防火墙拦截,如果可以正常访问大漠插件网站，那就可以肯定是被防火墙拦截)\
-2 : 进程没有以管理员方式运行. (出现在win7 win8 vista 2008.建议关闭uac)\
0 : 失败 (未知错误)\
1 : 成功\
2 : 余额不足\
3 : 绑定了本机器，但是账户余额不足50元.\
4 : 注册码错误\
5 : 你的机器或者IP在黑名单列表中或者不在白名单列表中.\
6 : 非法使用插件. 一般出现在定制插件时，使用了和绑定的用户名不同的注册码.  也有可能是系统的语言设置不是中文简体,也可能有这个错误.\
7 : 你的帐号因为非法使用被封禁. （如果是在虚拟机中使用插件，必须使用Reg或者RegEx，不能使用RegNoMac或者RegExNoMac,否则可能会造成封号，或者封禁机器）\
8 : ver\_info不在你设置的附加白名单中.\
77： 机器码或者IP因为非法使用，而被封禁. （如果是在虚拟机中使用插件，必须使用Reg或者RegEx，不能使用RegNoMac或者RegExNoMac,否则可能会造成封号，或者封禁机器）\
`     `封禁是全局的，如果使用了别人的软件导致77，也一样会导致所有注册码均无法注册。解决办法是更换IP，更换MAC.\
777： 同一个机器码注册次数超过了服务器限制,被暂时封禁. 请登录后台，插件今日详细消费记录里，相应的机器码是否有次数异常，并立刻优化解决.如果还有问题，可以联系我来解决.\
-8 : 版本附加信息长度超过了32\
-9 : 版本附加信息里包含了非法字母.\
空 : 这是不可能返回空的，如果出现空，那肯定是当前使用的版本不对,老的插件里没这个函数导致返回为空.最好参考文档中的标准写法,判断插件版本号.

<a name="chmtopic365"></a>**函数简介:**

调用此函数来注册，从而使用插件的高级功能. 可以根据指定的IP列表来注册. 新手不建议使用!

**函数原型:**

long RegEx(reg\_code,ver\_info,ip)

**参数定义:**\
\
reg\_code 字符串: 注册码. (从大漠插件后台获取)

ver\_info 字符串: 版本附加信息. 可以在后台详细信息查看.可留空. 长度不能超过32. 并且只能包含数字和字母以及小数点. 这个版本信息不是插件版本.

ip 字符串: 插件注册的ip地址.可以用|来组合,依次对ip中的地址进行注册，直到成功. ip地址列表在VIP群中获取.从7.2111开始,这里也可以使用域名的方式。可以自己解析域名到我的IP.\
`          `比如"1.xxx.com|2.xxx.com"。1.xxx.com和2.xxx.com是自己的域名,解析到我的IP即可.

**返回值:**

整形数:\
-1 : 无法连接网络,(可能防火墙拦截,如果可以正常访问大漠插件网站，那就可以肯定是被防火墙拦截)\
-2 : 进程没有以管理员方式运行. (出现在win7 win8 vista 2008.建议关闭uac)\
0 : 失败 (未知错误)\
1 : 成功\
2 : 余额不足\
3 : 绑定了本机器，但是账户余额不足50元.\
4 : 注册码错误\
5 : 你的机器或者IP在黑名单列表中或者不在白名单列表中.\
6 : 非法使用插件. 一般出现在定制插件时，使用了和绑定的用户名不同的注册码.  也有可能是系统的语言设置不是中文简体,也可能有这个错误.\
7 : 你的帐号因为非法使用被封禁. （如果是在虚拟机中使用插件，必须使用Reg或者RegEx，不能使用RegNoMac或者RegExNoMac,否则可能会造成封号，或者封禁机器）\
8 : ver\_info不在你设置的附加白名单中.\
77： 机器码或者IP因为非法使用，而被封禁. （如果是在虚拟机中使用插件，必须使用Reg或者RegEx，不能使用RegNoMac或者RegExNoMac,否则可能会造成封号，或者封禁机器）\
`     `封禁是全局的，如果使用了别人的软件导致77，也一样会导致所有注册码均无法注册。解决办法是更换IP，更换MAC.\
777： 同一个机器码注册次数超过了服务器限制,被暂时封禁. 请登录后台，插件今日详细消费记录里，相应的机器码是否有次数异常，并立刻优化解决.如果还有问题，可以联系我来解决.\
-8 : 版本附加信息长度超过了32\
-9 : 版本附加信息里包含了非法字母.\
-10 : 非法的参数ip\
空 : 这是不可能返回空的，如果出现空，那肯定是当前使用的版本不对,老的插件里没这个函数导致返回为空.最好参考文档中的标准写法,判断插件版本号.

<a name="chmtopic367"></a>**函数简介:**

调用此函数来注册，从而使用插件的高级功能. 可以根据指定的IP列表来注册.新手不建议使用! 此函数同RegEx函数的不同在于,此函数用于注册的机器码是不带mac地址的.

**函数原型:**

long RegExNoMac(reg\_code,ver\_info,ip)

**参数定义:**\
\
reg\_code 字符串: 注册码. (从大漠插件后台获取)

ver\_info 字符串: 版本附加信息. 可以在后台详细信息查看.可留空. 长度不能超过32. 并且只能包含数字和字母以及小数点. 这个版本信息不是插件版本.

ip 字符串: 插件注册的ip地址.可以用|来组合,依次对ip中的地址进行注册，直到成功. ip地址列表在VIP群中获取. 从7.2111开始,这里也可以使用域名的方式。可以自己解析域名到我的IP.\
`          `比如"1.xxx.com|2.xxx.com"。1.xxx.com和2.xxx.com是自己的域名,解析到我的IP即可.

**返回值:**

整形数:\
-1 : 无法连接网络,(可能防火墙拦截,如果可以正常访问大漠插件网站，那就可以肯定是被防火墙拦截)\
-2 : 进程没有以管理员方式运行. (出现在win7 win8 vista 2008.建议关闭uac)\
0 : 失败 (未知错误)\
1 : 成功\
2 : 余额不足\
3 : 绑定了本机器，但是账户余额不足50元.\
4 : 注册码错误\
5 : 你的机器或者IP在黑名单列表中或者不在白名单列表中.\
6 : 非法使用插件. 一般出现在定制插件时，使用了和绑定的用户名不同的注册码.  也有可能是系统的语言设置不是中文简体,也可能有这个错误.\
7 : 你的帐号因为非法使用被封禁. （如果是在虚拟机中使用插件，必须使用Reg或者RegEx，不能使用RegNoMac或者RegExNoMac,否则可能会造成封号，或者封禁机器）\
8 : ver\_info不在你设置的附加白名单中.\
77： 机器码或者IP因为非法使用，而被封禁. （如果是在虚拟机中使用插件，必须使用Reg或者RegEx，不能使用RegNoMac或者RegExNoMac,否则可能会造成封号，或者封禁机器）\
`     `封禁是全局的，如果使用了别人的软件导致77，也一样会导致所有注册码均无法注册。解决办法是更换IP，更换MAC.\
777： 同一个机器码注册次数超过了服务器限制,被暂时封禁. 请登录后台，插件今日详细消费记录里，相应的机器码是否有次数异常，并立刻优化解决.如果还有问题，可以联系我来解决.\
-8 : 版本附加信息长度超过了32\
-9 : 版本附加信息里包含了非法字母.\
-10 : 非法的参数ip\
空 : 这是不可能返回空的，如果出现空，那肯定是当前使用的版本不对,老的插件里没这个函数导致返回为空.最好参考文档中的标准写法,判断插件版本号.

<a name="chmtopic369"></a>**函数简介:**

调用此函数来注册，从而使用插件的高级功能.推荐使用此函数. 新手不建议使用! 此函数同Reg函数的不同在于,此函数用于注册的机器码是不带mac地址的.

**函数原型:**

long RegNoMac(reg\_code,ver\_info)

**参数定义:**\
\
reg\_code 字符串: 注册码. (从大漠插件后台获取)

ver\_info 字符串: 版本附加信息. 可以在后台详细信息查看. 可以任意填写. 可留空. 长度不能超过32. 并且只能包含数字和字母以及小数点. 这个版本信息不是插件版本.

**返回值:**

整形数:\
-1 : 无法连接网络,(可能防火墙拦截,如果可以正常访问大漠插件网站，那就可以肯定是被防火墙拦截)\
-2 : 进程没有以管理员方式运行. (出现在win7 win8 vista 2008.建议关闭uac)\
0 : 失败 (未知错误)\
1 : 成功\
2 : 余额不足\
3 : 绑定了本机器，但是账户余额不足50元.\
4 : 注册码错误\
5 : 你的机器或者IP在黑名单列表中或者不在白名单列表中.\
6 : 非法使用插件. 一般出现在定制插件时，使用了和绑定的用户名不同的注册码.  也有可能是系统的语言设置不是中文简体,也可能有这个错误.\
7 : 你的帐号因为非法使用被封禁. （如果是在虚拟机中使用插件，必须使用Reg或者RegEx，不能使用RegNoMac或者RegExNoMac,否则可能会造成封号，或者封禁机器）\
8 : ver\_info不在你设置的附加白名单中.\
77： 机器码或者IP因为非法使用，而被封禁. （如果是在虚拟机中使用插件，必须使用Reg或者RegEx，不能使用RegNoMac或者RegExNoMac,否则可能会造成封号，或者封禁机器）\
`     `封禁是全局的，如果使用了别人的软件导致77，也一样会导致所有注册码均无法注册。解决办法是更换IP，更换MAC.\
777： 同一个机器码注册次数超过了服务器限制,被暂时封禁. 请登录后台，插件今日详细消费记录里，相应的机器码是否有次数异常，并立刻优化解决.如果还有问题，可以联系我来解决.\
-8 : 版本附加信息长度超过了32\
-9 : 版本附加信息里包含了非法字母.\
空 : 这是不可能返回空的，如果出现空，那肯定是当前使用的版本不对,老的插件里没这个函数导致返回为空.最好参考文档中的标准写法,判断插件版本号.

<a name="chmtopic371"></a>**函数简介:**

设定图色的获取方式，默认是显示器或者后台窗口(具体参考BindWindow)

**函数原型:**\
\
long SetDisplayInput(mode)

**参数定义:**\
\
mode 字符串: 图色输入模式 取值有以下几种

1\.     "screen" 这个是默认的模式，表示使用显示器或者后台窗口

2\.     "pic:file" 指定输入模式为指定的图片,如果使用了这个模式，则所有和图色相关的函数

均视为对此图片进行处理，比如文字识别 查找图片 颜色 等等一切图色函数.

需要注意的是，设定以后，此图片就已经加入了缓冲，如果更改了源图片内容，那么需要\
释放此缓冲，重新设置.

3\.     "mem:addr,size" 指定输入模式为指定的图片,此图片在内存当中. addr为图像内存地址,size为图像内存大小.\
如果使用了这个模式，则所有和图色相关的函数,均视为对此图片进行处理.\
比如文字识别 查找图片 颜色 等等一切图色函数.

**返回值:**

整形数:\
0: 失败

1: 成功

<a name="chmtopic373"></a>**函数简介:**

设置EnumWindow  EnumWindowByProcess  EnumWindowSuper FindWindow以及FindWindowEx的最长延时. 内部默认超时是10秒.

**函数原型:**\
\
long SetEnumWindowDelay(delay)

**参数定义:**\
\
delay 整形数: 单位毫秒

**返回值:**

整形数:\
0: 失败

1: 成功

<a name="chmtopic375"></a>**函数简介:**

设置全局路径,设置了此路径后,所有接口调用中,相关的文件都相对于此路径. 比如图片,字库等.

**函数原型:**\
\
long SetPath(path)

**参数定义:**\
\
path 字符串: 路径,可以是相对路径,也可以是绝对路径

**返回值:**

整形数:\
0: 失败\
1: 成功

<a name="chmtopic377"></a>**函数简介:**

设置是否弹出错误信息,默认是打开.

**函数原型:**\
\
long SetShowErrorMsg(show)

**参数定义:**

show 整形数: 0表示不打开,1表示打开

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic379"></a>**函数简介:**

设置是否对前台图色进行加速. (默认是关闭). (对于不绑定，或者绑定图色为normal生效)( 仅对WIN8以上系统有效)

**函数原型:**\
\
long SpeedNormalGraphic(enable)

**参数定义:**\
\
enable 整形数: \
`       `0 : 关闭\
`       `1 : 打开

**返回值:**

整形数:\
0: 失败

1: 成功

<a name="chmtopic381"></a>**函数简介:**

返回当前插件版本号

**函数原型:**\
\
string Ver()

**参数定义:**

**返回值:**

字符串:\
当前插件的版本描述字符串

<a name="chmtopic385"></a>**函数简介:**

设置当前系统鼠标的精确度开关. 如果所示。 此接口仅仅对前台MoveR接口起作用.

![](Aspose.Words.894c5d01-8a6e-49c3-93b9-a1140f340381.016.jpeg)

**函数原型:**\
\
long EnableMouseAccuracy(enable)

**参数定义:**\
\
enable整形数: 0 关闭指针精确度开关.  1打开指针精确度开关. 一般推荐关闭.

**返回值:**

整形数:\
设置之前的精确度开关. 

<a name="chmtopic387"></a>**函数简介:**

获取鼠标位置.

**函数原型:**\
\
long GetCursorPos(x,y)

**参数定义:**\
\
x 变参指针: 返回X坐标

y 变参指针: 返回Y坐标

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic389"></a>**函数简介:**

获取鼠标特征码. 当BindWindow或者BindWindowEx中的mouse参数含有dx.mouse.cursor时，

获取到的是后台鼠标特征，否则是前台鼠标特征. [关于如何识别后台鼠标特征.](#chmtopic122)

**函数原型:**\
\
string GetCursorShape()

**参数定义:**

**返回值:**

字符串:\
成功时，返回鼠标特征码.  \
失败时，返回空的串.

<a name="chmtopic391"></a>**函数简介:**

获取鼠标特征码. 当BindWindow或者BindWindowEx中的mouse参数含有dx.mouse.cursor时，

获取到的是后台鼠标特征，否则是前台鼠标特征.  [关于如何识别后台鼠标特征.](#chmtopic122)

**函数原型:**\
\
string GetCursorShapeEx(int type)

**参数定义:**

type 整形数:获取鼠标特征码的方式. 和工具中的方式1 方式2对应. 方式1此参数值为0. 方式2此参数值为1.

**返回值:**

字符串:\
成功时，返回鼠标特征码.  \
失败时，返回空的串.

<a name="chmtopic393"></a>**函数简介:**

获取鼠标热点位置.(参考工具中抓取鼠标后，那个闪动的点就是热点坐标,不是鼠标坐标)

当BindWindow或者BindWindowEx中的mouse参数含有dx.mouse.cursor时，

获取到的是后台鼠标热点位置，否则是前台鼠标热点位置.  [关于如何识别后台鼠标特征.](#chmtopic122)

**函数原型:**\
\
string GetCursorSpot()

**参数定义:**

**返回值:**

字符串:\
成功时，返回形如"x,y"的字符串  \
失败时，返回空的串.

<a name="chmtopic395"></a>**函数简介:**

获取指定的按键状态.(前台信息,不是后台)

**函数原型:**\
\
long GetKeyState(vk\_code)

**参数定义:**\
\
vk\_code 整形数:虚拟按键码

**返回值:**

整形数:\
0:弹起\
1:按下

<a name="chmtopic397"></a>**函数简介:**

获取系统鼠标的移动速度.  如图所示红色区域. 一共分为11个级别. 从1开始,11结束. 这仅是前台鼠标的速度. 后台不用理会这个.

![ref3]

**函数原型:**\
\
long GetMouseSpeed()

**参数定义:**

**返回值:**

整形数:\
0:失败\
其他值,当前系统鼠标的移动速度

<a name="chmtopic399"></a>**函数简介:**

按住指定的虚拟键码

**函数原型:**\
\
long KeyDown(vk\_code)

**参数定义:**\
\
vk\_code **整形数**:虚拟按键码

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic402"></a>**函数简介:**

按住指定的虚拟键码

**函数原型:**\
\
long KeyDownChar(key\_str)

**参数定义:**\
\
key\_str **字符串**: 字符串描述的键码. 大小写无所谓. [点这里查看具体对应关系](#chmtopic401).

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic404"></a>**函数简介:**

按下指定的虚拟键码

**函数原型:**\
\
long KeyPress(vk\_code)

**参数定义:**\
\
vk\_code 整形数:虚拟按键码

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic406"></a>**函数简介:**

按下指定的虚拟键码

**函数原型:**\
\
long KeyPressChar(key\_str)

**参数定义:**\
\
key\_str** 字符串**:** 字符串描述的键码. 大小写无所谓**. [点这里查看具体对应关系](#chmtopic401).**

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic408"></a>**函数简介:**

根据指定的字符串序列，依次按顺序按下其中的字符.

**函数原型:**\
\
long KeyPressStr(key\_str,delay)

**参数定义:**\
\
key\_str** 字符串**:** 需要按下的字符串序列. 比如"1234","abcd","7389,1462"等.

delay 整形数: 每按下一个按键，需要延时多久. 单位毫秒.这个值越大，按的速度越慢。

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic410"></a>**函数简介:**

弹起来虚拟键vk\_code

**函数原型:**\
\
long KeyUp(vk\_code)

**参数定义:**\
\
vk\_code 整形数:虚拟按键码

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic412"></a>**函数简介:**

弹起来虚拟键key\_str

**函数原型:**\
\
long KeyUpChar(key\_str)

**参数定义:**\
\
key\_str** 字符串**:** 字符串描述的键码. 大小写无所谓**. [点这里查看具体对应关系](#chmtopic401).**

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic414"></a>**函数简介:**

按下鼠标左键

**函数原型:**\
\
long LeftClick()

**参数定义:**

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic416"></a>**函数简介:**

双击鼠标左键

**函数原型:**\
\
long LeftDoubleClick()

**参数定义:**

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic418"></a>**函数简介:**

按住鼠标左键

**函数原型:**\
\
long LeftDown()

**参数定义:**

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic420"></a>**函数简介:**

弹起鼠标左键

**函数原型:**\
\
long LeftUp()

**参数定义:**

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic422"></a>**函数简介:**

按下鼠标中键

**函数原型:**\
\
long MiddleClick()

**参数定义:**

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic424"></a>**函数简介:**

按住鼠标中键

**函数原型:**\
\
long MiddleDown()

**参数定义:**

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic426"></a>**函数简介:**

弹起鼠标中键

**函数原型:**\
\
long MiddleUp()

**参数定义:**

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic428"></a>**函数简介:**

鼠标相对于上次的位置移动rx,ry.   如果您要使前台鼠标移动的距离和指定的rx,ry一致,最好配合[EnableMouseAccuracy](#chmtopic385)函数来使用.

**函数原型:**\
\
long MoveR(rx,ry)

**参数定义:**\
\
rx 整形数:相对于上次的X偏移\
ry 整形数:相对于上次的Y偏移

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic430"></a>**函数简介:**

把鼠标移动到目的点(x,y)

**函数原型:**\
\
long MoveTo(x,y)

**参数定义:**\
\
x 整形数:X坐标\
y 整形数:Y坐标

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic432"></a>**函数简介:**

把鼠标移动到目的范围内的任意一点

**函数原型:**\
\
string MoveToEx(x,y,w,h)

**参数定义:**\
\
x 整形数:X坐标\
y 整形数:Y坐标\
w 整形数:宽度(从x计算起)\
h 整形数:高度(从y计算起)

**返回值:**

字符串:\
返回要移动到的目标点. 格式为x,y.  比如MoveToEx 100,100,10,10,返回值可能是101,102

<a name="chmtopic434"></a>**函数简介:**

按下鼠标右键

**函数原型:**\
\
long RightClick()

**参数定义:**

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic436"></a>**函数简介:**

按住鼠标右键

**函数原型:**\
\
long RightDown()

**参数定义:**

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic438"></a>**函数简介:**

弹起鼠标右键

**函数原型:**\
\
long RightUp()

**参数定义:**

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic440"></a>**函数简介:**

设置按键时,键盘按下和弹起的时间间隔。高级用户使用。某些窗口可能需要调整这个参数才可以正常按键。

**函数原型:**\
\
long SetKeypadDelay(type,delay)

**参数定义:**\
\
type **字符串**: 键盘类型,取值有以下

`     `"normal" : 对应normal键盘  默认内部延时为30ms

`     `"windows": 对应windows 键盘 默认内部延时为10ms

`     `"dx" :     对应dx 键盘 默认内部延时为50ms

delay 整形数: 延时,单位是毫秒

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic442"></a>**函数简介:**

设置鼠标单击或者双击时,鼠标按下和弹起的时间间隔。高级用户使用。某些窗口可能需要调整这个参数才可以正常点击。

**函数原型:**\
\
long SetMouseDelay(type,delay)

**参数定义:**\
\
type **字符串**: 鼠标类型,取值有以下

`     `"normal" : 对应normal鼠标 默认内部延时为 30ms

`     `"windows": 对应windows 鼠标 默认内部延时为 10ms

`     `"dx" :     对应dx鼠标 默认内部延时为40ms

delay 整形数: 延时,单位是毫秒

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic444"></a>**函数简介:**

设置系统鼠标的移动速度.  如图所示红色区域. 一共分为11个级别. 从1开始,11结束。此接口仅仅对前台鼠标有效.

![ref3]

**函数原型:**\
\
long SetMouseSpeed(speed)

**参数定义:**\
\
speed 整形数:鼠标移动速度, 最小1，最大11.  居中为6. 推荐设置为6

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic446"></a>**函数简介:**

设置前台键鼠的模拟方式. \
驱动功能支持的系统版本号为(win7/win8/win8.1/win10(10240)/win10(10586)/win10(14393)/win10(15063)/win10(16299)/win10(17134)/win10(17763)/win10(18362)/win10(18363)/win10(19041)/win10(19042) /win10(19043)/ win10(19045)/win11(22000)/win11(22621)/win11(22631)\
不支持所有的预览版本,仅仅支持正式版本.  除了模式3,其他模式同时支持32位系统和64位系统.

**函数原型:**\
\
long SetSimMode(mode)

**参数定义:**

mode 整形数: 0 正常模式(默认模式)\
`             `1 硬件模拟\
`             `2 硬件模拟2(ps2)（仅仅支持标准的3键鼠标，即左键，右键，中键，带滚轮的鼠标,2键和5键等扩展鼠标不支持）\
`             `3 硬件模拟3

**返回值:**

整形数:\
0  : 插件没注册\
-1 : 32位系统不支持\
-2 : 驱动释放失败.\
-3 : 驱动加载失败.可能是权限不够. 参考UAC权限设置. 或者是被安全软件拦截. \
`     `如果是WIN10 1607之后的系统，出现这个错误，可[参考这里](#chmtopic84)\
-10: 设置失败\
-7 : 系统版本不支持. 可以用winver命令查看系统内部版本号. 驱动只支持正式发布的版本，所有预览版本都不支持.\
1  : 成功

<a name="chmtopic448"></a>**函数简介:**

等待指定的按键按下 (前台,不是后台)

**函数原型:**\
\
long WaitKey(vk\_code,time\_out)

**参数定义:**\
\
vk\_code 整形数:虚拟按键码,当此值为0，表示等待任意按键。 鼠标左键是1,鼠标右键时2,鼠标中键是4.\
time\_out 整形数:等待多久,单位毫秒. 如果是0，表示一直等待

**返回值:**

整形数:\
0:超时\
1:指定的按键按下 (当vk\_code不为0时)\
按下的按键码:(当vk\_code为0时)

<a name="chmtopic450"></a>**函数简介:**

滚轮向下滚

**函数原型:**\
\
long WheelDown()

**参数定义:**

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic452"></a>**函数简介:**

滚轮向上滚

**函数原型:**\
\
long WheelUp()

**参数定义:**

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic455"></a>**函数简介:**

把双精度浮点数转换成二进制形式.

**函数原型:**\
\
string DoubleToData(value)

**参数定义:**\
\
value **双精度浮点数**: 需要转化的双精度浮点数

**返回值:**

字符串:\
字符串形式表达的二进制数据. 可以用于WriteData FindData FindDataEx等接口.

<a name="chmtopic458"></a>**函数简介:**

搜索指定的二进制数据,默认步长是1.默认开启多线程,默认搜索全部内存军类型.如果要定制搜索,请用FindDataEx

**函数原型:**\
\
string FindData(hwnd, addr\_range, data)

**参数定义:**\
\
hwnd **整形数**: 指定搜索的窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr\_range 字符串: 指定搜索的地址集合，字符串类型，这个地方可以是上次FindXXX的返回地址集合,可以进行二次搜索.(类似CE的再次扫描)

`             `如果要进行地址范围搜索，那么这个值为的形如如下(类似于CE的新搜索)

`            `"00400000-7FFFFFFF" "80000000-BFFFFFFF" "00000000-FFFFFFFF" 等.

data 字符串: 要搜索的二进制数据 以字符串的形式描述 比如"00 01 23 45 67 86 ab ce f1"等. \
`             `这里也可以支持模糊查找,用??来代替单个字节. 比如"00 01 ?? ?? 67 86 ?? ce f1"等. \
`             `注意,这里不支持半个字节,比如3?这种不行.

**返回值:**

字符串:\
返回搜索到的地址集合，地址格式如下:

"addr1|addr2|addr3…|addrn"

比如"400050|423435|453430"\
\
如果要想知道函数是否执行成功，请查看[GetLastError](#chmtopic280)函数.

<a name="chmtopic460"></a>**函数简介:**

搜索指定的二进制数据.

**函数原型:**\
\
string FindDataEx(hwnd, addr\_range, data,step,multi\_thread,mode)

**参数定义:**\
\
hwnd **整形数**: 指定搜索的窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr\_range 字符串: 指定搜索的地址集合，字符串类型，这个地方可以是上次FindXXX的返回地址集合,可以进行二次搜索.(类似CE的再次扫描)

`             `如果要进行地址范围搜索，那么这个值为的形如如下(类似于CE的新搜索)

`            `"00400000-7FFFFFFF" "80000000-BFFFFFFF" "00000000-FFFFFFFF" 等.

data 字符串: 要搜索的二进制数据 以字符串的形式描述 比如"00 01 23 45 67 86 ab ce f1"等\
`             `这里也可以支持模糊查找,用??来代替单个字节. 比如"00 01 ?? ?? 67 86 ?? ce f1"等.\
`             `注意,这里不支持半个字节,比如3?这种不行.

step 整形数: 搜索步长.

multi\_thread整形数:表示是否开启多线程查找.  0不开启，1开启.\
`                   `开启多线程查找速度较快，但会耗费较多CPU资源. 不开启速度较慢，但节省CPU.

mode 整形数: 1 表示开启快速扫描(略过只读内存)  0表示所有内存类型全部扫描.

**返回值:**

字符串:\
返回搜索到的地址集合，地址格式如下:

"addr1|addr2|addr3…|addrn"

比如"400050|423435|453430"\
\
如果要想知道函数是否执行成功，请查看[GetLastError](#chmtopic280)函数.

<a name="chmtopic462"></a>**函数简介:**

搜索指定的双精度浮点数,默认步长是1.如果要定制步长，请用FindDoubleEx

**函数原型:**\
\
string FindDouble(hwnd, addr\_range, double\_value\_min, double\_value\_max)

**参数定义:**\
\
hwnd **整形数**: 指定搜索的窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr\_range 字符串: 指定搜索的地址集合，字符串类型，这个地方可以是上次FindXXX的返回地址集合,可以进行二次搜索.(类似CE的再次扫描)

`             `如果要进行地址范围搜索，那么这个值为的形如如下(类似于CE的新搜索)

`            `"00400000-7FFFFFFF" "80000000-BFFFFFFF" "00000000-FFFFFFFF" 等.

double\_value\_min 双精度浮点数: 搜索的双精度数值最小值

double\_value\_max 双精度浮点数: 搜索的双精度数值最大值 

最终搜索的数值大与等于double\_value\_min,并且小于等于double\_value\_max

**返回值:**

字符串:\
返回搜索到的地址集合，地址格式如下:

"addr1|addr2|addr3…|addrn"

比如"400050|423435|453430"\
\
如果要想知道函数是否执行成功，请查看[GetLastError](#chmtopic280)函数.

<a name="chmtopic464"></a>**函数简介:**

搜索指定的双精度浮点数.

**函数原型:**\
\
string FindDoubleEx(hwnd, addr\_range, double\_value\_min, double\_value\_max,step,multi\_thread,mode)

**参数定义:**\
\
hwnd **整形数**: 指定搜索的窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr\_range 字符串: 指定搜索的地址集合，字符串类型，这个地方可以是上次FindXXX的返回地址集合,可以进行二次搜索.(类似CE的再次扫描)

`             `如果要进行地址范围搜索，那么这个值为的形如如下(类似于CE的新搜索)

`            `"00400000-7FFFFFFF" "80000000-BFFFFFFF" "00000000-FFFFFFFF" 等.

double\_value\_min 双精度浮点数: 搜索的双精度数值最小值

double\_value\_max 双精度浮点数: 搜索的双精度数值最大值 

最终搜索的数值大与等于double\_value\_min,并且小于等于double\_value\_max

step 整形数: 搜索步长.

multi\_thread整形数:表示是否开启多线程查找.  0不开启，1开启.\
`                   `开启多线程查找速度较快，但会耗费较多CPU资源. 不开启速度较慢，但节省CPU.

mode 整形数: 1 表示开启快速扫描(略过只读内存)  0表示所有内存类型全部扫描.

**返回值:**

字符串:\
返回搜索到的地址集合，地址格式如下:

"addr1|addr2|addr3…|addrn"

比如"400050|423435|453430"\
\
如果要想知道函数是否执行成功，请查看[GetLastError](#chmtopic280)函数.

<a name="chmtopic466"></a>**函数简介:**

搜索指定的单精度浮点数,默认步长是1.如果要定制步长，请用FindFloatEx

**函数原型:**\
\
string FindFloat(hwnd, addr\_range, float\_value\_min, float\_value\_max)

**参数定义:**\
\
hwnd **整形数**: 指定搜索的窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr\_range 字符串: 指定搜索的地址集合，字符串类型，这个地方可以是上次FindXXX的返回地址集合,可以进行二次搜索.(类似CE的再次扫描)

`             `如果要进行地址范围搜索，那么这个值为的形如如下(类似于CE的新搜索)

`            `"00400000-7FFFFFFF" "80000000-BFFFFFFF" "00000000-FFFFFFFF" 等.

float\_value\_min 单精度浮点数: 搜索的单精度数值最小值

float\_value\_max 单精度浮点数: 搜索的单精度数值最大值 

最终搜索的数值大与等于float\_value\_min,并且小于等于float\_value\_max

**返回值:**

字符串:\
返回搜索到的地址集合，地址格式如下:

"addr1|addr2|addr3…|addrn"

比如"400050|423435|453430"\
\
如果要想知道函数是否执行成功，请查看[GetLastError](#chmtopic280)函数.

<a name="chmtopic468"></a>**函数简介:**

搜索指定的单精度浮点数. 

**函数原型:**\
\
string FindFloatEx(hwnd, addr\_range, float\_value\_min, float\_value\_max,step,multi\_thread,mode)

**参数定义:**\
\
hwnd **整形数**: 指定搜索的窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr\_range 字符串: 指定搜索的地址集合，字符串类型，这个地方可以是上次FindXXX的返回地址集合,可以进行二次搜索.(类似CE的再次扫描)

`             `如果要进行地址范围搜索，那么这个值为的形如如下(类似于CE的新搜索)

`            `"00400000-7FFFFFFF" "80000000-BFFFFFFF" "00000000-FFFFFFFF" 等.

float\_value\_min 单精度浮点数: 搜索的单精度数值最小值

float\_value\_max 单精度浮点数: 搜索的单精度数值最大值 

最终搜索的数值大与等于float\_value\_min,并且小于等于float\_value\_max

step 整形数: 搜索步长.

multi\_thread整形数:表示是否开启多线程查找.  0不开启，1开启.\
`                   `开启多线程查找速度较快，但会耗费较多CPU资源. 不开启速度较慢，但节省CPU.

mode 整形数: 1 表示开启快速扫描(略过只读内存)  0表示所有内存类型全部扫描.

**返回值:**

字符串:\
返回搜索到的地址集合，地址格式如下:

"addr1|addr2|addr3…|addrn"

比如"400050|423435|453430"\
\
如果要想知道函数是否执行成功，请查看[GetLastError](#chmtopic280)函数.

<a name="chmtopic470"></a>**函数简介:**

搜索指定的整数,默认步长是1.如果要定制步长，请用FindIntEx

**函数原型:**\
\
string FindInt(hwnd, addr\_range, int\_value\_min, int\_value\_max,type)

**参数定义:**\
\
hwnd **整形数**: 指定搜索的窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr\_range 字符串: 指定搜索的地址集合，字符串类型，这个地方可以是上次FindXXX的返回地址集合,可以进行二次搜索.(类似CE的再次扫描)

`             `如果要进行地址范围搜索，那么这个值为的形如如下(类似于CE的新搜索)

`            `"00400000-7FFFFFFF" "80000000-BFFFFFFF" "00000000-FFFFFFFF" 等.

int\_value\_min 长整形数: 搜索的整数数值最小值

int\_value\_max 长整形数: 搜索的整数数值最大值 

最终搜索的数值大与等于int\_value\_min,并且小于等于int\_value\_max

type 整形数: 搜索的整数类型,取值如下

`      `0 : 32位

`      `1 : 16 位

`      `2 : 8位

`      `3 : 64位

**返回值:**

字符串:\
返回搜索到的地址集合，地址格式如下:

"addr1|addr2|addr3…|addrn"

比如"400050|423435|453430"\
\
如果要想知道函数是否执行成功，请查看[GetLastError](#chmtopic280)函数.

<a name="chmtopic472"></a>**函数简介:**

搜索指定的整数.

**函数原型:**\
\
string FindIntEx(hwnd, addr\_range, int\_value\_min, int\_value\_max,type,step,multi\_thread,mode)

**参数定义:**\
\
hwnd **整形数**: 指定搜索的窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr\_range 字符串: 指定搜索的地址集合，字符串类型，这个地方可以是上次FindXXX的返回地址集合,可以进行二次搜索.(类似CE的再次扫描)

`             `如果要进行地址范围搜索，那么这个值为的形如如下(类似于CE的新搜索)

`            `"00400000-7FFFFFFF" "80000000-BFFFFFFF" "00000000-FFFFFFFF" 等.

int\_value\_min 长整形数: 搜索的整数数值最小值

int\_value\_max 长整形数: 搜索的整数数值最大值 

最终搜索的数值大与等于int\_value\_min,并且小于等于int\_value\_max

type 整形数: 搜索的整数类型,取值如下

`      `0 : 32位

`      `1 : 16 位

`      `2 : 8位

`      `3 : 64位

step 整形数: 搜索步长.

multi\_thread整形数:表示是否开启多线程查找.  0不开启，1开启.\
`                   `开启多线程查找速度较快，但会耗费较多CPU资源. 不开启速度较慢，但节省CPU.

mode 整形数: 1 表示开启快速扫描(略过只读内存)  0表示所有内存类型全部扫描.

**返回值:**

字符串:\
返回搜索到的地址集合，地址格式如下:

"addr1|addr2|addr3…|addrn"

比如"400050|423435|453430"\
\
如果要想知道函数是否执行成功，请查看[GetLastError](#chmtopic280)函数.

<a name="chmtopic474"></a>**函数简介:**

搜索指定的字符串,默认步长是1.如果要定制步长，请用FindStringEx

**函数原型:**\
\
string FindString(hwnd, addr\_range, string\_value,type)

**参数定义:**\
\
hwnd **整形数**: 指定搜索的窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr\_range 字符串: 指定搜索的地址集合，字符串类型，这个地方可以是上次FindXXX的返回地址集合,可以进行二次搜索.(类似CE的再次扫描)

`             `如果要进行地址范围搜索，那么这个值为的形如如下(类似于CE的新搜索)

`            `"00400000-7FFFFFFF" "80000000-BFFFFFFF" "00000000-FFFFFFFF" 等.

string\_value 字符串: 搜索的字符串

type 整形数: 搜索的字符串类型,取值如下

`      `0 : Ascii字符串

`      `1 : Unicode字符串

`      `2 : UTF8字符串

**返回值:**

字符串:\
返回搜索到的地址集合，地址格式如下:

"addr1|addr2|addr3…|addrn"

比如"400050|423435|453430"\
\
如果要想知道函数是否执行成功，请查看[GetLastError](#chmtopic280)函数.

<a name="chmtopic476"></a>**函数简介:**

搜索指定的字符串.

**函数原型:**\
\
string FindStringEx(hwnd, addr\_range, string\_value,type,step,multi\_thread,mode)

**参数定义:**\
\
hwnd **整形数**: 指定搜索的窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr\_range 字符串: 指定搜索的地址集合，字符串类型，这个地方可以是上次FindXXX的返回地址集合,可以进行二次搜索.(类似CE的再次扫描)

`             `如果要进行地址范围搜索，那么这个值为的形如如下(类似于CE的新搜索)

`            `"00400000-7FFFFFFF" "80000000-BFFFFFFF" "00000000-FFFFFFFF" 等.

string\_value 字符串: 搜索的字符串

type 整形数: 搜索的字符串类型,取值如下

`      `0 : Ascii字符串

`      `1 : Unicode字符串

`      `2 : UTF8字符串

step 整形数: 搜索步长.

multi\_thread整形数:表示是否开启多线程查找.  0不开启，1开启.\
`                   `开启多线程查找速度较快，但会耗费较多CPU资源. 不开启速度较慢，但节省CPU.

mode 整形数: 1 表示开启快速扫描(略过只读内存)  0表示所有内存类型全部扫描.

**返回值:**

字符串:\
返回搜索到的地址集合，地址格式如下:

"addr1|addr2|addr3…|addrn"

比如"400050|423435|453430"\
\
如果要想知道函数是否执行成功，请查看[GetLastError](#chmtopic280)函数.

<a name="chmtopic478"></a>**函数简介:**

把单精度浮点数转换成二进制形式.

**函数原型:**\
\
string FloatToData(value)

**参数定义:**\
\
value **单精度浮点数**: 需要转化的单精度浮点数

**返回值:**

字符串:\
字符串形式表达的二进制数据. 可以用于WriteData FindData FindDataEx等接口.

<a name="chmtopic238"></a>**函数简介:**

释放指定进程的不常用内存.

**函数原型:**\
\
long FreeProcessMemory(hwnd)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

**返回值:**

整形数:\
\
0 : 失败\
1 : 成功

<a name="chmtopic481"></a>**函数简介:**

获取指定窗口所在进程的启动命令行

**函数原型:**\
\
string GetCommandLine(hwnd)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

**返回值:**

字符串:\
读取到的启动命令行

<a name="chmtopic483"></a>**函数简介:**

根据指定的窗口句柄，来获取对应窗口句柄进程下的指定模块的基址

**函数原型:**\
\
LONGLONG GetModuleBaseAddr(hwnd,module)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

module 字符串: 模块名

**返回值:**

长整形数:\
模块的基址

<a name="chmtopic485"></a>**函数简介:**

根据指定的窗口句柄，来获取对应窗口句柄进程下的指定模块的大小

**函数原型:**\
\
long GetModuleSize(hwnd,module)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

module 字符串: 模块名

**返回值:**

整形数:\
模块的大小

<a name="chmtopic487"></a>**函数简介:**

根据指定的目标模块地址,获取目标窗口(进程)内的导出函数地址. 

**函数原型:**\
\
LONGLONG GetRemoteApiAddress(hwnd,base\_addr,fun\_name)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

base\_addr 长整形数: 目标模块地址,比如user32.dll的地址,可以通过GetModuleBaseAddr来获取.

fun\_addr字符串**:** 需要获取的导出函数名.  比如"SetWindowTextA".

**返回值:**

长整形数:\
获取的地址. 如果失败返回0

<a name="chmtopic489"></a>**函数简介:**

强制转换64位整数为32位. (这个函数是给按键精灵设计的,由于按键精灵不支持64位自动化变量,某些返回64位的整数的接口会出错)

**函数原型:**\
\
long Int64ToInt32(value)

**参数定义:**\
\
value 长整形数**:** 需要转换的64位整数

**返回值:**

整形数:\
返回的32位整数

<a name="chmtopic491"></a>**函数简介:**

把整数转换成二进制形式.

**函数原型:**\
\
string IntToData(value,type)

**参数定义:**\
\
value **长整形数**: 需要转化的整型数\
type  **整形数**: 取值如下:\
`            `0: 4字节整形数 (一般都选这个)\
`            `1: 2字节整形数\
`            `2: 1字节整形数\
`            `3: 8字节整形数

**返回值:**

字符串:\
字符串形式表达的二进制数据. 可以用于WriteData FindData FindDataEx等接口.

<a name="chmtopic493"></a>**函数简介:**

根据指定pid打开进程，并返回进程句柄.

**函数原型:**\
\
long OpenProcess(pid)

**参数定义:**\
pid  **整形数**: 进程pid

**返回值:**

整形数:\
进程句柄, 可用于进程相关操作(读写操作等),记得操作完成以后，自己调用CloseHandle关闭句柄.

<a name="chmtopic495"></a>**函数简介:**

读取指定地址的二进制数据

**函数原型:**\
\
string ReadData(hwnd,addr,len)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr 字符串: 用字符串来描述地址，类似于CE的地址描述，数值必须是16进制,里面可以用[ ] + -这些符号来描述一个地址。+表示地址加，-表示地址减\
`       `模块名必须用<>符号来圈起来

`      `例如:

1\.         "4DA678" 最简单的方式，用绝对数值来表示地址

2\.         "<360SE.exe>+DA678" 相对简单的方式，只是这里用模块名来决定模块基址，后面的是偏移

3\.         "[4DA678]+3A" 用绝对数值加偏移，相当于一级指针

4\.         "[<360SE.exe>+DA678]+3A" 用模块定基址的方式，也是一级指针

5\.         "[[[<360SE.exe>+DA678]+3A]+5B]+8" 这个是一个三级指针

总之熟悉CE的人 应该对这个地址描述都很熟悉,我就不多举例了

len 整形数: 二进制数据的长度

**返回值:**

字符串:\
读取到的数值,以16进制表示的字符串 每个字节以空格相隔 比如"12 34 56 78 ab cd ef"\
\
如果要想知道函数是否执行成功，请查看[GetLastError](#chmtopic280)函数.

<a name="chmtopic497"></a>**函数简介:**

读取指定地址的二进制数据

**函数原型:**\
\
string ReadDataAddr(hwnd,addr,len)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr长整形数: 地址

len 整形数: 二进制数据的长度

**返回值:**

字符串:\
读取到的数值,以16进制表示的字符串 每个字节以空格相隔 比如"12 34 56 78 ab cd ef"\
\
如果要想知道函数是否执行成功，请查看[GetLastError](#chmtopic280)函数.

<a name="chmtopic499"></a>**函数简介:**

读取指定地址的二进制数据,只不过返回的是内存地址,而不是字符串.适合高级用户.

**函数原型:**\
\
long ReadDataAddrToBin(hwnd,addr,len)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr长整形数: 地址

len 整形数: 二进制数据的长度

**返回值:**

整形数:\
读取到的数据指针. 返回0表示读取失败.\
\
如果要想知道函数是否执行成功，请查看[GetLastError](#chmtopic280)函数.

<a name="chmtopic501"></a>**函数简介:**

读取指定地址的二进制数据,只不过返回的是内存地址,而不是字符串.适合高级用户.

**函数原型:**\
\
long ReadDataToBin(hwnd,addr,len)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr 字符串: 用字符串来描述地址，类似于CE的地址描述，数值必须是16进制,里面可以用[ ] + -这些符号来描述一个地址。+表示地址加，-表示地址减\
`       `模块名必须用<>符号来圈起来

`      `例如:

1\.         "4DA678" 最简单的方式，用绝对数值来表示地址

2\.         "<360SE.exe>+DA678" 相对简单的方式，只是这里用模块名来决定模块基址，后面的是偏移

3\.         "[4DA678]+3A" 用绝对数值加偏移，相当于一级指针

4\.         "[<360SE.exe>+DA678]+3A" 用模块定基址的方式，也是一级指针

5\.         "[[[<360SE.exe>+DA678]+3A]+5B]+8" 这个是一个三级指针

总之熟悉CE的人 应该对这个地址描述都很熟悉,我就不多举例了

len 整形数: 二进制数据的长度

**返回值:**

整形数:\
读取到的数据指针. 返回0表示读取失败.\
\
如果要想知道函数是否执行成功，请查看[GetLastError](#chmtopic280)函数.

<a name="chmtopic503"></a>**函数简介:**

读取指定地址的双精度浮点数

**函数原型:**\
\
double ReadDouble(hwnd,addr)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr 字符串: 用字符串来描述地址，类似于CE的地址描述，数值必须是16进制,里面可以用[ ] + -这些符号来描述一个地址。+表示地址加，-表示地址减\
`       `模块名必须用<>符号来圈起来

`      `例如:

1\.         "4DA678" 最简单的方式，用绝对数值来表示地址

2\.         "<360SE.exe>+DA678" 相对简单的方式，只是这里用模块名来决定模块基址，后面的是偏移

3\.         "[4DA678]+3A" 用绝对数值加偏移，相当于一级指针

4\.         "[<360SE.exe>+DA678]+3A" 用模块定基址的方式，也是一级指针

5\.         "[[[<360SE.exe>+DA678]+3A]+5B]+8" 这个是一个三级指针

总之熟悉CE的人 应该对这个地址描述都很熟悉,我就不多举例了

**返回值:**

双精度浮点数:\
读取到的数值 \
\
如果要想知道函数是否执行成功，请查看[GetLastError](#chmtopic280)函数.

<a name="chmtopic505"></a>**函数简介:**

读取指定地址的双精度浮点数

**函数原型:**\
\
double ReadDoubleAddr(hwnd,addr)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr长整形数: 地址

**返回值:**

双精度浮点数:\
读取到的数值 \
\
如果要想知道函数是否执行成功，请查看[GetLastError](#chmtopic280)函数.

<a name="chmtopic507"></a>**函数简介:**

读取指定地址的单精度浮点数

**函数原型:**\
\
float ReadFloat(hwnd,addr)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr 字符串: 用字符串来描述地址，类似于CE的地址描述，数值必须是16进制,里面可以用[ ] + -这些符号来描述一个地址。+表示地址加，-表示地址减\
`       `模块名必须用<>符号来圈起来

`      `例如:

1\.         "4DA678" 最简单的方式，用绝对数值来表示地址

2\.         "<360SE.exe>+DA678" 相对简单的方式，只是这里用模块名来决定模块基址，后面的是偏移

3\.         "[4DA678]+3A" 用绝对数值加偏移，相当于一级指针

4\.         "[<360SE.exe>+DA678]+3A" 用模块定基址的方式，也是一级指针

5\.         "[[[<360SE.exe>+DA678]+3A]+5B]+8" 这个是一个三级指针

总之熟悉CE的人 应该对这个地址描述都很熟悉,我就不多举例了

**返回值:**

单精度浮点数:\
读取到的数值 \
\
如果要想知道函数是否执行成功，请查看[GetLastError](#chmtopic280)函数.

<a name="chmtopic509"></a>**函数简介:**

读取指定地址的单精度浮点数

**函数原型:**\
\
float ReadFloatAddr(hwnd,addr)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr长整形数: 地址

**返回值:**

单精度浮点数:\
读取到的数值\
\
如果要想知道函数是否执行成功，请查看[GetLastError](#chmtopic280)函数.

<a name="chmtopic511"></a>**函数简介:**

读取指定地址的整数数值，类型可以是8位，16位  32位 或者64位

**函数原型:**\
\
LONGLONG ReadInt(hwnd,addr,type)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr 字符串: 用字符串来描述地址，类似于CE的地址描述，数值必须是16进制,里面可以用[ ] + -这些符号来描述一个地址。+表示地址加，-表示地址减\
`       `模块名必须用<>符号来圈起来

`      `例如:

1\.         "4DA678" 最简单的方式，用绝对数值来表示地址

2\.         "<360SE.exe>+DA678" 相对简单的方式，只是这里用模块名来决定模块基址，后面的是偏移

3\.         "[4DA678]+3A" 用绝对数值加偏移，相当于一级指针

4\.         "[<360SE.exe>+DA678]+3A" 用模块定基址的方式，也是一级指针

5\.         "[[[<360SE.exe>+DA678]+3A]+5B]+8" 这个是一个三级指针

总之熟悉CE的人 应该对这个地址描述都很熟悉,我就不多举例了

type 整形数: 整数类型,取值如下

`      `0 : 32位有符号

`      `1 : 16 位有符号

`      `2 : 8位有符号

`      `3 : 64位

`      `4 : 32位无符号

`      `5 : 16位无符号

`      `6 : 8位无符号

**返回值:**

长整形数:\
读取到的数值\
\
如果要想知道函数是否执行成功，请查看[GetLastError](#chmtopic280)函数. 

<a name="chmtopic513"></a>**函数简介:**

读取指定地址的整数数值，类型可以是8位，16位 32位 或者64位

**函数原型:**\
\
LONGLONG ReadIntAddr(hwnd,addr,type)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr长整形数: 地址

type 整形数: 整数类型,取值如下

`      `0 : 32位

`      `1 : 16 位

`      `2 : 8位

`      `3 : 64位

`      `4 : 32位无符号

`      `5 : 16位无符号

`      `6 : 8位无符号

**返回值:**

长整形数:\
读取到的数值\
\
如果要想知道函数是否执行成功，请查看[GetLastError](#chmtopic280)函数. 

<a name="chmtopic515"></a>**函数简介:**

读取指定地址的字符串，可以是GBK字符串或者是Unicode字符串.(必须事先知道内存区的字符串编码方式)

**函数原型:**\
\
string ReadString(hwnd,addr,type,len)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr 字符串: 用字符串来描述地址，类似于CE的地址描述，数值必须是16进制,里面可以用[ ] + -这些符号来描述一个地址。+表示地址加，-表示地址减\
`       `模块名必须用<>符号来圈起来

`      `例如:

1\.         "4DA678" 最简单的方式，用绝对数值来表示地址

2\.         "<360SE.exe>+DA678" 相对简单的方式，只是这里用模块名来决定模块基址，后面的是偏移

3\.         "[4DA678]+3A" 用绝对数值加偏移，相当于一级指针

4\.         "[<360SE.exe>+DA678]+3A" 用模块定基址的方式，也是一级指针

5\.         "[[[<360SE.exe>+DA678]+3A]+5B]+8" 这个是一个三级指针

总之熟悉CE的人 应该对这个地址描述都很熟悉,我就不多举例了

type 整形数: 字符串类型,取值如下

`      `0 : GBK字符串

`      `1 : Unicode字符串

`      `2 : UTF8字符串

len 整形数: 需要读取的字节数目.如果为0，则自动判定字符串长度.

**返回值:**

字符串:\
读取到的字符串\
\
如果要想知道函数是否执行成功，请查看[GetLastError](#chmtopic280)函数.

<a name="chmtopic517"></a>**函数简介:**

读取指定地址的字符串，可以是GBK字符串或者是Unicode字符串.(必须事先知道内存区的字符串编码方式)

**函数原型:**\
\
string ReadStringAddr(hwnd,addr,type,len)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr长整形数: 地址

type 整形数: 字符串类型,取值如下

`      `0 : GBK字符串

`      `1 : Unicode字符串

`      `2 : UTF8字符串

len 整形数: 需要读取的字节数目.如果为0，则自动判定字符串长度.

**返回值:**

字符串:\
读取到的字符串\
\
如果要想知道函数是否执行成功，请查看[GetLastError](#chmtopic280)函数. 

<a name="chmtopic519"></a>**函数简介:**

设置是否把所有内存查找接口的结果保存入指定文件.

**函数原型:**\
\
long SetMemoryFindResultToFile(file)

**参数定义:**\
\
file **字符串**: 设置要保存的搜索结果文件名. 如果为空字符串表示取消此功能.

**返回值:**

整形数:\
0 : 失败\
1 : 成功

<a name="chmtopic457"></a>**函数简介:**

设置是否把所有内存接口函数中的窗口句柄当作进程ID,以支持直接以进程ID来使用内存接口.

**函数原型:**\
\
long SetMemoryHwndAsProcessId(en)

**参数定义:**\
\
en **整形数**: 取值如下\
`             `0 : 关闭  1 : 开启

**返回值:**

整形数:\
0 : 失败\
1 : 成功

<a name="chmtopic522"></a>**函数简介:**

这个接口是给E语言设计的. 因为E语言的BUG,导致无法对COM对象调用传入长整数参数(被强制截断成整数),特别设计此接口来兼容长整数的处理.

**函数原型:**\
\
long SetParam64ToPointer()

**参数定义:**\
\

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic524"></a>**函数简介:**

把字符串转换成二进制形式.

**函数原型:**\
\
string StringToData(value,type)

**参数定义:**\
\
value**字符串**: 需要转化的字符串\
type  **整形数**: 取值如下:\
`            `0: 返回Ascii表达的字符串\
`            `1: 返回Unicode表达的字符串

**返回值:**

字符串:\
字符串形式表达的二进制数据. 可以用于WriteData FindData FindDataEx等接口.

<a name="chmtopic526"></a>**函数简介:**

根据指定的PID，强制结束进程.

**函数原型:**\
\
long TerminateProcess(pid)

**参数定义:**\
\
pid **整形数**:进程ID.

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic528"></a>**函数简介:**

根据指定的PID，强制结束进程以及此进程创建的所有子进程.

**函数原型:**\
\
long TerminateProcessTree(pid)

**参数定义:**\
\
pid **整形数**:进程ID.

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic530"></a>**函数简介:**

在指定的窗口所在进程分配一段内存.

**函数原型:**\
\
LONGLONG VirtualAllocEx(hwnd,addr,size,type)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr 长整形数: 预期的分配地址。 如果是0表示自动分配，否则就尝试在此地址上分配内存.

size **整形数**: 需要分配的内存大小.

type **整形数**: 需要分配的内存类型，取值如下:\
`             `0 : 可读可写可执行\
`             `1 : 可读可执行，不可写\
`             `2 : 可读可写,不可执行

**返回值:**

长整形数:\
分配的内存地址，如果是0表示分配失败.

<a name="chmtopic532"></a>**函数简介:**

释放用VirtualAllocEx分配的内存.

**函数原型:**\
\
long VirtualFreeEx(hwnd,addr)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr长整形数: VirtualAllocEx返回的地址

**返回值:**

整形数:\
0 : 失败\
1 : 成功

<a name="chmtopic534"></a>**函数简介:**

修改指定的窗口所在进程的地址的读写属性,修改为可读可写可执行.

**函数原型:**\
\
long VirtualProtectEx(hwnd,addr,size,type,old\_protect)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr 长整形数: 需要修改的地址

size **整形数**: 需要修改的地址大小.

type **整形数**: 修改的地址读写属性类型，取值如下:\
`             `0 : 可读可写可执行,此时old\_protect参数无效\
`             `1 : 修改为old\_protect指定的读写属性\
old\_protect**整形数**: 指定的读写属性

**返回值:**

整形数:\
0 : 失败\
1 : 修改之前的读写属性

<a name="chmtopic536"></a>**函数简介:**

获取指定窗口，指定地址的内存属性. 

**函数原型:**\
\
string VirtualQueryEx(hwnd,addr,pmbi)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr 长整形数: 需要查询的地址

pmbi **整形数**: 这是一个地址,指向的内容是MEMORY\_BASIC\_INFORMATION32或者MEMORY\_BASIC\_INFORMATION64.\
`               `取决于要查询的进程是32位还是64位. 这个地址可以为0,忽略这个参数.\
`               `下面是这2个结构体在vc下的定义:

typedef struct \_MEMORY\_BASIC\_INFORMATION32 {

`    `DWORD BaseAddress;

`    `DWORD AllocationBase;

`    `DWORD AllocationProtect;

`    `DWORD RegionSize;

`    `DWORD State;

`    `DWORD Protect;

`    `DWORD Type;

} MEMORY\_BASIC\_INFORMATION32, \*PMEMORY\_BASIC\_INFORMATION32;

typedef struct DECLSPEC\_ALIGN(16) \_MEMORY\_BASIC\_INFORMATION64 {

`    `ULONGLONG BaseAddress;

`    `ULONGLONG AllocationBase;

`    `DWORD     AllocationProtect;

`    `DWORD     \_\_alignment1;

`    `ULONGLONG RegionSize;

`    `DWORD     State;

`    `DWORD     Protect;

`    `DWORD     Type;

`    `DWORD     \_\_alignment2;

} MEMORY\_BASIC\_INFORMATION64, \*PMEMORY\_BASIC\_INFORMATION64;

**返回值:**

字符串:\
查询的结果以字符串形式.  内容是"BaseAddress,AllocationBase,AllocationProtect,RegionSize,State,Protect,Type"\
数值都是10进制表达.

<a name="chmtopic538"></a>**函数简介:**

对指定地址写入二进制数据

**函数原型:**\
\
long WriteData(hwnd,addr,data)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr 字符串: 用字符串来描述地址，类似于CE的地址描述，数值必须是16进制,里面可以用[ ] + -这些符号来描述一个地址。+表示地址加，-表示地址减\
`       `模块名必须用<>符号来圈起来

`      `例如:

1\.         "4DA678" 最简单的方式，用绝对数值来表示地址

2\.         "<360SE.exe>+DA678" 相对简单的方式，只是这里用模块名来决定模块基址，后面的是偏移

3\.         "[4DA678]+3A" 用绝对数值加偏移，相当于一级指针

4\.         "[<360SE.exe>+DA678]+3A" 用模块定基址的方式，也是一级指针

5\.         "[[[<360SE.exe>+DA678]+3A]+5B]+8" 这个是一个三级指针

总之熟悉CE的人 应该对这个地址描述都很熟悉,我就不多举例了

data 字符串: 二进制数据，以字符串形式描述，比如"12 34 56 78 90 ab cd"

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic540"></a>**函数简介:**

对指定地址写入二进制数据

**函数原型:**\
\
long WriteDataAddr(hwnd,addr,data)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr长整形数: 地址

data 字符串: 二进制数据，以字符串形式描述，比如"12 34 56 78 90 ab cd"

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic542"></a>**函数简介:**

对指定地址写入二进制数据,只不过直接从数据指针获取数据写入,不通过字符串. 适合高级用户.

**函数原型:**\
\
long WriteDataAddrFromBin(hwnd,addr,data,len)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr长整形数: 地址

data 整形数: 数据指针\
len  整形数: 数据长度

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic544"></a>**函数简介:**

对指定地址写入二进制数据,只不过直接从数据指针获取数据写入,不通过字符串. 适合高级用户.

**函数原型:**\
\
long WriteDataFromBin(hwnd,addr,data,len)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr 字符串: 用字符串来描述地址，类似于CE的地址描述，数值必须是16进制,里面可以用[ ] + -这些符号来描述一个地址。+表示地址加，-表示地址减\
`       `模块名必须用<>符号来圈起来

`      `例如:

1\.         "4DA678" 最简单的方式，用绝对数值来表示地址

2\.         "<360SE.exe>+DA678" 相对简单的方式，只是这里用模块名来决定模块基址，后面的是偏移

3\.         "[4DA678]+3A" 用绝对数值加偏移，相当于一级指针

4\.         "[<360SE.exe>+DA678]+3A" 用模块定基址的方式，也是一级指针

5\.         "[[[<360SE.exe>+DA678]+3A]+5B]+8" 这个是一个三级指针

总之熟悉CE的人 应该对这个地址描述都很熟悉,我就不多举例了

data 整形数: 数据指针\
len  整形数: 数据长度

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic546"></a>**函数简介:**

对指定地址写入双精度浮点数

**函数原型:**\
\
long WriteDouble(hwnd,addr,v)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr 字符串: 用字符串来描述地址，类似于CE的地址描述，数值必须是16进制,里面可以用[ ] + -这些符号来描述一个地址。+表示地址加，-表示地址减\
`       `模块名必须用<>符号来圈起来

`      `例如:

1\.         "4DA678" 最简单的方式，用绝对数值来表示地址

2\.         "<360SE.exe>+DA678" 相对简单的方式，只是这里用模块名来决定模块基址，后面的是偏移

3\.         "[4DA678]+3A" 用绝对数值加偏移，相当于一级指针

4\.         "[<360SE.exe>+DA678]+3A" 用模块定基址的方式，也是一级指针

5\.         "[[[<360SE.exe>+DA678]+3A]+5B]+8" 这个是一个三级指针

总之熟悉CE的人 应该对这个地址描述都很熟悉,我就不多举例了

v 双精度浮点数: 双精度浮点数

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic548"></a>**函数简介:**

对指定地址写入双精度浮点数

**函数原型:**\
\
long WriteDoubleAddr(hwnd,addr,v)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr长整形数: 地址

v 双精度浮点数: 双精度浮点数

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic550"></a>**函数简介:**

对指定地址写入单精度浮点数

**函数原型:**\
\
long WriteFloat(hwnd,addr,v)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr 字符串: 用字符串来描述地址，类似于CE的地址描述，数值必须是16进制,里面可以用[ ] + -这些符号来描述一个地址。+表示地址加，-表示地址减\
`       `模块名必须用<>符号来圈起来

`      `例如:

1\.         "4DA678" 最简单的方式，用绝对数值来表示地址

2\.         "<360SE.exe>+DA678" 相对简单的方式，只是这里用模块名来决定模块基址，后面的是偏移

3\.         "[4DA678]+3A" 用绝对数值加偏移，相当于一级指针

4\.         "[<360SE.exe>+DA678]+3A" 用模块定基址的方式，也是一级指针

5\.         "[[[<360SE.exe>+DA678]+3A]+5B]+8" 这个是一个三级指针

总之熟悉CE的人 应该对这个地址描述都很熟悉,我就不多举例了

v 单精度浮点数: 单精度浮点数

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic552"></a>**函数简介:**

对指定地址写入单精度浮点数

**函数原型:**\
\
long WriteFloatAddr(hwnd,addr,v)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr长整形数: 地址

v 单精度浮点数: 单精度浮点数

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic554"></a>**函数简介:**

对指定地址写入整数数值，类型可以是8位，16位 32位 或者64位

**函数原型:**\
\
long WriteInt(hwnd,addr,type,v)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr 字符串: 用字符串来描述地址，类似于CE的地址描述，数值必须是16进制,里面可以用[ ] + -这些符号来描述一个地址。+表示地址加，-表示地址减\
`       `模块名必须用<>符号来圈起来

`      `例如:

1\.         "4DA678" 最简单的方式，用绝对数值来表示地址

2\.         "<360SE.exe>+DA678" 相对简单的方式，只是这里用模块名来决定模块基址，后面的是偏移

3\.         "[4DA678]+3A" 用绝对数值加偏移，相当于一级指针

4\.         "[<360SE.exe>+DA678]+3A" 用模块定基址的方式，也是一级指针

5\.         "[[[<360SE.exe>+DA678]+3A]+5B]+8" 这个是一个三级指针

总之熟悉CE的人 应该对这个地址描述都很熟悉,我就不多举例了

type 整形数: 整数类型,取值如下

`      `0 : 32位

`      `1 : 16 位

`      `2 : 8位

`      `3 : 64位

v 长整形数: 整形数值

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic556"></a>**函数简介:**

对指定地址写入整数数值，类型可以是8位，16位 32位 或者64位

**函数原型:**\
\
long WriteIntAddr(hwnd,addr,type,v)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr长整形数: 地址

type 整形数: 整数类型,取值如下

`      `0 : 32位

`      `1 : 16 位

`      `2 : 8位

`      `3 : 64位

v 长整形数: 整形数值

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic558"></a>**函数简介:**

对指定地址写入字符串，可以是Ascii字符串或者是Unicode字符串

**函数原型:**\
\
long WriteString(hwnd,addr,type,v)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr 字符串: 用字符串来描述地址，类似于CE的地址描述，数值必须是16进制,里面可以用[ ] + -这些符号来描述一个地址。+表示地址加，-表示地址减\
`       `模块名必须用<>符号来圈起来

`      `例如:

1\.         "4DA678" 最简单的方式，用绝对数值来表示地址

2\.         "<360SE.exe>+DA678" 相对简单的方式，只是这里用模块名来决定模块基址，后面的是偏移

3\.         "[4DA678]+3A" 用绝对数值加偏移，相当于一级指针

4\.         "[<360SE.exe>+DA678]+3A" 用模块定基址的方式，也是一级指针

5\.         "[[[<360SE.exe>+DA678]+3A]+5B]+8" 这个是一个三级指针

总之熟悉CE的人 应该对这个地址描述都很熟悉,我就不多举例了

type 整形数: 字符串类型,取值如下

`      `0 : Ascii字符串

`      `1 : Unicode字符串

`      `2 : UTF8字符串

v 字符串: 字符串

**返回值:**

整形数:\
0: 失败

1: 成功

<a name="chmtopic560"></a>**函数简介:**

对指定地址写入字符串，可以是Ascii字符串或者是Unicode字符串

**函数原型:**\
\
long WriteStringAddr(hwnd,addr,type,v)

**参数定义:**\
\
hwnd **整形数**: 窗口句柄或者进程ID.  默认是窗口句柄. 如果要指定为进程ID,需要调用[SetMemoryHwndAsProcessId](#chmtopic457).

addr长整形数: 地址

type 整形数: 字符串类型,取值如下

`      `0 : Ascii字符串

`      `1 : Unicode字符串

`      `2 : UTF8字符串

v 字符串: 字符串

**返回值:**

整形数:\
0: 失败

1: 成功

<a name="chmtopic562"></a>**函数简介:**

根据部分Ex接口的返回值，排除指定范围区域内的坐标.

**函数原型:**\
\
string ExcludePos(all\_pos,type,x1,y1,x2,y2)

**参数定义:**\
\
all\_pos 字符串: 坐标描述串。  一般是FindStrEx,FindStrFastEx,FindStrWithFontEx, FindColorEx, FindMultiColorEx,和FindPicEx的返回值.\
type 整形数:  取值为0或者1

`     `如果all\_pos的内容是由FindPicEx,FindPicMemEx,FindStrEx,FindStrFastEx,FindStrWithFontEx返回，那么取值为0

`     `如果all\_pos的内容是由FindColorEx, FindMultiColorEx,FindColorBlockEx,FindShapeEx返回，那么取值为1

`     `如果all\_pos的内容是由OcrEx返回，那么取值为2

`     `如果all\_pos的内容是由FindPicExS,FindStrExS,FindStrFastExS返回，那么取值为3

x1 整形数: 左上角横坐标\
y1 整形数: 左上角纵坐标\
x2 整形数: 右下角横坐标\
y2 整形数: 右下角纵坐标

**返回值:**

字符串:\
经过筛选以后的返回值，格式和type指定的一致.

<a name="chmtopic564"></a>**函数简介:**

根据部分Ex接口的返回值，然后在所有坐标里找出距离指定坐标最近的那个坐标.

**函数原型:**\
\
string FindNearestPos(all\_pos,type,x,y)

**参数定义:**\
\
all\_pos 字符串: 坐标描述串。  一般是FindStrEx,FindStrFastEx,FindStrWithFontEx, FindColorEx, FindMultiColorEx,和FindPicEx的返回值.\
type 整形数:  取值为0或者1

`     `如果all\_pos的内容是由FindPicEx,FindStrEx,FindStrFastEx,FindStrWithFontEx返回，那么取值为0

`     `如果all\_pos的内容是由FindColorEx, FindMultiColorEx,FindColorBlockEx返回，那么取值为1

如果all\_pos的内容是由OcrEx返回，那么取值为2

`     `如果all\_pos的内容是由FindPicExS,FindStrExS,FindStrFastExS返回，那么取值为3

x 整形数: 横坐标\
y 整形数: 纵坐标

**返回值:**\
\
字符串:\
返回的格式和type有关，如果type为0，那么返回的格式是"id,x,y"

如果type为1,那么返回的格式是"x,y".

<a name="chmtopic566"></a>**函数简介:**

根据部分Ex接口的返回值，然后对所有坐标根据对指定坐标的距离(或者指定X或者Y)进行从小到大的排序.

**函数原型:**\
\
string SortPosDistance(all\_pos,type,x,y)

**参数定义:**\
\
all\_pos 字符串: 坐标描述串。  一般是FindStrEx,FindStrFastEx,FindStrWithFontEx, FindColorEx, FindMultiColorEx,和FindPicEx的返回值.\
type 整形数:  取值为0或者1

`     `如果all\_pos的内容是由FindPicEx,FindStrEx,FindStrFastEx,FindStrWithFontEx返回，那么取值为0

`     `如果all\_pos的内容是由FindColorEx, FindMultiColorEx,FindColorBlockEx返回，那么取值为1

`     `如果all\_pos的内容是由OcrEx返回，那么取值为2

`     `如果all\_pos的内容是由FindPicExS,FindStrExS,FindStrFastExS返回，那么取值为3

x 整形数: 横坐标 \
y 整形数: 纵坐标\
`          `注意:如果x为65535并且y为0时，那么排序的结果是仅仅对x坐标进行排序,如果y为65535并且x为0时，那么排序的结果是仅仅对y坐标进行排序.

**返回值:**\
\
字符串:\
返回的格式和type指定的格式一致.

<a name="chmtopic568"></a>**函数简介:**

对指定的数据地址和长度，组合成新的参数. FindPicMem FindPicMemE 以及FindPicMemEx专用

**函数原型:**\
\
string AppendPicAddr(pic\_info,addr,size)

**参数定义:**

pic\_info 字符串: 老的地址描述串

addr 整形数: 数据地址

size 整形数: 数据长度

**返回值:**\
\
字符串:\
新的地址描述串

<a name="chmtopic570"></a>**函数简介:**

把BGR(按键格式)的颜色格式转换为RGB

**函数原型:**\
\
string BGR2RGB(bgr\_color)

**参数定义:**\
\
bgr\_color 字符串:bgr格式的颜色字符串

**返回值:**

字符串:\
RGB格式的字符串

<a name="chmtopic572"></a>**函数简介:**

抓取指定区域(x1, y1, x2, y2)的图像,保存为file(24位位图)

**函数原型:**\
\
long Capture(x1, y1, x2, y2, file)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
file 字符串:保存的文件名,保存的地方一般为SetPath中设置的目录

`     `当然这里也可以指定全路径名.

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic574"></a>**函数简介:**

抓取指定区域(x1, y1, x2, y2)的动画，保存为gif格式

**函数原型:**\
\
long CaptureGif(x1, y1, x2, y2, file,delay,time)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
file 字符串:保存的文件名,保存的地方一般为SetPath中设置的目录

`     `当然这里也可以指定全路径名.\
delay 整形数: 动画间隔，单位毫秒。 如果为0，表示只截取静态图片\
time 整形数: 总共截取多久的动画，单位毫秒。

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic576"></a>**函数简介:**

抓取指定区域(x1, y1, x2, y2)的图像,保存为file(JPG压缩格式)

**函数原型:**\
\
long CaptureJpg(x1, y1, x2, y2, file, quality)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
file 字符串:保存的文件名,保存的地方一般为SetPath中设置的目录

`     `当然这里也可以指定全路径名.\
quality 整形数: jpg压缩比率(1-100) 越大图片质量越好

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic578"></a>**函数简介:**

同Capture函数，只是保存的格式为PNG.

**函数原型:**\
\
long CapturePng(x1,y1,x2,y2,file)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
file 字符串:保存的文件名,保存的地方一般为SetPath中设置的目录

`     `当然这里也可以指定全路径名.

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic580"></a>**函数简介:**

抓取上次操作的图色区域，保存为file(24位位图)

**函数原型:**\
\
long CapturePre(file)

**参数定义:**\
\
file 字符串:保存的文件名,保存的地方一般为SetPath中设置的目录

`     `当然这里也可以指定全路径名.

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic582"></a>**函数简介:**

比较指定坐标点(x,y)的颜色

**函数原型:**\
\
long CmpColor(x,y,color,sim)

**参数定义:**

x 整形数: X坐标

y 整形数: Y坐标

color 字符串: 颜色字符串,可以支持偏色,多色,例如 "ffffff-202020|000000-000000" 这个表示白色偏色为202020,和黑色偏色为000000.颜色最多支持10种颜色组合. 注意，这里只支持RGB颜色.

sim 双精度浮点数: 相似度(0.1-1.0)

**返回值:**

整形数:\
0: 颜色匹配\
1: 颜色不匹配

<a name="chmtopic584"></a>**函数简介:**

开启图色调试模式，此模式会稍许降低图色和文字识别的速度.默认不开启.

**函数原型:**\
\
long EnableDisplayDebug(enable\_debug)

**参数定义:**\
\
enable\_debug 整形数: 0 为关闭

`               `1 为开启

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic587"></a>**函数简介:**

当执行FindPicXXX系列接口时,是否在条件满足下(查找的图片大于等于4,这个值可以根据[SetFindPicMultithreadCount](#chmtopic586)来修改),开启多线程查找。 默认打开.

**函数原型:**\
\
long EnableFindPicMultithread(enable)

**参数定义:**

enable 整形数: 0 关闭

`         `1 打开

**返回值:**

整形数:\
0 : 失败\
1 : 成功

<a name="chmtopic589"></a>**函数简介:**

允许调用GetColor GetColorBGR GetColorHSV 以及 CmpColor时，以截图的方式来获取颜色。 默认关闭.

**函数原型:**\
\
long EnableGetColorByCapture(enable)

**参数定义:**

enable 整形数: 0 关闭

`         `1 打开

**返回值:**

整形数:\
0 : 失败\
1 : 成功

<a name="chmtopic591"></a>**函数简介:**

查找指定区域内的颜色,颜色格式"RRGGBB-DRDGDB",注意,和按键的颜色格式相反

**函数原型:**\
\
long FindColor(x1, y1, x2, y2, color, sim, dir,intX,intY)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
color 字符串:颜色 格式为"RRGGBB-DRDGDB",比如"123456-000000|aabbcc-202020". 也可以支持反色模式. 前面加@即可. 比如"@123456-000000|aabbcc-202020". 具体可以看下放注释. 注意，这里只支持RGB颜色.\
sim 双精度浮点数:相似度,取值范围0.1-1.0\
dir 整形数:查找方向 0: 从左到右,从上到下 \
`             `1: 从左到右,从下到上 \
`             `2: 从右到左,从上到下 \
`             `3: 从右到左,从下到上 \
`             `4：从中心往外查找\
`             `5: 从上到下,从左到右 \
`             `6: 从上到下,从右到左\
`             `7: 从下到上,从左到右\
`             `8: 从下到上,从右到左\
intX 变参指针:返回X坐标\
intY 变参指针:返回Y坐标

**返回值:** 

整形数:\
0:没找到\
1:找到

<a name="chmtopic593"></a>**函数简介:**

查找指定区域内的颜色块,颜色格式"RRGGBB-DRDGDB",注意,和按键的颜色格式相反

**函数原型:**\
\
long FindColorBlock(x1, y1, x2, y2, color, sim, count,width,height,intX,intY)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
color 字符串:颜色 格式为"RRGGBB-DRDGDB",比如"123456-000000|aabbcc-202020".也可以支持反色模式. 前面加@即可. 比如"@123456-000000|aabbcc-202020". 具体可以看下放注释.注意，这里只支持RGB颜色.\
sim 双精度浮点数:相似度,取值范围0.1-1.0\
count整形数:在宽度为width,高度为height的颜色块中，符合color颜色的最小数量.(注意,这个颜色数量可以在综合工具的二值化区域中看到)\
width 整形数:颜色块的宽度\
height 整形数:颜色块的高度\
intX 变参指针:返回X坐标(指向颜色块的左上角)\
intY 变参指针:返回Y坐标(指向颜色块的左上角)

**返回值:** 

整形数:\
0:没找到\
1:找到

<a name="chmtopic596"></a>**函数简介:**

查找指定区域内的所有颜色块,颜色格式"RRGGBB-DRDGDB",注意,和按键的颜色格式相反

**函数原型:**\
\
string FindColorBlockEx(x1, y1, x2, y2, color, sim, count, width, height)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
color 字符串:颜色 格式为"RRGGBB-DRDGDB" 比如"aabbcc-000000|123456-202020".也可以支持反色模式. 前面加@即可. 比如"@123456-000000|aabbcc-202020". 具体可以看下放注释.注意，这里只支持RGB颜色.\
sim 双精度浮点数:相似度,取值范围0.1-1.0\
count整形数:在宽度为width,高度为height的颜色块中，符合color颜色的最小数量.(注意,这个颜色数量可以在综合工具的二值化区域中看到)\
width 整形数:颜色块的宽度\
height 整形数:颜色块的高度

**返回值:** 

字符串:\
返回所有颜色块信息的坐标值,然后通过GetResultCount等接口来解析 (由于内存限制,返回的颜色数量最多为1800个左右)

**示例:[](#chmtopic595)**

\
s = dm.FindColorBlockEx(0,0,2000,2000,"123456-000000|abcdef-202020",1.0,350,100,200)\
count = dm.GetResultCount(s)\
index = 0\
Do While index < count\
`    `dm\_ret = dm.GetResultPos(s,index,intX,intY)\
`    `MessageBox intX&","&intY \
`    `index = index + 1 \
Loop 

注: 反色模式是指匹配任意一个指定颜色之外的颜色. 比如"@123456|333333". 在匹配时,会匹配除了123456或者333333之外的颜色.

<a name="chmtopic598"></a>**函数简介:**

查找指定区域内的颜色,颜色格式"RRGGBB-DRDGDB",注意,和按键的颜色格式相反

易语言用不了FindColor可以用此接口来代替

**函数原型:**\
\
string FindColorE(x1, y1, x2, y2, color, sim, dir)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
color 字符串:颜色 格式为"RRGGBB-DRDGDB",比如"123456-000000|aabbcc-202020".也可以支持反色模式. 前面加@即可. 比如"@123456-000000|aabbcc-202020". 具体可以看下放注释.注意，这里只支持RGB颜色.\
sim 双精度浮点数:相似度,取值范围0.1-1.0\
dir 整形数:查找方向 0: 从左到右,从上到下 \
`             `1: 从左到右,从下到上 \
`             `2: 从右到左,从上到下 \
`             `3: 从右到左,从下到上 \
`             `4：从中心往外查找\
`             `5: 从上到下,从左到右 \
`             `6: 从上到下,从右到左\
`             `7: 从下到上,从左到右\
`             `8: 从下到上,从右到左

**返回值:** 

字符串:\
返回X和Y坐标 形式如"x|y", 比如"100|200"

<a name="chmtopic600"></a>**函数简介:**

查找指定区域内的所有颜色,颜色格式"RRGGBB-DRDGDB",注意,和按键的颜色格式相反

**函数原型:**\
\
string FindColorEx(x1, y1, x2, y2, color, sim, dir)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
color 字符串:颜色 格式为"RRGGBB-DRDGDB" 比如"aabbcc-000000|123456-202020".也可以支持反色模式. 前面加@即可. 比如"@123456-000000|aabbcc-202020". 具体可以看下放注释.注意，这里只支持RGB颜色.\
sim 双精度浮点数:相似度,取值范围0.1-1.0\
dir 整形数:查找方向 0: 从左到右,从上到下 \
`             `1: 从左到右,从下到上 \
`             `2: 从右到左,从上到下 \
`             `3: 从右到左,从下到上 \
`             `5: 从上到下,从左到右 \
`             `6: 从上到下,从右到左\
`             `7: 从下到上,从左到右\
`             `8: 从下到上,从右到左

**返回值:** 

字符串:\
返回所有颜色信息的坐标值,然后通过GetResultCount等接口来解析 (由于内存限制,返回的颜色数量最多为1800个左右)

**示例:[](#chmtopic595)**

\
s = dm.FindColorEx(0,0,2000,2000,"123456-000000|abcdef-202020",1.0,0)\
count = dm.GetResultCount(s)\
index = 0\
Do While index < count\
`    `dm\_ret = dm.GetResultPos(s,index,intX,intY)\
`    `MessageBox intX&","&intY \
`    `index = index + 1 \
Loop 

注: 反色模式是指匹配任意一个指定颜色之外的颜色. 比如"@123456|333333". 在匹配时,会匹配除了123456或者333333之外的颜色.

<a name="chmtopic602"></a>**函数简介:**

查找指定区域内的所有颜色. 

**函数原型:**\
\
long FindMulColor(x1, y1, x2, y2, color, sim)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
color 字符串:颜色 格式为"RRGGBB-DRDGDB",比如"123456-000000|aabbcc-202020".也可以支持反色模式. 前面加@即可. 比如"@123456-000000|aabbcc-202020". 具体可以看下放注释.注意，这里只支持RGB颜色.\
sim 双精度浮点数:相似度,取值范围0.1-1.0

**返回值:** 

整形数:\
0:没找到或者部分颜色没找到\
1:所有颜色都找到

<a name="chmtopic604"></a>**函数简介:**

根据指定的多点查找颜色坐标

**函数原型:**\
\
long FindMultiColor(x1, y1, x2, y2,first\_color,offset\_color,sim, dir,intX,intY)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
first\_color 字符串:颜色 格式为"RRGGBB-DRDGDB|RRGGBB-DRDGDB|…………",比如"123456-000000"

这里的含义和按键自带Color插件的意义相同，只不过我的可以支持偏色和多种颜色组合

所有的偏移色坐标都相对于此颜色.注意，这里只支持RGB颜色.\
offset\_color 字符串: 偏移颜色 可以支持任意多个点 格式和按键自带的Color插件意义相同, 只不过我的可以支持偏色和多种颜色组合

` `格式为"x1|y1|RRGGBB-DRDGDB|RRGGBB-DRDGDB……,……xn|yn|RRGGBB-DRDGDB|RRGGBB-DRDGDB……"

比如"1|3|aabbcc|aaffaa-101010,-5|-3|123456-000000|454545-303030|565656"等任意组合都可以，支持偏色

还可以支持反色模式，比如"1|3|-aabbcc|-334455-101010,-5|-3|-123456-000000|-353535|454545-101010","-"表示除了指定颜色之外的颜色.

\
sim 双精度浮点数:相似度,取值范围0.1-1.0\
dir 整形数:查找方向 0: 从左到右,从上到下 1: 从左到右,从下到上 2: 从右到左,从上到下 3: 从右到左, 从下到上\
intX 变参指针:返回X坐标(坐标为first\_color所在坐标)\
intY 变参指针:返回Y坐标(坐标为first\_color所在坐标)

**返回值:** 

整形数:\
0:没找到\
1:找到

<a name="chmtopic606"></a>**函数简介:**

根据指定的多点查找颜色坐标

易语言用不了FindMultiColor可以用此接口来代替

**函数原型:**\
\
string FindMultiColorE(x1, y1, x2, y2,first\_color,offset\_color,sim, dir)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
first\_color 字符串:颜色 格式为"RRGGBB-DRDGDB|RRGGBB-DRDGDB|…………",比如"123456-000000"

这里的含义和按键自带Color插件的意义相同，只不过我的可以支持偏色和多种颜色组合

所有的偏移色坐标都相对于此颜色.注意，这里只支持RGB颜色.\
offset\_color 字符串: 偏移颜色 可以支持任意多个点 格式和按键自带的Color插件意义相同, 只不过我的可以支持偏色和多种颜色组合

` `格式为"x1|y1|RRGGBB-DRDGDB|RRGGBB-DRDGDB……,……xn|yn|RRGGBB-DRDGDB|RRGGBB-DRDGDB……"

比如"1|3|aabbcc|aaffaa-101010,-5|-3|123456-000000|454545-303030|565656"等任意组合都可以，支持偏色

还可以支持反色模式，比如"1|3|-aabbcc|-334455-101010,-5|-3|-123456-000000|-353535|454545-101010","-"表示除了指定颜色之外的颜色.

\
sim 双精度浮点数:相似度,取值范围0.1-1.0\
dir 整形数:查找方向 0: 从左到右,从上到下 1: 从左到右,从下到上 2: 从右到左,从上到下 3: 从右到左, 从下到上

**返回值:** 

字符串:\
返回X和Y坐标 形式如"x|y", 比如"100|200"

<a name="chmtopic608"></a>**函数简介:**

根据指定的多点查找所有颜色坐标

**函数原型:**\
\
string FindMultiColorEx(x1, y1, x2, y2,first\_color,offset\_color,sim, dir)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
first\_color 字符串:颜色 格式为"RRGGBB-DRDGDB|RRGGBB-DRDGDB|…………",比如"123456-000000"

这里的含义和按键自带Color插件的意义相同，只不过我的可以支持偏色和多种颜色组合

所有的偏移色坐标都相对于此颜色.注意，这里只支持RGB颜色.\
offset\_color 字符串: 偏移颜色 可以支持任意多个点 格式和按键自带的Color插件意义相同, 只不过我的可以支持偏色和多种颜色组合

` `格式为"x1|y1|RRGGBB-DRDGDB|RRGGBB-DRDGDB……,……xn|yn|RRGGBB-DRDGDB|RRGGBB-DRDGDB……"

比如"1|3|aabbcc|aaffaa-101010,-5|-3|123456-000000|454545-303030|565656"等任意组合都可以，支持偏色

还可以支持反色模式，比如"1|3|-aabbcc|-334455-101010,-5|-3|-123456-000000|-353535|454545-101010","-"表示除了指定颜色之外的颜色.

\
sim 双精度浮点数:相似度,取值范围0.1-1.0\
dir 整形数:查找方向 0: 从左到右,从上到下 1: 从左到右,从下到上 2: 从右到左,从上到下 3: 从右到左, 从下到上

**返回值:** 

字符串:\
返回所有颜色信息的坐标值,然后通过GetResultCount等接口来解析(由于内存限制,返回的坐标数量最多为1800个左右)

坐标是first\_color所在的坐标

<a name="chmtopic595"></a>**函数简介:**

查找指定区域内的图片,位图必须是24位色格式,支持透明色,当图像上下左右4个顶点的颜色一样时,则这个颜色将作为透明色处理.

这个函数可以查找多个图片,只返回第一个找到的X Y坐标.

**函数原型:**\
\
long FindPic(x1, y1, x2, y2, pic\_name, delta\_color,sim, dir,intX, intY)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
pic\_name 字符串:图片名,可以是多个图片,比如"test.bmp|test2.bmp|test3.bmp"\
delta\_color 字符串:颜色色偏 比如"203040" 表示RGB的色偏分别是20 30 40 (这里是16进制表示). 如果这里的色偏是2位，表示使用灰度找图. 比如"20"\
sim 双精度浮点数:相似度,取值范围0.1-1.0\
dir 整形数:查找方向 0: 从左到右,从上到下 1: 从左到右,从下到上 2: 从右到左,从上到下 3: 从右到左, 从下到上\
intX 变参指针:返回图片左上角的X坐标\
intY 变参指针:返回图片左上角的Y坐标

**返回值:**

整形数:\
返回找到的图片的序号,从0开始索引.如果没找到返回-1

<a name="chmtopic611"></a>**函数简介:**

查找指定区域内的图片,位图必须是24位色格式,支持透明色,当图像上下左右4个顶点的颜色一样时,则这个颜色将作为透明色处理.

这个函数可以查找多个图片,只返回第一个找到的X Y坐标.

易语言用不了FindPic可以用此接口来代替

**函数原型:**\
\
string FindPicE(x1, y1, x2, y2, pic\_name, delta\_color,sim, dir)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
pic\_name 字符串:图片名,可以是多个图片,比如"test.bmp|test2.bmp|test3.bmp"\
delta\_color 字符串:颜色色偏 比如"203040" 表示RGB的色偏分别是20 30 40 (这里是16进制表示) . 如果这里的色偏是2位，表示使用灰度找图. 比如"20"\
sim 双精度浮点数:相似度,取值范围0.1-1.0\
dir 整形数:查找方向 0: 从左到右,从上到下 1: 从左到右,从下到上 2: 从右到左,从上到下 3: 从右到左, 从下到上

**返回值:**\
\
字符串:\
返回找到的图片序号(从0开始索引)以及X和Y坐标 形式如"index|x|y", 比如"3|100|200"

<a name="chmtopic613"></a>**函数简介:**

查找指定区域内的图片,位图必须是24位色格式,支持透明色,当图像上下左右4个顶点的颜色一样时,则这个颜色将作为透明色处理.

这个函数可以查找多个图片,并且返回所有找到的图像的坐标.

**函数原型:**\
\
string FindPicEx(x1, y1, x2, y2, pic\_name, delta\_color,sim, dir)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
pic\_name 字符串:图片名,可以是多个图片,比如"test.bmp|test2.bmp|test3.bmp"\
delta\_color 字符串:颜色色偏 比如"203040" 表示RGB的色偏分别是20 30 40 (这里是16进制表示) . 如果这里的色偏是2位，表示使用灰度找图. 比如"20"\
sim 双精度浮点数:相似度,取值范围0.1-1.0\
dir 整形数:查找方向 0: 从左到右,从上到下 1: 从左到右,从下到上 2: 从右到左,从上到下 3: 从右到左, 从下到上

**返回值:**

字符串:\
返回的是所有找到的坐标格式如下:"id,x,y|id,x,y..|id,x,y" (图片左上角的坐标)

比如"0,100,20|2,30,40" 表示找到了两个,第一个,对应的图片是图像序号为0的图片,坐标是(100,20),第二个是序号为2的图片,坐标(30,40)\
(由于内存限制,返回的图片数量最多为1500个左右)

<a name="chmtopic615"></a>**函数简介:**

查找指定区域内的图片,位图必须是24位色格式,支持透明色,当图像上下左右4个顶点的颜色一样时,则这个颜色将作为透明色处理.

这个函数可以查找多个图片,并且返回所有找到的图像的坐标. 此函数同FindPicEx.只是返回值不同.

**函数原型:**\
\
string FindPicExS(x1, y1, x2, y2, pic\_name, delta\_color,sim, dir)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
pic\_name 字符串:图片名,可以是多个图片,比如"test.bmp|test2.bmp|test3.bmp"\
delta\_color 字符串:颜色色偏 比如"203040" 表示RGB的色偏分别是20 30 40 (这里是16进制表示) . 如果这里的色偏是2位，表示使用灰度找图. 比如"20"\
sim 双精度浮点数:相似度,取值范围0.1-1.0\
dir 整形数:查找方向 0: 从左到右,从上到下 1: 从左到右,从下到上 2: 从右到左,从上到下 3: 从右到左, 从下到上

**返回值:**

字符串:\
返回的是所有找到的坐标格式如下:"file,x,y| file,x,y..| file,x,y" (图片左上角的坐标)

比如"1.bmp,100,20|2.bmp,30,40" 表示找到了两个,第一个,对应的图片是1.bmp,坐标是(100,20),第二个是2.bmp,坐标(30,40)\
(由于内存限制,返回的图片数量最多为1500个左右)

<a name="chmtopic617"></a>**函数简介:**

查找指定区域内的图片,位图必须是24位色格式,支持透明色,当图像上下左右4个顶点的颜色一样时,则这个颜色将作为透明色处理.

这个函数可以查找多个图片,只返回第一个找到的X Y坐标. 这个函数要求图片是数据地址.

**函数原型:**\
\
long FindPicMem(x1, y1, x2, y2, pic\_info, delta\_color,sim, dir,intX, intY)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
pic\_info 字符串: 图片数据地址集合. 格式为"地址1,长度1|地址2,长度2.....|地址n,长度n". 可以用[AppendPicAddr](#chmtopic568)来组合. \
`          `地址表示24位位图资源在内存中的首地址，用十进制的数值表示\
`          `长度表示位图资源在内存中的长度，用十进制数值表示.\
delta\_color 字符串:颜色色偏 比如"203040" 表示RGB的色偏分别是20 30 40 (这里是16进制表示) . 如果这里的色偏是2位，表示使用灰度找图. 比如"20"\
sim 双精度浮点数:相似度,取值范围0.1-1.0\
dir 整形数:查找方向 0: 从左到右,从上到下 1: 从左到右,从下到上 2: 从右到左,从上到下 3: 从右到左, 从下到上\
intX 变参指针:返回图片左上角的X坐标\
intY 变参指针:返回图片左上角的Y坐标

**返回值:**

整形数:\
返回找到的图片的序号,从0开始索引.如果没找到返回-1

<a name="chmtopic619"></a>**函数简介:**

查找指定区域内的图片,位图必须是24位色格式,支持透明色,当图像上下左右4个顶点的颜色一样时,则这个颜色将作为透明色处理.

这个函数可以查找多个图片,只返回第一个找到的X Y坐标. 这个函数要求图片是数据地址.\
\
易语言用不了FindPicMem可以用此接口来代替

**函数原型:**\
\
string FindPicMemE(x1, y1, x2, y2, pic\_info, delta\_color,sim, dir)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
pic\_info 字符串: 图片数据地址集合. 格式为"地址1,长度1|地址2,长度2.....|地址n,长度n". 可以用[AppendPicAddr](#chmtopic568)来组合. \
`          `地址表示24位位图资源在内存中的首地址，用十进制的数值表示\
`          `长度表示位图资源在内存中的长度，用十进制数值表示.\
delta\_color 字符串:颜色色偏 比如"203040" 表示RGB的色偏分别是20 30 40 (这里是16进制表示) . 如果这里的色偏是2位，表示使用灰度找图. 比如"20"\
sim 双精度浮点数:相似度,取值范围0.1-1.0\
dir 整形数:查找方向 0: 从左到右,从上到下 1: 从左到右,从下到上 2: 从右到左,从上到下 3: 从右到左, 从下到上

**返回值:**\
\
字符串:\
返回找到的图片序号(从0开始索引)以及X和Y坐标 形式如"index|x|y", 比如"3|100|200"

<a name="chmtopic621"></a>**函数简介:**

查找指定区域内的图片,位图必须是24位色格式,支持透明色,当图像上下左右4个顶点的颜色一样时,则这个颜色将作为透明色处理.

这个函数可以查找多个图片,并且返回所有找到的图像的坐标. 这个函数要求图片是数据地址.

**函数原型:**\
\
string FindPicMemEx(x1, y1, x2, y2, pic\_info, delta\_color,sim, dir)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
pic\_info 字符串: 图片数据地址集合. 格式为"地址1,长度1|地址2,长度2.....|地址n,长度n". 可以用[AppendPicAddr](#chmtopic568)来组合. \
`          `地址表示24位位图资源在内存中的首地址，用十进制的数值表示\
`          `长度表示位图资源在内存中的长度，用十进制数值表示.\
delta\_color 字符串:颜色色偏 比如"203040" 表示RGB的色偏分别是20 30 40 (这里是16进制表示) . 如果这里的色偏是2位，表示使用灰度找图. 比如"20"\
sim 双精度浮点数:相似度,取值范围0.1-1.0\
dir 整形数:查找方向 0: 从左到右,从上到下 1: 从左到右,从下到上 2: 从右到左,从上到下 3: 从右到左, 从下到上

**返回值:**

字符串:\
返回的是所有找到的坐标格式如下:"id,x,y|id,x,y..|id,x,y" (图片左上角的坐标)

比如"0,100,20|2,30,40" 表示找到了两个,第一个,对应的图片是图像序号为0的图片,坐标是(100,20),第二个是序号为2的图片,坐标(30,40)\
(由于内存限制,返回的图片数量最多为1500个左右)

<a name="chmtopic623"></a>**函数简介:**

查找指定区域内的图片,位图必须是24位色格式,支持透明色,当图像上下左右4个顶点的颜色一样时,则这个颜色将作为透明色处理.

这个函数可以查找多个图片,只返回第一个找到的X Y坐标. 此函数同FindPic.只是返回值不同.

**函数原型:**\
\
string FindPicS(x1, y1, x2, y2, pic\_name, delta\_color,sim, dir,intX, intY)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
pic\_name 字符串:图片名,可以是多个图片,比如"test.bmp|test2.bmp|test3.bmp"\
delta\_color 字符串:颜色色偏 比如"203040" 表示RGB的色偏分别是20 30 40 (这里是16进制表示) . 如果这里的色偏是2位，表示使用灰度找图. 比如"20"\
sim 双精度浮点数:相似度,取值范围0.1-1.0\
dir 整形数:查找方向 0: 从左到右,从上到下 1: 从左到右,从下到上 2: 从右到左,从上到下 3: 从右到左, 从下到上\
intX 变参指针:返回图片左上角的X坐标\
intY 变参指针:返回图片左上角的Y坐标

**返回值:**

字符串:\
返回找到的图片的文件名. 没找到返回长度为0的字符串.

<a name="chmtopic625"></a>**函数简介:**

查找指定区域内的图片,位图必须是24位色格式,支持透明色,当图像上下左右4个顶点的颜色一样时,则这个颜色将作为透明色处理.

这个函数可以查找多个图片,只返回第一个匹配的X Y坐标.

**函数原型:**\
\
long FindPicSim(x1, y1, x2, y2, pic\_name, delta\_color,sim,dir,intX, intY)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
pic\_name 字符串:图片名,可以是多个图片,比如"test.bmp|test2.bmp|test3.bmp"\
delta\_color 字符串:颜色色偏 比如"203040" 表示RGB的色偏分别是20 30 40 (这里是16进制表示). 如果这里的色偏是2位，表示使用灰度找图. 比如"20"\
sim 整形数:最小百分比相似率. 表示匹配的颜色占总颜色数的百分比. 其中透明色也算作匹配色. 取值为0到100. 100表示必须完全匹配. 0表示任意颜色都匹配. 只有大于sim的相似率的才会被匹配\
dir 整形数:查找方向 0: 从左到右,从上到下 1: 从左到右,从下到上 2: 从右到左,从上到下 3: 从右到左, 从下到上\
intX 变参指针:返回图片左上角的X坐标\
intY 变参指针:返回图片左上角的Y坐标

**返回值:**

整形数:\
返回找到的图片的序号,从0开始索引.如果没找到返回-1

<a name="chmtopic627"></a>**函数简介:**

查找指定区域内的图片,位图必须是24位色格式,支持透明色,当图像上下左右4个顶点的颜色一样时,则这个颜色将作为透明色处理.

这个函数可以查找多个图片, 只返回第一个匹配的X Y坐标.

易语言用不了FindPicSim可以用此接口来代替

**函数原型:**\
\
string FindPicSimE(x1, y1, x2, y2, pic\_name, delta\_color,sim,dir)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
pic\_name 字符串:图片名,可以是多个图片,比如"test.bmp|test2.bmp|test3.bmp"\
delta\_color 字符串:颜色色偏 比如"203040" 表示RGB的色偏分别是20 30 40 (这里是16进制表示) . 如果这里的色偏是2位，表示使用灰度找图. 比如"20"\
sim 整形数: 最小百分比相似率. 表示匹配的颜色占总颜色数的百分比. 其中透明色也算作匹配色. 取值为0到100. 100表示必须完全匹配. 0表示任意颜色都匹配. 只有大于sim的相似率的才会被匹配\
dir 整形数:查找方向 0: 从左到右,从上到下 1: 从左到右,从下到上 2: 从右到左,从上到下 3: 从右到左, 从下到上

**返回值:**\
\
字符串:\
返回找到的图片序号(从0开始索引)以及X和Y坐标 形式如"index|x|y", 比如"3|100|200"

<a name="chmtopic629"></a>**函数简介:**

查找指定区域内的图片,位图必须是24位色格式,支持透明色,当图像上下左右4个顶点的颜色一样时,则这个颜色将作为透明色处理.

这个函数可以查找多个图片,并且返回所有找到的图像的坐标.

**函数原型:**\
\
string FindPicSimEx(x1, y1, x2, y2, pic\_name, delta\_color,sim,dir)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
pic\_name 字符串:图片名,可以是多个图片,比如"test.bmp|test2.bmp|test3.bmp"\
delta\_color 字符串:颜色色偏 比如"203040" 表示RGB的色偏分别是20 30 40 (这里是16进制表示) . 如果这里的色偏是2位，表示使用灰度找图. 比如"20"\
sim 整形数: 最小百分比相似率. 表示匹配的颜色占总颜色数的百分比. 其中透明色也算作匹配色. 取值为0到100. 100表示必须完全匹配. 0表示任意颜色都匹配. 只有大于sim的相似率的才会被匹配\
dir 整形数:查找方向 0: 从左到右,从上到下 1: 从左到右,从下到上 2: 从右到左,从上到下 3: 从右到左, 从下到上

**返回值:**

字符串:\
返回的是所有找到的坐标格式如下:"id,sim,x,y|id,sim,x,y..|id,sim,x,y" (图片左上角的坐标)

比如"0,82,100,20|2,70,30,40" 表示找到了两个,第一个,对应的图片是图像序号为0的图片,坐标是(100,20),当前匹配百分比是82,第二个是序号为2的图片,坐标(30,40),当前匹配百分比是70\
(由于内存限制,返回的图片数量最多为1500个左右)

<a name="chmtopic631"></a>**函数简介:**

查找指定区域内的图片,位图必须是24位色格式,支持透明色,当图像上下左右4个顶点的颜色一样时,则这个颜色将作为透明色处理.

这个函数可以查找多个图片, 只返回第一个匹配的X Y坐标. 这个函数要求图片是数据地址.

**函数原型:**\
\
long FindPicSimMem(x1, y1, x2, y2, pic\_info, delta\_color,sim,dir,intX, intY)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
pic\_info 字符串: 图片数据地址集合. 格式为"地址1,长度1|地址2,长度2.....|地址n,长度n". 可以用[AppendPicAddr](#chmtopic568)来组合. \
`          `地址表示24位位图资源在内存中的首地址，用十进制的数值表示\
`          `长度表示位图资源在内存中的长度，用十进制数值表示.\
delta\_color 字符串:颜色色偏 比如"203040" 表示RGB的色偏分别是20 30 40 (这里是16进制表示) . 如果这里的色偏是2位，表示使用灰度找图. 比如"20"\
sim 整形数: 最小百分比相似率. 表示匹配的颜色占总颜色数的百分比. 其中透明色也算作匹配色. 取值为0到100. 100表示必须完全匹配. 0表示任意颜色都匹配. 只有大于sim的相似率的才会被匹配\
dir 整形数:查找方向 0: 从左到右,从上到下 1: 从左到右,从下到上 2: 从右到左,从上到下 3: 从右到左, 从下到上\
intX 变参指针:返回图片左上角的X坐标\
intY 变参指针:返回图片左上角的Y坐标

**返回值:**

整形数:\
返回找到的图片的序号,从0开始索引.如果没找到返回-1

<a name="chmtopic633"></a>**函数简介:**

查找指定区域内的图片,位图必须是24位色格式,支持透明色,当图像上下左右4个顶点的颜色一样时,则这个颜色将作为透明色处理.

这个函数可以查找多个图片, 只返回第一个匹配的X Y坐标. 这个函数要求图片是数据地址.\
\
易语言用不了FindPicSimMem可以用此接口来代替

**函数原型:**\
\
string FindPicSimMemE(x1, y1, x2, y2, pic\_info, delta\_color,sim,dir)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
pic\_info 字符串: 图片数据地址集合. 格式为"地址1,长度1|地址2,长度2.....|地址n,长度n". 可以用[AppendPicAddr](#chmtopic568)来组合. \
`          `地址表示24位位图资源在内存中的首地址，用十进制的数值表示\
`          `长度表示位图资源在内存中的长度，用十进制数值表示.\
delta\_color 字符串:颜色色偏 比如"203040" 表示RGB的色偏分别是20 30 40 (这里是16进制表示) . 如果这里的色偏是2位，表示使用灰度找图. 比如"20"\
sim 整形数: 最小百分比相似率. 表示匹配的颜色占总颜色数的百分比. 其中透明色也算作匹配色. 取值为0到100. 100表示必须完全匹配. 0表示任意颜色都匹配. 只有大于sim的相似率的才会被匹配\
dir 整形数:查找方向 0: 从左到右,从上到下 1: 从左到右,从下到上 2: 从右到左,从上到下 3: 从右到左, 从下到上

**返回值:**\
\
字符串:\
返回找到的图片序号(从0开始索引)以及X和Y坐标 形式如"index|x|y", 比如"3|100|200"

<a name="chmtopic635"></a>**函数简介:**

查找指定区域内的图片,位图必须是24位色格式,支持透明色,当图像上下左右4个顶点的颜色一样时,则这个颜色将作为透明色处理.

这个函数可以查找多个图片,并且返回所有找到的图像的坐标. 这个函数要求图片是数据地址.

**函数原型:**\
\
string FindPicSimMemEx(x1, y1, x2, y2, pic\_info, delta\_color,sim,dir)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
pic\_info 字符串: 图片数据地址集合. 格式为"地址1,长度1|地址2,长度2.....|地址n,长度n". 可以用[AppendPicAddr](#chmtopic568)来组合. \
`          `地址表示24位位图资源在内存中的首地址，用十进制的数值表示\
`          `长度表示位图资源在内存中的长度，用十进制数值表示.\
delta\_color 字符串:颜色色偏 比如"203040" 表示RGB的色偏分别是20 30 40 (这里是16进制表示) . 如果这里的色偏是2位，表示使用灰度找图. 比如"20"\
sim 整形数: 最小百分比相似率. 表示匹配的颜色占总颜色数的百分比. 其中透明色也算作匹配色. 取值为0到100. 100表示必须完全匹配. 0表示任意颜色都匹配. 只有大于sim的相似率的才会被匹配\
dir 整形数:查找方向 0: 从左到右,从上到下 1: 从左到右,从下到上 2: 从右到左,从上到下 3: 从右到左, 从下到上

**返回值:**

字符串:\
返回的是所有找到的坐标格式如下:"id,sim,x,y|id,sim,x,y..|id,sim,x,y" (图片左上角的坐标)

比如"0,82,100,20|2,70,30,40" 表示找到了两个,第一个,对应的图片是图像序号为0的图片,坐标是(100,20),当前匹配百分比是82,第二个是序号为2的图片,坐标(30,40),当前匹配百分比是70\
(由于内存限制,返回的图片数量最多为1500个左右)

<a name="chmtopic637"></a>**函数简介:**

查找指定的形状. 形状的描述同按键的抓抓. 具体可以参考按键的抓抓. \
和按键的语法不同，需要用大漠综合工具的颜色转换.

**函数原型:**\
\
long FindShape(x1, y1, x2, y2, offset\_color,sim, dir,intX,intY)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
offset\_color 字符串: 坐标偏移描述 可以支持任意多个点 格式和按键自带的Color插件意义相同

` `格式为"x1|y1|e1,……xn|yn|en"

比如"1|3|1,-5|-3|0"等任意组合都可以\
sim 双精度浮点数:相似度,取值范围0.1-1.0\
dir 整形数:查找方向 0: 从左到右,从上到下 1: 从左到右,从下到上 2: 从右到左,从上到下 3: 从右到左, 从下到上\
intX 变参指针:返回X坐标(坐标为形状(0,0)所在坐标)\
intY 变参指针:返回Y坐标(坐标为形状(0,0)所在坐标)

**返回值:** 

整形数:\
0:没找到\
1:找到

<a name="chmtopic639"></a>**函数简介:**

查找指定的形状. 形状的描述同按键的抓抓. 具体可以参考按键的抓抓. \
和按键的语法不同，需要用大漠综合工具的颜色转换. 

易语言用不了FindShape可以用此接口来代替

**函数原型:**\
\
string FindShapeE(x1, y1, x2, y2, offset\_color,sim, dir)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
offset\_color 字符串: 坐标偏移描述 可以支持任意多个点 格式和按键自带的Color插件意义相同

` `格式为"x1|y1|e1,……xn|yn|en"

比如"1|3|1,-5|-3|0"等任意组合都可以\
sim 双精度浮点数:相似度,取值范围0.1-1.0\
dir 整形数:查找方向 0: 从左到右,从上到下 1: 从左到右,从下到上 2: 从右到左,从上到下 3: 从右到左, 从下到上

**返回值:** 

字符串:\
返回X和Y坐标 形式如"x|y", 比如"100|200"

<a name="chmtopic641"></a>**函数简介:**

查找所有指定的形状的坐标. 形状的描述同按键的抓抓. 具体可以参考按键的抓抓. \
和按键的语法不同，需要用大漠综合工具的颜色转换.

**函数原型:**\
\
string FindShapeEx(x1, y1, x2, y2,offset\_color,sim, dir)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
offset\_color 字符串: 坐标偏移描述 可以支持任意多个点 格式和按键自带的Color插件意义相同

` `格式为"x1|y1|e1,……xn|yn|en"

比如"1|3|1,-5|-3|0"等任意组合都可以\
sim 双精度浮点数:相似度,取值范围0.1-1.0\
dir 整形数:查找方向 0: 从左到右,从上到下 1: 从左到右,从下到上 2: 从右到左,从上到下 3: 从右到左, 从下到上

**返回值:** 

字符串:\
返回所有形状的坐标值,然后通过GetResultCount等接口来解析(由于内存限制,返回的坐标数量最多为1800个左右)

<a name="chmtopic643"></a>**函数简介:**

释放指定的图片,此函数不必要调用,除非你想节省内存.

**函数原型:**\
\
long FreePic(pic\_name)

**参数定义:**\
\
pic\_name 字符串: 文件名 比如"1.bmp|2.bmp|3.bmp" 等,可以使用通配符,比如

`          `"\*.bmp" 这个对应了所有的bmp文件

`          `"a?c\*.bmp" 这个代表了所有第一个字母是a 第三个字母是c 第二个字母任意的所有bmp文件

`          `"abc???.bmp|1.bmp|aa??.bmp" 可以这样任意组合.

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic645"></a>**函数简介:**

获取范围(x1,y1,x2,y2)颜色的均值,返回格式"H.S.V"

**函数原型:**\
\
string GetAveHSV(x1,y1,x2,y2)

**参数定义:**\
\
x1 整形数: 左上角X

y1 整形数: 左上角Y

x2 整形数: 右下角X

y2 整形数: 右下角Y

**返回值:**

字符串:\
颜色字符串

<a name="chmtopic647"></a>**函数简介:**

获取范围(x1,y1,x2,y2)颜色的均值,返回格式"RRGGBB"

**函数原型:**\
\
string GetAveRGB(x1,y1,x2,y2)

**参数定义:**\
\
x1 整形数: 左上角X

y1 整形数: 左上角Y

x2 整形数: 右下角X

y2 整形数: 右下角Y

**返回值:**

字符串:\
颜色字符串

<a name="chmtopic649"></a>**函数简介:**

获取(x,y)的颜色,颜色返回格式"RRGGBB",注意,和按键的颜色格式相反

**函数原型:**\
\
string GetColor(x,y)

**参数定义:**\
\
x 整形数:X坐标\
y 整形数:Y坐标

**返回值:**

字符串:\
颜色字符串(注意这里都是小写字符，和工具相匹配)

<a name="chmtopic651"></a>**函数简介:**

获取(x,y)的颜色,颜色返回格式"BBGGRR"

**函数原型:**\
\
string GetColorBGR(x,y)

**参数定义:**\
\
x 整形数:X坐标\
y 整形数:Y坐标

**返回值:**

字符串:\
颜色字符串(注意这里都是小写字符，和工具相匹配)

<a name="chmtopic653"></a>**函数简介:**

获取(x,y)的HSV颜色,颜色返回格式"H.S.V"

**函数原型:**\
\
string GetColorHSV(x,y)

**参数定义:**\
\
x 整形数:X坐标\
y 整形数:Y坐标

**返回值:**

字符串:\
颜色字符串

<a name="chmtopic655"></a>**函数简介:**

获取指定区域的颜色数量,颜色格式"RRGGBB-DRDGDB",注意,和按键的颜色格式相反

**函数原型:**\
\
long GetColorNum(x1, y1, x2, y2, color, sim)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
color 字符串:颜色 格式为"RRGGBB-DRDGDB",比如"123456-000000|aabbcc-202020".也可以支持反色模式. 前面加@即可. 比如"@123456-000000|aabbcc-202020". 具体可以看下放注释.注意，这里只支持RGB颜色.\
sim 双精度浮点数:相似度,取值范围0.1-1.0

**返回值:** 

整形数:\
颜色数量

<a name="chmtopic657"></a>**函数简介:**

获取指定图片的尺寸，如果指定的图片已经被加入缓存，则从缓存中获取信息.\
此接口也会把此图片加入缓存. （当图色缓存机制打开时,具体参考[EnablePicCache](#chmtopic352)）

**函数原型:**\
\
string GetPicSize(pic\_name)

**参数定义:**\
\
pic\_name 字符串: 文件名 比如"1.bmp"

**返回值:**

字符串:\
形式如 "w,h" 比如"30,20"

<a name="chmtopic659"></a>**函数简介:**

获取指定区域的图像,用二进制数据的方式返回,（不适合按键使用）方便二次开发.

**函数原型:**\
\
long GetScreenData(x1,y1,x2,y2)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标

**返回值:**

整形数:\
返回的是指定区域的二进制颜色数据地址,每个颜色是4个字节,表示方式为(00RRGGBB)

<a name="chmtopic661"></a>**函数简介:**

获取指定区域的图像,用24位位图的数据格式返回,方便二次开发.（或者可以配合SetDisplayInput的mem模式）

**函数原型:**\
\
long GetScreenDataBmp(x1,y1,x2,y2,data,size)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
data 变参指针:返回图片的数据指针\
size 变参指针:返回图片的数据长度

**返回值:**

整形数:\
0 : 失败\
1 : 成功

<a name="chmtopic663"></a>**函数简介:**

转换图片格式为24位BMP格式.

**函数原型:**\
\
long ImageToBmp(pic\_name,bmp\_name)

**参数定义:**

pic\_name 字符串: 要转换的图片名\
bmp\_name 字符串: 要保存的BMP图片名 

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic665"></a>**函数简介:**

判断指定的区域，在指定的时间内(秒),图像数据是否一直不变.(卡屏). (或者绑定的窗口不存在也返回1)

**函数原型:**\
\
long IsDisplayDead(x1,y1,x2,y2,t)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
t  整形数:需要等待的时间,单位是秒 

**返回值:**

整形数:\
0 : 没有卡屏，图像数据在变化.\
1 : 卡屏. 图像数据在指定的时间内一直没有变化. 或者绑定的窗口不见了.

<a name="chmtopic667"></a>**函数简介:**

预先加载指定的图片,这样在操作任何和图片相关的函数时,将省去了加载图片的时间。调用此函数后,没必要一定要调用FreePic,插件自己会自动释放.

另外,此函数不是必须调用的,所有和图形相关的函数只要调用过一次，图片会自动加入缓存.

如果想对一个已经加入缓存的图片进行修改，那么必须先用FreePic释放此图片在缓存中占用

的内存，然后重新调用图片相关接口，就可以重新加载此图片. （当图色缓存机制打开时,具体参考[EnablePicCache](#chmtopic352)）

**函数原型:**\
\
long LoadPic(pic\_name)

**参数定义:**\
\
pic\_name 字符串: 文件名 比如"1.bmp|2.bmp|3.bmp" 等,可以使用通配符,比如

`          `"\*.bmp" 这个对应了所有的bmp文件

`          `"a?c\*.bmp" 这个代表了所有第一个字母是a 第三个字母是c 第二个字母任意的所有bmp文件

`          `"abc???.bmp|1.bmp|aa??.bmp" 可以这样任意组合.

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic669"></a>**函数简介:**

预先加载指定的图片,这样在操作任何和图片相关的函数时,将省去了加载图片的时间。调用此函数后,没必要一定要调用FreePic,插件自己会自动释放.

另外,此函数不是必须调用的,所有和图形相关的函数只要调用过一次，图片会自动加入缓存.

如果想对一个已经加入缓存的图片进行修改，那么必须先用FreePic释放此图片在缓存中占用

的内存，然后重新调用图片相关接口，就可以重新加载此图片. （当图色缓存机制打开时,具体参考[EnablePicCache](#chmtopic352)）

此函数同LoadPic，只不过LoadPic是从文件中加载图片,而LoadPicByte从给定的内存中加载.

**函数原型:**\
\
long LoadPicByte(addr,size,pic\_name)

**参数定义:**\
\
addr 整形数: BMP图像首地址.(完整的BMP图像，不是经过解析的. 和BMP文件里的内容一致)\
size 整形数: BMP图像大小.(和BMP文件大小一致)\
pic\_name 字符串: 文件名,指定这个地址对应的图片名. 用于找图时使用.

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic671"></a>**函数简介:**

根据通配符获取文件集合. 方便用于FindPic和FindPicEx

**函数原型:**\
\
string MatchPicName(pic\_name)

**参数定义:**\
\
pic\_name 字符串: 文件名 比如"1.bmp|2.bmp|3.bmp" 等,可以使用通配符,比如

`          `"\*.bmp" 这个对应了所有的bmp文件

`          `"a?c\*.bmp" 这个代表了所有第一个字母是a 第三个字母是c 第二个字母任意的所有bmp文件

`          `"abc???.bmp|1.bmp|aa??.bmp" 可以这样任意组合.

**返回值:**

字符串:\
返回的是通配符对应的文件集合，每个图片以|分割

<a name="chmtopic673"></a>**函数简介:**

把RGB的颜色格式转换为BGR(按键格式)

**函数原型:**\
\
string RGB2BGR(rgb\_color)

**参数定义:**\
\
rgb\_color 字符串:rgb格式的颜色字符串

**返回值:**

字符串:\
BGR格式的字符串

<a name="chmtopic675"></a>**函数简介:**

设置图色,以及文字识别时,需要排除的区域.(支持所有图色接口,以及文字相关接口,但对单点取色,或者单点颜色比较的接口不支持)

**函数原型:**\
\
long SetExcludeRegion(mode,info)

**参数定义:**\
\
mode 整形数: 模式,取值如下:\
`           `0: 添加排除区域\
`           `1: 设置排除区域的颜色,默认颜色是FF00FF(此接口的原理是把排除区域设置成此颜色,这样就可以让这块区域失效)\
`           `2: 清空排除区域

\
info 字符串: 根据mode的取值来决定\
`            `当mode为0时,此参数指添加的区域,可以多个区域,用"|"相连. 格式为"x1,y1,x2,y2|....."\
`            `当mode为1时,此参数为排除区域的颜色,"RRGGBB"\
`            `当mode为2时,此参数无效

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic586"></a>**函数简介:**

当执行FindPicXXX系列接口时,当图片个数少于count时,使用单线程查找,否则使用多线程。 这个count默认是4.

**函数原型:**\
\
long SetFindPicMultithreadCount(count)

**参数定义:**

count 整形数: 图片数量. 最小不能小于2. 因为1个图片必定是单线程. 这个值默认是4.如果你不更改的话.

**返回值:**

整形数:\
0 : 失败\
1 : 成功

<a name="chmtopic678"></a>**函数简介:**

当执行FindPicXXX系列接口时,当触发多线程查找条件时,设置开启的最大线程数量. 注意,不可以超过当前CPU核心数.

**函数原型:**\
\
long SetFindPicMultithreadLimit(limit)

**参数定义:**

limit 整形数: 最大线程数,不能超过当前CPU核心数. 超过无效. 0表示无限制.

**返回值:**

整形数:\
0 : 失败\
1 : 成功

<a name="chmtopic680"></a>**函数简介:**

设置图片密码，如果图片本身没有加密，那么此设置不影响不加密的图片，一样正常使用.

**函数原型:**\
\
long SetPicPwd(pwd)

**参数定义:**\
\
pwd 字符串: 图片密码

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic682"></a>**函数简介:**

拷贝文件. 

**函数原型:**\
\
long CopyFile(src\_file,dst\_file,over)

**参数定义:**

src\_file 字符串: 原始文件名

dst\_file 字符串: 目标文件名.

over整形数: 取值如下,\
`            `0 : 如果dst\_file文件存在则不覆盖返回.\
`            `1 : 如果dst\_file文件存在则覆盖.

**返回值:**\
\
整形数:\
0 : 失败\
1 : 成功

<a name="chmtopic684"></a>**函数简介:**

创建指定目录. 

**函数原型:**\
\
long CreateFolder(folder)

**参数定义:**

folder 字符串: 目录名

**返回值:**\
\
整形数:\
0 : 失败\
1 : 成功

<a name="chmtopic686"></a>**函数简介:**

解密指定的文件. 

**函数原型:**\
\
long DecodeFile(file,pwd)

**参数定义:**

file 字符串: 文件名.

pwd 字符串: 密码.

**返回值:**\
\
整形数:\
0 : 失败\
1 : 成功

<a name="chmtopic688"></a>**函数简介:**

删除文件. 

**函数原型:**\
\
long DeleteFile(file)

**参数定义:**

file 字符串: 文件名

**返回值:**\
\
整形数:\
0 : 失败\
1 : 成功

<a name="chmtopic690"></a>**函数简介:**

删除指定目录. 

**函数原型:**\
\
long DeleteFolder(folder)

**参数定义:**

folder 字符串: 目录名

**返回值:**\
\
整形数:\
0 : 失败\
1 : 成功

<a name="chmtopic692"></a>**函数简介:**

删除指定的ini小节.  

**函数原型:**\
\
long DeleteIni(section,key,file)

**参数定义:**

section 字符串: 小节名

key 字符串: 变量名. 如果这个变量为空串，则删除整个section小节.

file 字符串: ini文件名.

**返回值:**\
\
整形数:\
0 : 失败\
1 : 成功

<a name="chmtopic694"></a>**函数简介:**

删除指定的ini小节.支持加密文件 

**函数原型:**\
\
long DeleteIniPwd(section,key,file,pwd)

**参数定义:**

section 字符串: 小节名

key 字符串: 变量名. 如果这个变量为空串，则删除整个section小节.

file 字符串: ini文件名.

pwd 字符串: 密码.

**返回值:**\
\
整形数:\
0 : 失败\
1 : 成功

<a name="chmtopic696"></a>**函数简介:**

从internet上下载一个文件. 

**函数原型:**\
\
long DownloadFile(url,save\_file,timeout)

**参数定义:**

url 字符串: 下载的url地址.

save\_file 字符串: 要保存的文件名.

timeout整形数: 连接超时时间，单位是毫秒.

**返回值:**\
\
整形数:\
1 : 成功\
-1 : 网络连接失败\
-2 : 写入文件失败

<a name="chmtopic698"></a>**函数简介:**

加密指定的文件. 

**函数原型:**\
\
long EncodeFile(file,pwd)

**参数定义:**

file 字符串: 文件名.

pwd 字符串: 密码.

**返回值:**\
\
整形数:\
0 : 失败\
1 : 成功

<a name="chmtopic700"></a>**函数简介:**

根据指定的ini文件以及section,枚举此section中所有的key名 

**函数原型:**\
\
string EnumIniKey(section,file)

**参数定义:**

section 字符串: 小节名. (不可为空)\
file 字符串: ini文件名.

**返回值:**\
\
字符串:\
每个key用"|"来连接，如果没有key，则返回空字符串. 比如"aaa|bbb|ccc"

<a name="chmtopic702"></a>**函数简介:**

根据指定的ini文件以及section,枚举此section中所有的key名.可支持加密文件

**函数原型:**\
\
string EnumIniKeyPwd(section,file,pwd)

**参数定义:**

section 字符串: 小节名. (不可为空)\
file 字符串: ini文件名.\
pwd 字符串: 密码

**返回值:**\
\
字符串:\
每个key用"|"来连接，如果没有key，则返回空字符串. 比如"aaa|bbb|ccc"

<a name="chmtopic704"></a>**函数简介:**

根据指定的ini文件,枚举此ini中所有的Section(小节名) 

**函数原型:**\
\
string EnumIniSection(file)

**参数定义:**

file 字符串: ini文件名.

**返回值:**\
\
字符串:\
每个小节名用"|"来连接，如果没有小节，则返回空字符串. 比如"aaa|bbb|ccc"

<a name="chmtopic706"></a>**函数简介:**

根据指定的ini文件,枚举此ini中所有的Section(小节名) 可支持加密文件

**函数原型:**\
\
string EnumIniSectionPwd(file,pwd)

**参数定义:**

file 字符串: ini文件名.\
pwd 字符串: 密码

**返回值:**\
\
字符串:\
每个小节名用"|"来连接，如果没有小节，则返回空字符串. 比如"aaa|bbb|ccc"

<a name="chmtopic708"></a>**函数简介:**

获取指定的文件长度. 

**函数原型:**\
\
long GetFileLength(file)

**参数定义:**

file 字符串: 文件名

**返回值:**\
\
整形数:\
文件长度(字节数)

<a name="chmtopic710"></a>**函数简介:**

获取指定文件或目录的真实路径 

**函数原型:**\
\
string GetRealPath(path)

**参数定义:**

path字符串: 路径名,可以是文件路径，也可以是目录. 这里必须是全路径

**返回值:**\
\
字符串:\
真实路径,如果失败,返回空字符串

<a name="chmtopic712"></a>**函数简介:**

判断指定文件是否存在. 

**函数原型:**\
\
long IsFileExist(file)

**参数定义:**

file 字符串: 文件名

**返回值:**\
\
整形数:\
0 : 不存在\
1 : 存在

<a name="chmtopic714"></a>**函数简介:**

判断指定目录是否存在. 

**函数原型:**\
\
long IsFolderExist (folder)

**参数定义:**

folder 字符串: 目录名

**返回值:**\
\
整形数:\
0 : 不存在\
1 : 存在

<a name="chmtopic716"></a>**函数简介:**

移动文件. 

**函数原型:**\
\
long MoveFile(src\_file,dst\_file)

**参数定义:**

src\_file 字符串: 原始文件名

dst\_file 字符串: 目标文件名.

**返回值:**\
\
整形数:\
0 : 失败\
1 : 成功

<a name="chmtopic718"></a>**函数简介:**

从指定的文件读取内容. 

**函数原型:**\
\
string ReadFile(file)

**参数定义:**

file 字符串: 文件

**返回值:**\
\
字符串:\
读入的文件内容

<a name="chmtopic720"></a>**函数简介:**

从Ini中读取指定信息. 

**函数原型:**\
\
string ReadIni(section,key,file)

**参数定义:**

section 字符串: 小节名

key 字符串: 变量名.

file 字符串: ini文件名.

**返回值:**\
\
字符串:\
字符串形式表达的读取到的内容

<a name="chmtopic722"></a>**函数简介:**

从Ini中读取指定信息.可支持加密文件   

**函数原型:**\
\
string ReadIniPwd(section,key,file,pwd)

**参数定义:**

section 字符串: 小节名

key 字符串: 变量名.

file 字符串: ini文件名.

pwd 字符串: 密码

**返回值:**\
\
字符串:\
字符串形式表达的读取到的内容

<a name="chmtopic724"></a>**函数简介:**

弹出选择文件夹对话框，并返回选择的文件夹.

**函数原型:**\
\
string SelectDirectory()

**参数定义:**

**返回值:**\
\
字符串:\
选择的文件夹全路径

<a name="chmtopic726"></a>**函数简介:**

弹出选择文件对话框，并返回选择的文件.

**函数原型:**\
\
string SelectFile()

**参数定义:**

**返回值:**\
\
字符串:\
选择的文件全路径

<a name="chmtopic728"></a>**函数简介:**

向指定文件追加字符串. 

**函数原型:**\
\
long WriteFile(file,content)

**参数定义:**

file 字符串: 文件

content 字符串: 写入的字符串.

**返回值:**\
\
整形数:\
0 : 失败\
1 : 成功

<a name="chmtopic730"></a>**函数简介:**

向指定的Ini写入信息.  

**函数原型:**\
\
long WriteIni(section,key,value,file)

**参数定义:**

section 字符串: 小节名

key 字符串: 变量名.

value 字符串: 变量内容

file 字符串: ini文件名.

**返回值:**\
\
整形数:\
0 : 失败\
1 : 成功

<a name="chmtopic732"></a>**函数简介:**

向指定的Ini写入信息.支持加密文件 

**函数原型:**\
\
long WriteIniPwd(section,key,value,file,pwd)

**参数定义:**

section 字符串: 小节名

key 字符串: 变量名.

value 字符串: 变量内容

file 字符串: ini文件名.

pwd 字符串: 密码.

**返回值:**\
\
整形数:\
0 : 失败\
1 : 成功

<a name="chmtopic734"></a>**函数简介:**

给指定的字库中添加一条字库信息.

**函数原型:**\
\
long AddDict(index,dict\_info)

**参数定义:**

index 整形数:字库的序号,取值为0-99,目前最多支持100个字库\
dict\_info 字符串:字库描述串，具体参考大漠综合工具中的字符定义

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic736"></a>**函数简介:**

清空指定的字库.

**函数原型:**\
\
long ClearDict(index)

**参数定义:**

index 整形数:字库的序号,取值为0-99,目前最多支持100个字库

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic738"></a>**函数简介:**

允许当前调用的对象使用全局字库。  如果你的程序中对象太多,并且每个对象都用到了同样的字库,可以考虑用全局字库,这样可以节省大量内存.

**函数原型:**\
\
long EnableShareDict(enable)

**参数定义:**

enable 整形数: 0 关闭

`               `1 打开

**返回值:**

整形数:\
0 : 失败\
1 : 成功

<a name="chmtopic740"></a>**函数简介:**

根据指定的范围,以及指定的颜色描述，提取点阵信息，类似于大漠工具里的单独提取.

**函数原型:**\
\
string FetchWord(x1, y1, x2, y2, color, word)

**参数定义:**\
\
x1 整形数:左上角X坐标

y1 整形数:左上角Y坐标

x2 整形数:右下角X坐标

y2 整形数:右下角Y坐标

color 字符串: 颜色格式串.注意，RGB和HSV,以及灰度格式都支持.

word 字符串: 待定义的文字,不能为空，且不能为关键符号"$"

**返回值:**

字符串:\
识别到的点阵信息，可用于AddDict\
如果失败，返回空

<a name="chmtopic742"></a>**函数简介:**

在屏幕范围(x1,y1,x2,y2)内,查找string(可以是任意个字符串的组合),并返回符合color\_format的坐标位置,相似度sim同Ocr接口描述.

(多色,差色查找类似于Ocr接口,不再重述)

**函数原型:**\
\
long FindStr(x1,y1,x2,y2,string,color\_format,sim,intX,intY)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
string 字符串:待查找的字符串,可以是字符串组合，比如"长安|洛阳|大雁塔",中间用"|"来分割字符串\
color\_format 字符串:颜色格式串, 可以包含换行分隔符,语法是","后加分割字符串. 具体可以查看下面的示例 .注意，RGB和HSV,以及灰度格式都支持.\
sim 双精度浮点数:相似度,取值范围0.1-1.0\
intX 变参指针:返回X坐标 没找到返回-1\
intY 变参指针:返回Y坐标 没找到返回-1

**返回值:**

整形数:\
返回字符串的索引 没找到返回-1, 比如"长安|洛阳",若找到长安，则返回0

<a name="chmtopic744"></a>**函数简介:**

在屏幕范围(x1,y1,x2,y2)内,查找string(可以是任意个字符串的组合),并返回符合color\_format的坐标位置,相似度sim同Ocr接口描述.

(多色,差色查找类似于Ocr接口,不再重述)

易语言用不了FindStr可以用此接口来代替

**函数原型:**\
\
string FindStrE(x1,y1,x2,y2,string,color\_format,sim)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
string 字符串:待查找的字符串, 可以是字符串组合，比如"长安|洛阳|大雁塔",中间用"|"来分割字符串\
color\_format 字符串:颜色格式串, 可以包含换行分隔符,语法是","后加分割字符串. 具体可以查看下面的示例.注意，RGB和HSV,以及灰度格式都支持.\
sim 双精度浮点数:相似度,取值范围0.1-1.0

**返回值:**

字符串:\
返回字符串序号以及X和Y坐标,形式如"id|x|y", 比如"0|100|200",没找到时，id和X以及Y均为-1，"-1|-1|-1"

<a name="chmtopic746"></a>**函数简介:**

在屏幕范围(x1,y1,x2,y2)内,查找string(可以是任意字符串的组合),并返回符合color\_format的所有坐标位置,相似度sim同Ocr接口描述.

(多色,差色查找类似于Ocr接口,不再重述)

**函数原型:**\
\
string FindStrEx(x1,y1,x2,y2,string,color\_format,sim)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
string 字符串:待查找的字符串, 可以是字符串组合，比如"长安|洛阳|大雁塔",中间用"|"来分割字符串\
color\_format 字符串:颜色格式串, 可以包含换行分隔符,语法是","后加分割字符串. 具体可以查看下面的示例.注意，RGB和HSV,以及灰度格式都支持.\
sim 双精度浮点数:相似度,取值范围0.1-1.0

**返回值:**

字符串:\
返回所有找到的坐标集合,格式如下:\
"id,x0,y0|id,x1,y1|......|id,xn,yn"\
比如"0,100,20|2,30,40" 表示找到了两个,第一个,对应的是序号为0的字符串,坐标是(100,20),第二个是序号为2的字符串,坐标(30,40)

\
<a name="chmtopic748"></a>**函数简介:**

在屏幕范围(x1,y1,x2,y2)内,查找string(可以是任意字符串的组合),并返回符合color\_format的所有坐标位置,相似度sim同Ocr接口描述.

(多色,差色查找类似于Ocr接口,不再重述). 此函数同FindStrEx,只是返回值不同. 

**函数原型:**\
\
string FindStrExS(x1,y1,x2,y2,string,color\_format,sim)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
string 字符串:待查找的字符串, 可以是字符串组合，比如"长安|洛阳|大雁塔",中间用"|"来分割字符串\
color\_format 字符串:颜色格式串, 可以包含换行分隔符,语法是","后加分割字符串. 具体可以查看下面的示例.注意，RGB和HSV,以及灰度格式都支持.\
sim 双精度浮点数:相似度,取值范围0.1-1.0

**返回值:**

字符串:\
返回所有找到的坐标集合,格式如下:\
"str,x0,y0| str,x1,y1|......| str,xn,yn"\
比如"长安,100,20|大雁塔,30,40" 表示找到了两个,第一个是长安 ,坐标是(100,20),第二个是大雁塔,坐标(30,40)

\
<a name="chmtopic750"></a>**函数简介:**

同FindStr。

**函数原型:**\
\
long FindStrFast(x1,y1,x2,y2,string,color\_format,sim,intX,intY)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
string 字符串:待查找的字符串,可以是字符串组合，比如"长安|洛阳|大雁塔",中间用"|"来分割字符串\
color\_format 字符串:颜色格式串, 可以包含换行分隔符,语法是","后加分割字符串. 具体可以查看下面的示例.注意，RGB和HSV,以及灰度格式都支持.\
sim 双精度浮点数:相似度,取值范围0.1-1.0\
intX 变参指针:返回X坐标 没找到返回-1\
intY 变参指针:返回Y坐标 没找到返回-1

**返回值:**

整形数:\
返回字符串的索引 没找到返回-1, 比如"长安|洛阳",若找到长安，则返回0

<a name="chmtopic752"></a>**函数简介:**

同FindStrE

易语言用不了FindStrFast可以用此接口来代替

**函数原型:**\
\
string FindStrFastE(x1,y1,x2,y2,string,color\_format,sim)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
string 字符串:待查找的字符串, 可以是字符串组合，比如"长安|洛阳|大雁塔",中间用"|"来分割字符串\
color\_format 字符串:颜色格式串, 可以包含换行分隔符,语法是","后加分割字符串. 具体可以查看下面的示例.注意，RGB和HSV,以及灰度格式都支持.\
sim 双精度浮点数:相似度,取值范围0.1-1.0

**返回值:**

字符串:\
返回字符串序号以及X和Y坐标,形式如"id|x|y", 比如"0|100|200",没找到时，id和X以及Y均为-1，"-1|-1|-1"

<a name="chmtopic754"></a>**函数简介:**

同FindStrEx

**函数原型:**\
\
string FindStrFastEx(x1,y1,x2,y2,string,color\_format,sim)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
string 字符串:待查找的字符串, 可以是字符串组合，比如"长安|洛阳|大雁塔",中间用"|"来分割字符串\
color\_format 字符串:颜色格式串, 可以包含换行分隔符,语法是","后加分割字符串. 具体可以查看下面的示例.注意，RGB和HSV,以及灰度格式都支持.\
sim 双精度浮点数:相似度,取值范围0.1-1.0

**返回值:**

字符串:\
返回所有找到的坐标集合,格式如下:\
"id,x0,y0|id,x1,y1|......|id,xn,yn"\
比如"0,100,20|2,30,40" 表示找到了两个,第一个,对应的是序号为0的字符串,坐标是(100,20),第二个是序号为2的字符串,坐标(30,40)

\
<a name="chmtopic756"></a>**函数简介:**

同FindStrExS. 

**函数原型:**\
\
string FindStrFastExS(x1,y1,x2,y2,string,color\_format,sim)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
string 字符串:待查找的字符串, 可以是字符串组合，比如"长安|洛阳|大雁塔",中间用"|"来分割字符串\
color\_format 字符串:颜色格式串, 可以包含换行分隔符,语法是","后加分割字符串. 具体可以查看下面的示例 .注意，RGB和HSV,以及灰度格式都支持.\
sim 双精度浮点数:相似度,取值范围0.1-1.0

**返回值:**

字符串:\
返回所有找到的坐标集合,格式如下:\
"str,x0,y0| str,x1,y1|......| str,xn,yn"\
比如"长安,100,20|大雁塔,30,40" 表示找到了两个,第一个是长安 ,坐标是(100,20),第二个是大雁塔,坐标(30,40)

\
<a name="chmtopic758"></a>**函数简介:**

同FindStrS.  

**函数原型:**\
\
string FindStrFastS(x1,y1,x2,y2,string,color\_format,sim,intX,intY)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
string 字符串:待查找的字符串,可以是字符串组合，比如"长安|洛阳|大雁塔",中间用"|"来分割字符串\
color\_format 字符串:颜色格式串, 可以包含换行分隔符,语法是","后加分割字符串. 具体可以查看下面的示例 .注意，RGB和HSV,以及灰度格式都支持.\
sim 双精度浮点数:相似度,取值范围0.1-1.0\
intX 变参指针:返回X坐标 没找到返回-1\
intY 变参指针:返回Y坐标 没找到返回-1

**返回值:**

字符串:\
返回找到的字符串. 没找到的话返回长度为0的字符串.

<a name="chmtopic760"></a>**函数简介:**

在屏幕范围(x1,y1,x2,y2)内,查找string(可以是任意个字符串的组合),并返回符合color\_format的坐标位置,相似度sim同Ocr接口描述.

(多色,差色查找类似于Ocr接口,不再重述).此函数同FindStr,只是返回值不同.

**函数原型:**\
\
string FindStrS(x1,y1,x2,y2,string,color\_format,sim,intX,intY)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
string 字符串:待查找的字符串,可以是字符串组合，比如"长安|洛阳|大雁塔",中间用"|"来分割字符串\
color\_format 字符串:颜色格式串, 可以包含换行分隔符,语法是","后加分割字符串. 具体可以查看下面的示例 .注意，RGB和HSV,以及灰度格式都支持.\
sim 双精度浮点数:相似度,取值范围0.1-1.0\
intX 变参指针:返回X坐标 没找到返回-1\
intY 变参指针:返回Y坐标 没找到返回-1

**返回值:**

字符串:\
返回找到的字符串. 没找到的话返回长度为0的字符串.

<a name="chmtopic762"></a>**函数简介:**

同FindStr，但是不使用SetDict设置的字库，而利用系统自带的字库，速度比FindStr稍慢.

**函数原型:**\
\
long FindStrWithFont(x1,y1,x2,y2,string,color\_format,sim,font\_name,font\_size,flag,intX,intY)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
string 字符串:待查找的字符串,可以是字符串组合，比如"长安|洛阳|大雁塔",中间用"|"来分割字符串\
color\_format 字符串:颜色格式串, 可以包含换行分隔符,语法是","后加分割字符串. 具体可以查看下面的示例 .注意，RGB和HSV,以及灰度格式都支持.\
sim 双精度浮点数:相似度,取值范围0.1-1.0\
font\_name 字符串:系统字体名,比如"宋体"\
font\_size 整形数:系统字体尺寸，这个尺寸一定要以大漠综合工具获取的为准.如果获取尺寸看视频教程.\
flag 整形数:字体类别 取值可以是以下值的组合,比如1+2+4+8,2+4. 0表示正常字体.\
`    `1 : 粗体\
`    `2 : 斜体\
`    `4 : 下划线\
`    `8 : 删除线\
intX 变参指针:返回X坐标 没找到返回-1\
intY 变参指针:返回Y坐标 没找到返回-1

**返回值:**

整形数:\
返回字符串的索引 没找到返回-1, 比如"长安|洛阳",若找到长安，则返回0

<a name="chmtopic764"></a>**函数简介:**

同FindStrE，但是不使用SetDict设置的字库，而利用系统自带的字库，速度比FindStrE稍慢

**函数原型:**\
\
string FindStrWithFontE(x1,y1,x2,y2,string,color\_format,sim,font\_name,font\_size,flag)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
string 字符串:待查找的字符串, 可以是字符串组合，比如"长安|洛阳|大雁塔",中间用"|"来分割字符串\
color\_format 字符串:颜色格式串, 可以包含换行分隔符,语法是","后加分割字符串. 具体可以查看下面的示例.注意，RGB和HSV,以及灰度格式都支持.\
sim 双精度浮点数:相似度,取值范围0.1-1.0\
font\_name 字符串:系统字体名,比如"宋体"\
font\_size 整形数:系统字体尺寸，这个尺寸一定要以大漠综合工具获取的为准.如果获取尺寸看视频教程.\
flag 整形数:字体类别 取值可以是以下值的组合,比如1+2+4+8,2+4. 0表示正常字体.\
`    `1 : 粗体\
`    `2 : 斜体\
`    `4 : 下划线\
`    `8 : 删除线

**返回值:**

字符串:\
返回字符串序号以及X和Y坐标,形式如"id|x|y", 比如"0|100|200",没找到时，id和X以及Y均为-1，"-1|-1|-1"

<a name="chmtopic766"></a>**函数简介:**

同FindStrEx，但是不使用SetDict设置的字库，而利用系统自带的字库，速度比FindStrEx稍慢

**函数原型:**\
\
string FindStrWithFontEx(x1,y1,x2,y2,string,color\_format,sim,font\_name,font\_size,flag)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
string 字符串:待查找的字符串, 可以是字符串组合，比如"长安|洛阳|大雁塔",中间用"|"来分割字符串\
color\_format 字符串:颜色格式串, 可以包含换行分隔符,语法是","后加分割字符串. 具体可以查看下面的示例.注意，RGB和HSV,以及灰度格式都支持.\
sim 双精度浮点数:相似度,取值范围0.1-1.0\
font\_name 字符串:系统字体名,比如"宋体"\
font\_size 整形数:系统字体尺寸，这个尺寸一定要以大漠综合工具获取的为准.如果获取尺寸看视频教程.\
flag 整形数:字体类别 取值可以是以下值的组合,比如1+2+4+8,2+4. 0表示正常字体.\
`    `1 : 粗体\
`    `2 : 斜体\
`    `4 : 下划线\
`    `8 : 删除线

**返回值:**

字符串:\
返回所有找到的坐标集合,格式如下:\
"id,x0,y0|id,x1,y1|......|id,xn,yn"\
比如"0,100,20|2,30,40" 表示找到了两个,第一个,对应的是序号为0的字符串,坐标是(100,20),第二个是序号为2的字符串,坐标(30,40)

\
<a name="chmtopic769"></a>**函数简介:**

获取指定字库中指定条目的字库信息.

**函数原型:**\
\
string GetDict(index,font\_index)

**参数定义:**\
\
index 整形数: 字库序号(0-99)\
font\_index 整形数: 字库条目序号(从0开始计数,数值不得超过指定字库的字库上限,具体参考[GetDictCount](#chmtopic768))

**返回值:**

字符串:\
返回字库条目信息. 失败返回空串.

<a name="chmtopic768"></a>**函数简介:**

获取指定的字库中的字符数量.

**函数原型:**\
\
long GetDictCount(index)

**参数定义:**

index 整形数: 字库序号(0-99)

**返回值:**

整形数:\
字库数量

<a name="chmtopic772"></a>**函数简介:**

根据指定的文字，以及指定的系统字库信息，获取字库描述信息.

**函数原型:**\
\
string GetDictInfo(str,font\_name,font\_size,flag)

**参数定义:**

str 字符串:需要获取的字符串\
font\_name 字符串:系统字体名,比如"宋体"\
font\_size 整形数:系统字体尺寸，这个尺寸一定要以大漠综合工具获取的为准.如何获取尺寸看视频教程.\
flag 整形数:字体类别 取值可以是以下值的组合,比如1+2+4+8,2+4. 0表示正常字体.\
`    `1 : 粗体\
`    `2 : 斜体\
`    `4 : 下划线\
`    `8 : 删除线

**返回值:**

字符串:\
返回字库信息,每个字符的字库信息用"|"来分割

<a name="chmtopic774"></a>**函数简介:**

获取当前使用的字库序号(0-99)

**函数原型:**\
\
long GetNowDict()

**参数定义:**

**返回值:**

整形数:\
字库序号(0-99)

<a name="chmtopic776"></a>**函数简介:**

对插件部分接口的返回值进行解析,并返回ret中的坐标个数

**函数原型:**\
\
long GetResultCount(ret)

**参数定义:**\
\
ret 字符串: 部分接口的返回串

**返回值:**

整形数:\
返回ret中的坐标个数

<a name="chmtopic778"></a>**函数简介:**

对插件部分接口的返回值进行解析,并根据指定的第index个坐标,返回具体的值

**函数原型:**\
\
long GetResultPos(ret,index,intX,intY)

**参数定义:**\
\
ret 字符串:部分接口的返回串\
index 整形数: 第几个坐标\
intX 变参指针: 返回X坐标\
intY 变参指针: 返回Y坐标

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic780"></a>**函数简介:**

在使用GetWords进行词组识别以后,可以用此接口进行识别词组数量的计算.

**函数原型:**\
\
long GetWordResultCount(str)

**参数定义:**\
\
str 字符串: GetWords接口调用以后的返回值

**返回值:**

整形数:\
返回词组数量

<a name="chmtopic782"></a>**函数简介:**

在使用GetWords进行词组识别以后,可以用此接口进行识别各个词组的坐标

**函数原型:**\
\
long GetWordResultPos(str,index,intX,intY)

**参数定义:**\
\
str 字符串: GetWords的返回值

index 整形数: 表示第几个词组

intX 变参指针: 返回的X坐标

intY 变参指针: 返回的Y坐标

**返回值:**

整形数:\
0: 失败

1: 成功

<a name="chmtopic784"></a>**函数简介:**

在使用GetWords进行词组识别以后,可以用此接口进行识别各个词组的内容

**函数原型:**\
\
string GetWordResultStr(str,index)

**参数定义:**\
\
str 字符串: GetWords的返回值

index 整形数: 表示第几个词组

**返回值:**

字符串:\
返回的第index个词组内容

<a name="chmtopic786"></a>**函数简介:**

根据指定的范围,以及设定好的词组识别参数(一般不用更改,除非你真的理解了)

识别这个范围内所有满足条件的词组. 比较适合用在未知文字的情况下,进行不定识别.

**函数原型:**\
\
string GetWords(x1, y1, x2, y2, color, sim)

**参数定义:**\
\
x1 整形数:左上角X坐标\
y1 整形数:左上角Y坐标\
x2 整形数:右下角X坐标\
y2 整形数:右下角Y坐标\
color 字符串: 颜色格式串.注意，RGB和HSV,以及灰度格式都支持.\
sim 双精度浮点数:相似度 0.1-1.0 

**返回值:**

字符串:\
识别到的格式串,要用到专用函数来解析

<a name="chmtopic788"></a>**函数简介:**

根据指定的范围,以及设定好的词组识别参数(一般不用更改,除非你真的理解了)

识别这个范围内所有满足条件的词组. 这个识别函数不会用到字库。只是识别大概形状的位置 

**函数原型:**\
\
string GetWordsNoDict(x1, y1, x2, y2, color)

**参数定义:**\
\
x1 整形数:左上角X坐标

y1 整形数:左上角Y坐标

x2 整形数:右下角X坐标

y2 整形数:右下角Y坐标

color 字符串: 颜色格式串.注意，RGB和HSV,以及灰度格式都支持.

**返回值:**

字符串:\
识别到的格式串,要用到专用函数来解析

<a name="chmtopic790"></a>**函数简介:**

识别屏幕范围(x1,y1,x2,y2)内符合color\_format的字符串,并且相似度为sim,sim取值范围(0.1-1.0),

这个值越大越精确,越大速度越快,越小速度越慢,请斟酌使用!

**函数原型:**\
\
string Ocr(x1,y1,x2,y2,color\_format,sim)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
color\_format 字符串:颜色格式串. 可以包含换行分隔符,语法是","后加分割字符串. 具体可以查看下面的示例.注意，RGB和HSV,以及灰度格式都支持.\
sim 双精度浮点数:相似度,取值范围0.1-1.0

**返回值:**

字符串:\
返回识别到的字符串

<a name="chmtopic792"></a>**函数简介:**

识别屏幕范围(x1,y1,x2,y2)内符合color\_format的字符串,并且相似度为sim,sim取值范围(0.1-1.0),

这个值越大越精确,越大速度越快,越小速度越慢,请斟酌使用!

这个函数可以返回识别到的字符串，以及每个字符的坐标.

**函数原型:**\
\
string OcrEx(x1,y1,x2,y2,color\_format,sim)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
color\_format 字符串:颜色格式串.注意，RGB和HSV,以及灰度格式都支持.\
sim 双精度浮点数:相似度,取值范围0.1-1.0

**返回值:**

字符串:\
返回识别到的字符串 格式如  "字符0$x0$y0|…|字符n$xn$yn"

<a name="chmtopic794"></a>**函数简介:**

识别屏幕范围(x1,y1,x2,y2)内符合color\_format的字符串,并且相似度为sim,sim取值范围(0.1-1.0),

这个值越大越精确,越大速度越快,越小速度越慢,请斟酌使用!

这个函数可以返回识别到的字符串，以及每个字符的坐标.这个同OcrEx,另一种返回形式.

**函数原型:**\
\
string OcrExOne(x1,y1,x2,y2,color\_format,sim)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
color\_format 字符串:颜色格式串.注意，RGB和HSV,以及灰度格式都支持.\
sim 双精度浮点数:相似度,取值范围0.1-1.0

**返回值:**

字符串:\
返回识别到的字符串 格式如  "识别到的信息|x0,y0|…|xn,yn"

<a name="chmtopic796"></a>**函数简介:**

识别位图中区域(x1,y1,x2,y2)的文字

**函数原型:**\
\
string OcrInFile(x1, y1, x2, y2, pic\_name, color\_format, sim)

**参数定义:**\
\
x1 整形数:区域的左上X坐标\
y1 整形数:区域的左上Y坐标\
x2 整形数:区域的右下X坐标\
y2 整形数:区域的右下Y坐标\
pic\_name 字符串:图片文件名\
color\_format 字符串:颜色格式串.注意，RGB和HSV,以及灰度格式都支持.\
sim 双精度浮点数:相似度,取值范围0.1-1.0

**返回值:**\
\
字符串:\
返回识别到的字符串

<a name="chmtopic798"></a>**函数简介:**

保存指定的字库到指定的文件中.

**函数原型:**\
\
long SaveDict(index,file)

**参数定义:**\
\
index 整形数:字库索引序号 取值为0-99对应100个字库\
file 字符串:文件名

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic800"></a>**函数简介:**

高级用户使用,在不使用字库进行词组识别前,可设定文字的列距,默认列距是1

**函数原型:**\
\
long SetColGapNoDict(col\_gap)

**参数定义:**\
\
col\_gap 整形数:文字列距

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic802"></a>**函数简介:**

设置字库文件

**函数原型:**\
\
long SetDict(index,file)

**参数定义:**

index 整形数:字库的序号,取值为0-99,目前最多支持100个字库\
file 字符串:字库文件名

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic804"></a>**函数简介:**

从内存中设置字库.

**函数原型:**\
\
long SetDictMem(index,addr,size)

**参数定义:**

index 整形数:字库的序号,取值为0-99,目前最多支持100个字库\
addr 整形数: 数据地址\
size 整形数: 字库长度

**返回值:**\
\
整形数:\
0:失败\
1:成功

<a name="chmtopic806"></a>**函数简介:**

设置字库的密码,在SetDict前调用,目前的设计是,所有字库通用一个密码.

**函数原型:**\
\
long SetDictPwd(pwd)

**参数定义:**\
\
pwd 字符串:字库密码

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic808"></a>**函数简介:**

高级用户使用,在使用文字识别功能前，设定是否开启精准识别.

**函数原型:**\
\
long SetExactOcr(exact\_ocr)

**参数定义:**\
\
exact\_ocr 整形数: 0 表示关闭精准识别

`            `1 开启精准识别

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic810"></a>**函数简介:**

高级用户使用,在识别前,如果待识别区域有多行文字,可以设定列间距,默认的列间距是0,

如果根据情况设定,可以提高识别精度。一般不用设定。

**函数原型:**\
\
long SetMinColGap(min\_col\_gap)

**参数定义:**\
\
min\_col\_gap 整形数:最小列间距

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic812"></a>**函数简介:**

高级用户使用,在识别前,如果待识别区域有多行文字,可以设定行间距,默认的行间距是1,

如果根据情况设定,可以提高识别精度。一般不用设定。

**函数原型:**\
\
long SetMinRowGap(min\_row\_gap)

**参数定义:**\
\
min\_row\_gap 整形数:最小行间距

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic814"></a>**函数简介:**

高级用户使用,在不使用字库进行词组识别前,可设定文字的行距,默认行距是1

**函数原型:**\
\
long SetRowGapNoDict(row\_gap)

**参数定义:**\
\
row\_gap 整形数:文字行距

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic816"></a>**函数简介:**

高级用户使用,在识别词组前,可设定词组间的间隔,默认的词组间隔是5

**函数原型:**\
\
long SetWordGap(word\_gap)

**参数定义:**\
\
word\_gap 整形数:单词间距

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic818"></a>**函数简介:**

高级用户使用,在不使用字库进行词组识别前,可设定词组间的间隔,默认的词组间隔是5

**函数原型:**\
\
long SetWordGapNoDict(word\_gap)

**参数定义:**\
\
word\_gap 整形数:单词间距

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic820"></a>**函数简介:**

高级用户使用,在识别词组前,可设定文字的平均行高,默认的词组行高是10

**函数原型:**\
\
long SetWordLineHeight(line\_height)

**参数定义:**\
\
line\_height 整形数:行高

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic822"></a>**函数简介:**

高级用户使用,在不使用字库进行词组识别前,可设定文字的平均行高,默认的词组行高是10

**函数原型:**\
\
long SetWordLineHeightNoDict(line\_height)

**参数定义:**\
\
line\_height 整形数:行高

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic824"></a>**函数简介:**

表示使用哪个字库文件进行识别(index范围:0-99)

设置之后，永久生效，除非再次设定

**函数原型:**\
\
long UseDict(index)

**参数定义:**\
\
index 整形数:字库编号(0-99)

**返回值:**

整形数:\
0:失败\
1:成功

<a name="chmtopic826"></a>**函数简介:**

蜂鸣器.

**函数原型:**\
\
long Beep(f,duration)

**参数定义:**

f 整形数: 频率

duration 整形数: 时长(ms).

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic828"></a>**函数简介:**

检测当前系统是否有开启屏幕字体平滑.

**函数原型:**\
\
long CheckFontSmooth()

**参数定义:**

**返回值:**\
\
整形数:\
0 : 系统没开启平滑字体.

1 : 系统有开启平滑字体.

<a name="chmtopic830"></a>**函数简介:**

检测当前系统是否有开启UAC(用户账户控制).

**函数原型:**\
\
long CheckUAC()

**参数定义:**

**返回值:**

整形数:\
0 : 没开启UAC

1 : 开启了UAC

<a name="chmtopic832"></a>**函数简介:**

延时指定的毫秒,过程中不阻塞UI操作. 一般高级语言使用.按键用不到.

**函数原型:**\
\
long Delay(mis)

**参数定义:**

mis整形数: 毫秒数. **必须大于0.**

**返回值:**\
\
整形数:\
0 : 失败

1 : 成功

<a name="chmtopic834"></a>**函数简介:**

延时指定范围内随机毫秒,过程中不阻塞UI操作. 一般高级语言使用.按键用不到.

**函数原型:**\
\
long Delays(mis\_min,mis\_max)

**参数定义:**

mis\_min整形数: 最小毫秒数. **必须大于0**\
mis\_max整形数: 最大毫秒数. **必须大于0**

**返回值:**\
\
整形数:\
0 : 失败

1 : 成功

<a name="chmtopic836"></a>**函数简介:**

设置当前的电源设置，禁止关闭显示器，禁止关闭硬盘，禁止睡眠，禁止待机. 不支持XP. 

**函数原型:**\
\
long DisableCloseDisplayAndSleep()

**参数定义:**

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic838"></a>**函数简介:**

关闭当前系统屏幕字体平滑.同时关闭系统的ClearType功能.

**函数原型:**\
\
long DisableFontSmooth()

**参数定义:**

**返回值:**\
\
整形数:\
0 : 失败

1 : 成功

<a name="chmtopic840"></a>**函数简介:**

关闭电源管理，不会进入睡眠.

**函数原型:**\
\
long DisablePowerSave()

**参数定义:**

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic842"></a>**函数简介:**

关闭屏幕保护.

**函数原型:**\
\
long DisableScreenSave()

**参数定义:**

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic844"></a>**函数简介:**

开启当前系统屏幕字体平滑.同时开启系统的ClearType功能.

**函数原型:**\
\
long EnableFontSmooth()

**参数定义:**

**返回值:**\
\
整形数:\
0 : 失败

1 : 成功

<a name="chmtopic846"></a>**函数简介:**

退出系统(注销 重启 关机) 

**函数原型:**\
\
long ExitOs(type)

**参数定义:**

type 整形数: 取值为以下类型

`     `0 : 注销系统

`     `1 : 关机

`     `2 : 重新启动

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic848"></a>**函数简介:**

获取剪贴板的内容

**函数原型:**\
\
string GetClipboard()

**参数定义:**

**返回值:**

字符串:\
以字符串表示的剪贴板内容

<a name="chmtopic850"></a>**函数简介:**

获取当前CPU类型(intel或者amd).

**函数原型:**\
\
long GetCpuType()

**参数定义:**

**返回值:**\
\
整形数:\
0 : 未知

1 : Intel cpu

2 : AMD cpu

<a name="chmtopic852"></a>**函数简介:**

获取当前CPU的使用率. 用百分比返回.

**函数原型:**\
\
long GetCpuUsage()

**参数定义:**

**返回值:**\
\
整形数:\
0-100表示的百分比

<a name="chmtopic854"></a>**函数简介:**

得到系统的路径 

**函数原型:**\
\
string GetDir(type)

**参数定义:**

type 整形数: 取值为以下类型

`     `0 : 获取当前路径

`     `1 : 获取系统路径(system32路径)

`     `2 : 获取windows路径(windows所在路径)

`     `3 : 获取临时目录路径(temp)

`     `4 : 获取当前进程(exe)所在的路径

**返回值:**

字符串:\
返回路径

<a name="chmtopic856"></a>**函数简介:**

获取本机的指定硬盘的厂商信息. 要求调用进程必须有管理员权限. 否则返回空串.

**函数原型:**\
\
string GetDiskModel(index)

**参数定义:**

index整形数: 硬盘序号. 表示是第几块硬盘. 从0开始编号,最小为0,最大为5,也就是最多支持6块硬盘的厂商信息获取.

**返回值:**

字符串:\
字符串表达的硬盘厂商信息

<a name="chmtopic858"></a>**函数简介:**

获取本机的指定硬盘的修正版本信息. 要求调用进程必须有管理员权限. 否则返回空串.

**函数原型:**\
\
string GetDiskReversion(index)

**参数定义:**

index整形数: 硬盘序号. 表示是第几块硬盘. 从0开始编号,最小为0,最大为5,也就是最多支持6块硬盘的修正版本信息获取.

**返回值:**

字符串:\
字符串表达的修正版本信息

<a name="chmtopic860"></a>**函数简介:**

获取本机的指定硬盘的序列号. 要求调用进程必须有管理员权限. 否则返回空串.

**函数原型:**\
\
string GetDiskSerial(index)

**参数定义:**

index整形数: 硬盘序号. 表示是第几块硬盘. 从0开始编号,最小为0,最大为5,也就是最多支持6块硬盘的序列号获取.

**返回值:**

字符串:\
字符串表达的硬盘序列号

<a name="chmtopic862"></a>**函数简介:**

获取本机的显卡信息.

**函数原型:**\
\
string GetDisplayInfo()

**参数定义:**

**返回值:**

字符串:\
字符串表达的显卡描述信息. 如果有多个显卡,用"|"连接

<a name="chmtopic864"></a>**函数简介:**

判断当前系统的DPI(文字缩放)是不是100%缩放.

**函数原型:**\
\
long GetDPI()

**参数定义:**

**返回值:**\
\
整形数:\
0 : 不是

1 : 是

<a name="chmtopic866"></a>**函数简介:**

判断当前系统使用的非UNICODE字符集是否是GB2312(简体中文)(由于设计插件时偷懒了,使用的是非UNICODE字符集，导致插件必须运行在GB2312字符集环境下).

**函数原型:**\
\
long GetLocale()

**参数定义:**

**返回值:**\
\
整形数:\
0 : 不是GB2312(简体中文)

1 : 是GB2312(简体中文)

<a name="chmtopic868"></a>**函数简介:**

获取本机的机器码.(带网卡). 此机器码用于插件网站后台. 要求调用进程必须有管理员权限. 否则返回空串.

**函数原型:**\
\
string GetMachineCode()

**参数定义:**

**返回值:**

字符串:\
字符串表达的机器机器码

<a name="chmtopic870"></a>**函数简介:**

获取本机的机器码.(不带网卡) 要求调用进程必须有管理员权限. 否则返回空串.

**函数原型:**\
\
string GetMachineCodeNoMac()

**参数定义:**

**返回值:**

字符串:\
字符串表达的机器机器码

<a name="chmtopic872"></a>**函数简介:**

获取当前内存的使用率. 用百分比返回.

**函数原型:**\
\
long GetMemoryUsage()

**参数定义:**

**返回值:**\
\
整形数:\
0-100表示的百分比

<a name="chmtopic874"></a>**函数简介:**

从网络获取当前北京时间.

**函数原型:**\
\
string GetNetTime()

**参数定义:**

**返回值:**

字符串:\
时间格式. 和now返回一致. 比如"2001-11-01 23:14:08"

<a name="chmtopic876"></a>**函数简介:**

根据指定时间服务器IP,从网络获取当前北京时间.

**函数原型:**\
\
string GetNetTimeByIp(ip)

**参数定义:**

ip 字符串: IP或者域名,并且支持多个IP或者域名连接

**返回值:**

字符串:\
时间格式. 和now返回一致. 比如"2001-11-01 23:14:08"

<a name="chmtopic878"></a>**函数简介:**

服务器压力太大,此函数不再支持。 请使用GetNetTimeByIp

**函数原型:**\
\
string GetNetTimeSafe()

**参数定义:**

**返回值:**\
\
字符串:\
时间格式. 和now返回一致. 比如"2001-11-01 23:14:08"

<a name="chmtopic880"></a>**函数简介:**

得到操作系统的build版本号.  比如win10 16299,那么返回的就是16299. 其他类似

**函数原型:**\
\
long GetOsBuildNumber()

**参数定义:**

**返回值:**

整形数:\
build 版本号\
失败返回0

<a name="chmtopic882"></a>**函数简介:**

得到操作系统的类型

**函数原型:**\
\
long GetOsType()

**参数定义:**

**返回值:**

整形数:\
0 : win95/98/me/nt4.0

1 : xp/2000

2 : 2003/2003 R2/xp-64

3 : vista/2008

4 : win7/2008 R2

5 : win8/2012

6 : win8.1/2012 R2 

7 : win10/2016 TP/win11

<a name="chmtopic884"></a>**函数简介:**

获取屏幕的色深. 

**函数原型:**\
\
long GetScreenDepth()

**参数定义:**

**返回值:**

整形数:\
返回系统颜色深度.(16或者32等)

<a name="chmtopic886"></a>**函数简介:**

获取屏幕的高度. 

**函数原型:**\
\
long GetScreenHeight()

**参数定义:**

**返回值:**

整形数:\
返回屏幕的高度

<a name="chmtopic888"></a>**函数简介:**

获取屏幕的宽度. 

**函数原型:**\
\
long GetScreenWidth()

**参数定义:**

**返回值:**

整形数:\
返回屏幕的宽度

<a name="chmtopic890"></a>**函数简介:**

获取指定的系统信息.

**函数原型:**\
\
string GetSystemInfo(type,method)

**参数定义:**

type 字符串: 取值如下\
`             `"cpuid" : 表示获取cpu序列号. method可取0和1\
`             `"disk\_volume\_serial id" : 表示获取分区序列号. id表示分区序号. 0表示C盘.1表示D盘.以此类推. 最高取到5. 也就是6个分区. method可取0\
`             `"bios\_vendor" : 表示获取bios厂商信息. method可取0和1\
`             `"bios\_version" : 表示获取bios版本信息. method可取0和1\
`             `"bios\_release\_date" : 表示获取bios发布日期. method可取0和1\
`             `"bios\_oem" : 表示获取bios里的oem信息. method可取0\
`             `"board\_vendor" : 表示获取主板制造厂商信息. method可取0和1\
`             `"board\_product" : 表示获取主板产品信息. method可取0和1\
`             `"board\_version" : 表示获取主板版本信息. method可取0和1\
`             `"board\_serial" : 表示获取主板序列号. method可取0\
`             `"board\_location" : 表示获取主板位置信息. method可取0\
`             `"system\_manufacturer" : 表示获取系统制造商信息. method可取0和1\
`             `"system\_product" : 表示获取系统产品信息. method可取0和1\
`             `"system\_serial" : 表示获取bios序列号. method可取0\
`             `"system\_uuid" : 表示获取bios uuid. method可取0\
`             `"system\_version" : 表示获取系统版本信息. method可取0和1\
`             `"system\_sku" : 表示获取系统sku序列号. method可取0和1\
`             `"system\_family" : 表示获取系统家族信息. method可取0和1\
`             `"product\_id" : 表示获取系统产品id. method可取0\
`             `"system\_identifier" : 表示获取系统标识. method可取0\
`             `"system\_bios\_version" : 表示获取系统BIOS版本号. method可取0. 多个结果用"|"连接.\
`             `"system\_bios\_date" : 表示获取系统BIOS日期. method可取0

method整形数: 获取方法. 一般从0开始取值.

**返回值:**

字符串:\
字符串表达的系统信息.

<a name="chmtopic892"></a>**函数简介:**

获取当前系统从开机到现在所经历过的时间，单位是毫秒

**函数原型:**\
\
long GetTime()

**参数定义:**

**返回值:**

整形数:\
时间(单位毫秒)

<a name="chmtopic894"></a>**函数简介:**

判断当前系统是否是64位操作系统

**函数原型:**\
\
long Is64Bit()

**参数定义:**

**返回值:**

整形数:\
0 : 不是64位系统\
1 : 是64位系统

<a name="chmtopic896"></a>**函数简介:**

判断当前CPU是否支持vt,并且是否在bios中开启了vt. 仅支持intel的CPU.

**函数原型:**\
\
long IsSurrpotVt()

**参数定义:**

**返回值:**

整形数:\
0 : 当前cpu不是intel的cpu,或者当前cpu不支持vt,或者bios中没打开vt.\
1 : 支持

<a name="chmtopic898"></a>**函数简介:**

播放指定的MP3或者wav文件.

**函数原型:**\
\
long Play(media\_file)

**参数定义:**

media\_file 字符串: 指定的音乐文件，可以采用文件名或者绝对路径的形式.

**返回值:**

整形数:\
0 : 失败\
非0表示当前播放的ID。可以用Stop来控制播放结束.

<a name="chmtopic900"></a>**函数简介:**

运行指定的应用程序.

**函数原型:**\
\
long RunApp(app\_path,mode)

**参数定义:**

app\_path 字符串: 指定的可执行程序全路径.

mode 整形数: 取值如下

`      `0 : 普通模式

`      `1 : 加强模式

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic902"></a>**函数简介:**

设置剪贴板的内容

**函数原型:**\
\
long SetClipboard(value)

**参数定义:**

value 字符串: 以字符串表示的剪贴板内容

**返回值:**

整形数:\
0 : 失败\
1 : 成功

<a name="chmtopic904"></a>**函数简介:**

设置当前系统的硬件加速级别.

**函数原型:**\
\
long SetDisplayAcceler(level)

**参数定义:**

level整形数: 取值范围为0-5.  0表示关闭硬件加速。5表示完全打开硬件加速.

**返回值:**\
\
整形数:\
0 : 失败.

1 : 成功.

<a name="chmtopic906"></a>**函数简介:**

设置当前系统的非UNICOD字符集. 会弹出一个字符集选择列表,用户自己选择到简体中文即可.

**函数原型:**\
\
long SetLocale()

**参数定义:**

**返回值:**\
\
整形数:\
0 : 失败

1 : 成功

<a name="chmtopic908"></a>**函数简介:**

设置系统的分辨率 系统色深 

**函数原型:**\
\
long SetScreen(width,height,depth)

**参数定义:**

width 整形数: 屏幕宽度

height 整形数: 屏幕高度

depth 整形数: 系统色深

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic910"></a>**函数简介:**

设置当前系统的UAC(用户账户控制).

**函数原型:**\
\
long SetUAC(enable)

**参数定义:**

enable 整形数: 取值如下

`       `0 : 关闭UAC\
`       `1 : 开启UAC

**返回值:**\
\
整形数:\
0 : 操作失败

1 : 操作成功

<a name="chmtopic912"></a>**函数简介:**

显示或者隐藏指定窗口在任务栏的图标.

**函数原型:**\
\
long ShowTaskBarIcon(hwnd,is\_show)

**参数定义:**

hwnd 整形数: 指定的窗口句柄

is\_show 整形数: 0为隐藏,1为显示

**返回值:**\
\
整形数:\
0 : 失败

1 : 成功

<a name="chmtopic914"></a>**函数简介:**

停止指定的音乐.

**函数原型:**\
\
long Stop(id)

**参数定义:**

id 整形数: Play返回的播放id.

**返回值:**

整形数:\
0 : 失败\
1 : 成功.

<a name="chmtopic916"></a>**函数简介:**

激活指定窗口所在进程的输入法. 

**函数原型:**\
\
long ActiveInputMethod(hwnd,input\_method)

**参数定义:**

hwnd 整形数: 窗口句柄\
\
input\_method 字符串: 输入法名字。 具体输入法名字对应表查看注册表中以下位置:

HKEY\_LOCAL\_MACHINE\SYSTEM\CurrentControlSet\Control\Keyboard Layouts

下面的每一项下的Layout Text的值就是输入法名字

比如 "中文 - QQ拼音输入法"

以此类推.

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic918"></a>**函数简介:**

检测指定窗口所在线程输入法是否开启

**函数原型:**\
\
long CheckInputMethod(hwnd,input\_method)

**参数定义:**

hwnd 整形数: 窗口句柄\
\
input\_method 字符串: 输入法名字。 具体输入法名字对应表查看注册表中以下位置:

HKEY\_LOCAL\_MACHINE\SYSTEM\CurrentControlSet\Control\Keyboard Layouts

下面的每一项下的Layout Text的值就是输入法名字

比如 "中文 - QQ拼音输入法"

以此类推.

**返回值:**

整形数:\
0 : 未开启

1 : 开启

<a name="chmtopic920"></a>**函数简介:**

检测是否可以进入临界区,如果可以返回1,否则返回0. 此函数如果返回1，则调用对象就会占用此互斥信号量,直到此对象调用LeaveCri,否则不会释放.注意:如果调用对象在释放时，会自动把本对象占用的互斥信号量释放.

**函数原型:**\
\
long EnterCri()

**参数定义:**

**返回值:**

整形数:\
0 : 不可以

1 : 已经进入临界区

<a name="chmtopic922"></a>**函数简介:**

执行指定的CMD指令,并返回cmd的输出结果.

**函数原型:**\
\
string ExecuteCmd(cmd,current\_dir,time\_out)

**参数定义:**\
\
cmd字符串: 需要执行的CMD指令. 比如"dir"

current\_dir字符串: 执行此cmd命令时,所在目录. 如果为空，表示使用当前目录. 比如""或者"c:"

time\_out 整形数: 超时设置,单位是毫秒. 0表示一直等待. 大于0表示等待指定的时间后强制结束,防止卡死.

**返回值:**

字符串: cmd指令的执行结果.  返回空字符串表示执行失败.

<a name="chmtopic924"></a>**函数简介:**

检测系统中是否安装了指定输入法

**函数原型:**\
\
long FindInputMethod(input\_method)

**参数定义:**\
\
input\_method 字符串: 输入法名字。 具体输入法名字对应表查看注册表中以下位置:

HKEY\_LOCAL\_MACHINE\SYSTEM\CurrentControlSet\Control\Keyboard Layouts

下面的每一项下的Layout Text的值就是输入法名字

比如 "中文 - QQ拼音输入法"

以此类推.

**返回值:**

整形数:\
0 : 未安装

1 : 安装了

<a name="chmtopic926"></a>**函数简介:**

初始化临界区,必须在脚本开头调用一次.这个函数是强制把插件内的互斥信号量归0,无论调用对象是否拥有此信号量.

**函数原型:**\
\
long InitCri()

**参数定义:**

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic928"></a>**函数简介:**

和EnterCri对应,离开临界区。此函数是释放调用对象占用的互斥信号量. 注意，只有调用对象占有了互斥信号量，此函数才会有作用. 否则没有任何作用. 如果调用对象在释放时，会自动把本对象占用的互斥信号量释放.

**函数原型:**\
\
long LeaveCri()

**参数定义:**

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic930"></a>**函数简介:**

强制降低对象的引用计数。此接口为高级接口，一般使用在高级语言，比如E vc等.

**函数原型:**\
\
long ReleaseRef()

**参数定义:**

**返回值:**

整形数:\
0 : 失败

1 : 成功

<a name="chmtopic932"></a>**函数简介:**

设置当前对象的退出线程标记，之后除了调用此接口的线程之外，调用此对象的任何接口的线程会被强制退出.

此接口为高级接口，一般用在高级语言,比如e vc等.

**函数原型:**\
\
long SetExitThread(mode)

**参数定义:**

enable 整形数: 1和2都为开启标记,0为关闭标记。 1和2的区别是,1会解绑当前对象的绑定,2不会.

**返回值:**

整形数:\
0 : 失败

1 : 成功

